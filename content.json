{"meta":{"title":"WanLi's blog","subtitle":"Stay hungry,Stay foolish...","description":"A senior in JLU majoring in EE/CS. I am interested in Domain-specific accelerator based on RISC-V.","author":"Wan Li","url":"https://www.beenli.cn","root":"/"},"pages":[{"title":"about","date":"2020-03-31T11:43:04.000Z","updated":"2020-12-25T01:28:12.251Z","comments":false,"path":"about/index.html","permalink":"https://www.beenli.cn/about/","excerpt":"","text":"æ•™è‚²ç»å† å‰æ—å¤§å­¦&nbsp;Â·&nbsp;å¾®ç”µå­&nbsp;&nbsp;[è¾…ä¿®è®¡ç®—æœº] å…´è¶£çˆ±å¥½&nbsp; â¤&nbsp;æ‰“çƒï¼Œç¼–ç¨‹ï¼Œçœ‹ä¹¦ï¼Œçœ‹ç”µå½± æ­å»ºè¿™ä¸ªåšå®¢ä¸»è¦æ˜¯ä¸ºäº†è®°å½•å­¦ä¹ ã€ç”Ÿæ´»ä¸­é‡åˆ°çš„é—®é¢˜ä»¥åŠè§£å†³åŠæ³•ï¼›è¿˜æœ‰äº›çŸ¥è¯†ï¼ŒæŠ€å·§æ€»ç»“ä¾¿äºä»ŠåæŸ¥é˜…ã€‚ åšå®¢çš„å†…å®¹éƒ½æ˜¯ä¸ªäººåŸåˆ›ï¼Œæ•´ç†ï¼Œæˆ–è€…ç¿»è¯‘è€Œæˆï¼Œä¸å…ä¼šæœ‰é”™è¯¯çš„åœ°æ–¹ï¼Œå¦‚æœå‘ç°é”™è¯¯æ¬¢è¿æ‚¨ä¸æˆ‘è”ç³»ï¼›å¦‚æœæœ‰ä¾µæƒçš„å†…å®¹ï¼Œæˆ‘å¾ˆæŠ±æ­‰ï¼Œæ¬¢è¿æ‚¨è”ç³»æˆ‘ç«‹é©¬åˆ é™¤ã€‚"},{"title":"categories","date":"2020-03-30T15:37:02.000Z","updated":"2020-04-02T11:11:56.647Z","comments":false,"path":"categories/index.html","permalink":"https://www.beenli.cn/categories/","excerpt":"","text":"ç›®å½•"},{"title":"tags","date":"2020-03-30T15:39:32.000Z","updated":"2020-03-31T11:43:51.021Z","comments":false,"path":"tags/index.html","permalink":"https://www.beenli.cn/tags/","excerpt":"","text":""}],"posts":[{"title":"YOLOv3 in PyTorch","slug":"YOLOv3-in-PyTorch","date":"2020-12-25T00:34:19.000Z","updated":"2020-12-25T04:17:43.670Z","comments":true,"path":"posts/9e0400c7/","link":"","permalink":"https://www.beenli.cn/posts/9e0400c7/","excerpt":"","text":"Intro YOLO, aka â€œYou Only Look Onceâ€â€”&gt; åå­—æ˜¯ä¸æ˜¯å¾ˆé…· YOLOæ˜¯object detectioné¢†åŸŸéå¸¸å‡ºåçš„ç®—æ³•ï¼Œå®ƒä»¥é€Ÿåº¦å¿«åŒæ—¶å…¼é¡¾æ€§èƒ½è‘—ç§°ã€‚ 1 Net Architecture concatenateå±‚åœ¨Yoloé‡Œé¢å«åšrouteå±‚ res_unitå±‚åœ¨Yoloé‡Œé¢å«åšshortcutå±‚ detectionå±‚åœ¨Yoloé‡Œé¢å«åšyoloå±‚ 2 Details è¾“å…¥å±‚:416*416*3 å°†è¾“å…¥åˆ’åˆ†ä¸º$S * S$ grid, æ¯ä¸ªæ ¼å­æœ‰ä¸‰ä¸ªé¢„å…ˆè®¾å®šå¥½é•¿($p_w$)å’Œå®½($p_h$)çš„anchor boxï¼›å¦‚æœç‰©ä½“çš„ä¸­å¿ƒè½åœ¨å“ªä¸ªgrid, é‚£ä¸ªgridå°±è´Ÿè´£æ¢æµ‹è¯¥ç‰©ä½“ã€‚ æ¯ä¸ªanchor boxæœ‰85ä¸ªæ•°æ®[$t_x, t_y, t_w, t_h, objectscore, c1, c2â€¦]$ï¼Œåˆ†åˆ«ä»£è¡¨ï¼š é¢„æµ‹æ¡†ä¸­å¿ƒç‚¹åæ ‡ï¼šç½‘ç»œå®é™…è¾“å‡ºçš„æ˜¯$t_x å’Œ t_y$, ä¸ºäº†è®©è¯¥cellé¢„æµ‹çš„ç‰©ä½“ä¸­å¿ƒä¸€å®šè½åœ¨è¯¥cellä¸Šï¼ŒåŠ äº†ä¸ªsigmoidå‡½æ•°ã€‚ é¢„æµ‹æ¡†é•¿å’Œå®½: é˜²æ­¢æ¢¯åº¦ä¸‹é™ä¸ç¨³å®šï¼Œæ‰€ä»¥è¿›è¡Œäº†å¯¹æ•°ç©ºé—´å˜æ¢ï¼Œç½‘ç»œç»™å‡º$t_x, t_h$, çœŸå®çš„é•¿å’Œå®½ç”±ğŸ‘†å…¬å¼è®¡ç®—ã€‚ æ˜¯å¦æœ‰ç‰©ä½“çš„æ¦‚ç‡: å¦‚æœæ²¡æœ‰ç‰©ä½“ï¼Œåç»­ç±»åˆ«çš„ç½®ä¿¡åˆ†æ•°å°†æ²¡æœ‰ä½œç”¨ ä¸€å…±é¢„æµ‹80ä¸ªç±»åˆ«ï¼Œæ¯ä¸ªç±»åˆ«çš„ç½®ä¿¡åˆ†æ•°ã€‚ æœ‰ä¸‰ç§scaleçš„è¾“å‡ºå±‚ï¼Œåˆ†åˆ«ä¸ºï¼š13 * 13 * 85ï¼›26 * 26 * 85ï¼›52 * 52 * 85ï¼› æ¯ä¸ªcellæœ‰ä¸‰ä¸ªanchor box;æ‰€ä»¥æ¯ä¸ªè¾“å…¥ä¸€å…±æœ‰$(13\\times13+26\\times26+52\\times52)\\times3=10647$ä¸ªé¢„æµ‹æ¡† è¿™ä¹ˆå¤šè¾“å‡ºæ¡†è‚¯å®šç»å¤§éƒ¨åˆ†æ˜¯é‡å¤é¢„æµ‹æˆ–è€…ä¸æ­£ç¡®çš„é¢„æµ‹ï¼Œéœ€è¦å‰”é™¤ä¸å¥½çš„æ¡† è®¾ç½®object scoreé˜ˆå€¼ï¼Œæ¯”å¦‚ä½äº0.6çš„å»é™¤ è®¾ç½®IOUé˜ˆå€¼ï¼Œè¿›è¡ŒNon-maximum Suppression Implementation in PyTorch Reference how-to-implement-a-yolo-object-detector-in-pytorch YOLO V1: You Only Look Once: Unified, Real-Time Object Detection YOLO V2: YOLO9000: Better, Faster, Stronger YOLO V3: An Incremental Improvement IOU Bounding Box Regression (Appendix C) Non maximum suppresion PyTorch Official Tutorial","categories":[{"name":"CS","slug":"CS","permalink":"https://www.beenli.cn/categories/CS/"},{"name":"Programming","slug":"CS/Programming","permalink":"https://www.beenli.cn/categories/CS/Programming/"},{"name":"ML","slug":"CS/Programming/ML","permalink":"https://www.beenli.cn/categories/CS/Programming/ML/"}],"tags":[{"name":"python","slug":"python","permalink":"https://www.beenli.cn/tags/python/"},{"name":"PyTorch","slug":"PyTorch","permalink":"https://www.beenli.cn/tags/PyTorch/"}]},{"title":"Python x CV","slug":"Python-x-CV2","date":"2020-12-24T08:27:02.000Z","updated":"2020-12-24T13:06:22.472Z","comments":true,"path":"posts/f67fb0fb/","link":"","permalink":"https://www.beenli.cn/posts/f67fb0fb/","excerpt":"","text":"Installation python opencv åŒ…çš„å®˜æ–¹ç½‘å€: https://pypi.org/project/opencv-python/ opencvå®˜ç½‘ç½‘å€ : https://docs.opencv.org/master/ ç›´æ¥é€šè¿‡pipå®‰è£…(æœ‰å›¾å½¢ç•Œé¢çš„PC) é€‰æ‹©1ï¼šåŒ…å«ä¸»è¦çš„æ¨¡å—: pip install opencv-python é€‰æ‹©2: å…¨éƒ¨å®‰è£…(æœ‰äº›é¢å¤–çš„æ¨¡å—) : pip install opencv-contrib-python æ²¡æœ‰å›¾å½¢ç•Œé¢çš„æœåŠ¡å™¨ä¸Š(ä¸ğŸ‘†å¯¹åº”) pip install opencv-python-headless pip install opencv-contrib-python-headless å°è¯•ç”¨conda install open-cv,ä½†æ˜¯æ‰¾ä¸åˆ°åŒ… Common Usage å¯¼å…¥çš„åŒ…ä¸ºcv2 1. è¯»å–å›¾åƒ 12import cv2cv2.imread(\"dog.png\") è¿”å›å€¼: åƒç´ çŸ©é˜µ[height, width, channel] ç±»å‹: numpy.ndarrayï¼› æ•°æ®ç±»å‹: unit8; é€šé“: BGR, ä¸æ˜¯RGB; å¯ä»¥é€šè¿‡src[:,:,::]è½¬æ¢ æ³¨æ„ï¼šæ¯ä¸ªåƒç´ çš„æ•°æ®ç±»å‹ä¸€å®šè¦uint8ï¼›å¦åˆ™ä¼šå‡ºç° error: (-215:Assertion failed) src_depth != CV_16F &amp;&amp; src_depth != CV_32S in function â€˜convertToShowâ€™ è§£å†³åŠæ³•: np.uint8(image) 2. æ˜¾ç¤ºå›¾åƒ1cv2.imshow(\"winname\", image) 3. ç¼©æ”¾å›¾åƒ 1cv2.resize(src, dsize[, dst[, fx[, fy[, interpolation]]]]) --&gt; dst å‚æ•°è¯´æ˜: src: è¯»å…¥çš„å›¾åƒ, [height, width, channel] dsize: å˜æ¢åçš„å®½å’Œé«˜(width, height) â€”&gt; (int, int) dst: ä¸srcç›¸å¯¹åº”, å³å˜æ¢å®Œçš„å„ç‚¹åƒç´ çŸ©é˜µ fx: xæ–¹å‘(å³widthæ–¹å‘) ç¼©æ”¾å€æ•° fy: yæ–¹å‘(å³heightæ–¹å‘)ç¼©æ”¾å€æ•° interpolation: æ’å€¼æ–¹æ³• notes: è½¬æ¢åçš„å°ºå¯¸è¦ä¹ˆç”±dsizeè¦ä¹ˆç”±fx,fyæ¥å†³å®š æ’å€¼æ–¹æ³• è§£é‡Šå¦‚ä¸‹ INTER_NEAREST æœ€è¿‘é‚»æ’å€¼(0) INTER_LINEAR åŒçº¿æ€§æ’å€¼ï¼ˆé»˜è®¤è®¾ç½®ï¼‰(1) INTER_AREA ä½¿ç”¨åƒç´ åŒºåŸŸå…³ç³»è¿›è¡Œé‡é‡‡æ ·ï¼ˆæœ€é€‚åˆshrink) INTER_CUBIC 4x4åƒç´ é‚»åŸŸçš„åŒä¸‰æ¬¡æ’å€¼ (2) INTER_LANCZOS4 8x8åƒç´ é‚»åŸŸçš„Lanczosæ’å€¼(3) ğŸ‘†æ ‡å·0,1,2,3ä»£è¡¨ä¸Šé‡‡æ ·æ–¹æ³•è¶Šæ¥è¶Šå¤æ‚, å›¾åƒè¿‡åº¦è¶Šå¹³æ»‘,è´¨é‡è¶Šå¥½,ä½†æ˜¯é€Ÿåº¦è¶Šæ…¢ å¦‚æœä½ å·²ç»åˆ›å»ºäº†dst(è½¬æ¢åçš„å°ºå¯¸ç”±dstæ¥å†³å®š) 1resize(src, dst.size(), dst) ä¿®æ”¹å›¾ç‰‡å°ºå¯¸ 12345678910111213141516171819202122232425262728293031323334import cv2import numpy as npdef letterbox_image(img, inp_dim): \"\"\"resize image with unchanged aspect ratio using padding img: input image inp_dim: \"\"\" img_w, img_h = img.shape[1], img.shape[0] # img:[height, width, channel] w, h = inp_dim scale = min(w / img_w, h / img_h) # keep aspect ratio new_w = int(img_w * scale) # multiply the same number new_h = int(img_h * scale) # è¡¨ç¤ºå¤§å°æ—¶ç”¨çš„æ˜¯(width,height) --&gt; è¿”å›çš„æ˜¯[height, width, channel] resized_image = cv2.resize(img, (new_w, new_h), interpolation=cv2.INTER_CUBIC) # cubic cv2.imshow(\"unchanged aspect ratio\", resized_image) canvas = np.full((h, w, 3), 128) # create a numpy array having shape of [width, height, c] # padding with (128,128,128) gray canvas[(h - new_h) // 2: (h - new_h) // 2 + new_h, (w - new_w) // 2:(w - new_w) // 2 + new_w, :] = resized_image return canvasif __name__ == \"__main__\": filename = \"dog-cycle-car.png\" dog = cv2.imread(filename) cv2.imshow(\"original_dog\", dog) shrink_dog = cv2.resize(dog, None, fx=0.5, fy=1, interpolation=cv2.INTER_CUBIC) dog_keep_ratio_padding = np.uint8(letterbox_image(dog, (dog.shape[0] // 2, dog.shape[0] // 2))) # height/2 cv2.imshow(\"dog_keep_ratio_padding\", dog_keep_ratio_padding) cv2.imshow(\"shrink_dog\", shrink_dog) cv2.waitKey(0) cv2.destroyAllWindows() ä¸€å®šè¦ä½¿ç”¨cv2.waitKey(0)ï¼Œå¦åˆ™æ˜¾ç¤ºä¸äº†å›¾ç‰‡:ï¼ˆæ­£æ•°ä¸ºç­‰å¾…çš„æ—¶é—´,å•ä½æ¯«ç§’) ä½¿ç”¨cv2.destroyWindows(â€œwinnameâ€),å¯ä»¥ä¸»åŠ¨å…³é—­çª—å£(å›¾ç‰‡) 4. åœ¨å›¾åƒä¸Šç”»çŸ©å½¢) 1cv2.rectangle(img, pt1, pt2, color[, thickness[, lineType[, shift]]]) -&gt; img The function cv::rectangle draws a rectangle outline or a filled rectangle whose two opposite corners are pt1 and pt2 pt1,pt2: ä¸¤ä¸ªå¯¹è§’çš„åæ ‡ color: tuple(R,G,B) thickness: int å¦‚æœä¸ºè´Ÿæ•°,æ¯”å¦‚-1,é‚£ä¹ˆä¼šå¡«å……æ•´ä¸ªçŸ©å½¢ lineType: 8(é»˜è®¤)ï¼š8è¿æ¥ï¼›4ï¼š4è¿æ¥çº¿ï¼›CV_AA:é”¯é½¿çº¿ æ³¨:å¯¹äºæ•´æ•°åæ ‡çš„éåé”¯é½¿çº¿ï¼Œä½¿ç”¨8è¿æ¥æˆ–4è¿æ¥çš„Bresenhamç®—æ³•ã€‚ç²—çº¿ä»¥åœ†è§’ç»“å°¾ç»˜åˆ¶ã€‚åé”¯é½¿çº¿æ˜¯ç”¨é«˜æ–¯æ»¤æ³¢ç»˜åˆ¶çš„ shift: ç‚¹åæ ‡ä¸­çš„å°æ•°ä½æ•° 5.åœ¨å›¾åƒä¸Šå†™å­—1cv2.putText(img, text, org, fontFace, fontScale, color[, thickness[, lineType[, bottomLeftOrigin]]]) å¯¹äºä¸èƒ½æ¸²æŸ“çš„symbolï¼Œä½¿ç”¨ï¼Ÿæ ‡è®° text: String to be drawn org: Tuple(x,y) Bottom-left corner of the text string in the image(æ–‡æœ¬çš„å·¦ä¸‹è§’åæ ‡) fontFace: å­—ä½“ fontScale: å­—ä½“å¤§å° color, thickness, lineType: åŒğŸ‘† bottomLeftOrigin: å½“å…¶ä¸ºçœŸæ—¶ï¼Œå›¾åƒåŸç‚¹åœ¨å·¦ä¸‹è§’ï¼Œå¦åˆ™åœ¨å·¦ä¸Šè§’(opencvé»˜è®¤ä¸ºå·¦ä¸Š)ã€å¦‚æœä¸ºTrueï¼Œå­—ç¿»è½¬$180^o$ã€‘ 1234567891011enum HersheyFonts { FONT_HERSHEY_SIMPLEX = 0, //!&lt; normal size sans-serif font FONT_HERSHEY_PLAIN = 1, //!&lt; small size sans-serif font FONT_HERSHEY_DUPLEX = 2, //!&lt; normal size sans-serif font (more complex than FONT_HERSHEY_SIMPLEX) FONT_HERSHEY_COMPLEX = 3, //!&lt; normal size serif font FONT_HERSHEY_TRIPLEX = 4, //!&lt; normal size serif font (more complex than FONT_HERSHEY_COMPLEX) FONT_HERSHEY_COMPLEX_SMALL = 5, //!&lt; smaller version of FONT_HERSHEY_COMPLEX FONT_HERSHEY_SCRIPT_SIMPLEX = 6, //!&lt; hand-writing style font FONT_HERSHEY_SCRIPT_COMPLEX = 7, //!&lt; more complex variant of FONT_HERSHEY_SCRIPT_SIMPLEX FONT_ITALIC = 16 //!&lt; flag for italic font}; å­—ä½“ğŸ‘† 6 ç¤ºä¾‹1234567891011121314151617181920212223import cv2if __name__ == \"__main__\": filename = \"imgs\\\\dog.jpg\" dog = cv2.imread(filename) cv2.imshow(\"original_dog\", dog) c1 = (164, 108) c2 = (560, 447) color = (255, 0, 0) # red cv2.rectangle(dog, c1, c2, color, 2, lineType=cv2.LINE_AA) cv2.imshow(\"rectangle\", dog) label = \"bicycle\" # (text,fontFace,fontScale,thickness) t_size = cv2.getTextSize(label, cv2.FONT_HERSHEY_SIMPLEX, 1, 1)[0] # c2 = c1[0] + t_size[0] + 3, c1[1] - t_size[1] - 4 # c2 at the right-top of original rectangle's top-left corner # (width:x, height:y) cv2.rectangle(dog, c1, c2, color, -1, lineType=cv2.LINE_AA) # -1 fill the rectangle cv2.putText(dog, label, (c1[0], c1[1]-6), cv2.FONT_HERSHEY_SIMPLEX, 1, [225, 255, 255], 1) cv2.imshow(\"rectangle+text\", dog) cv2.waitKey(0) cv2.destroyAllWindows()","categories":[{"name":"CS","slug":"CS","permalink":"https://www.beenli.cn/categories/CS/"},{"name":"Programming","slug":"CS/Programming","permalink":"https://www.beenli.cn/categories/CS/Programming/"},{"name":"ML","slug":"CS/Programming/ML","permalink":"https://www.beenli.cn/categories/CS/Programming/ML/"}],"tags":[{"name":"CV","slug":"CV","permalink":"https://www.beenli.cn/tags/CV/"},{"name":"python","slug":"python","permalink":"https://www.beenli.cn/tags/python/"}]},{"title":"manage project dependencies with SBT","slug":"manage-project-dependencies-with-SBT","date":"2020-12-03T12:29:14.000Z","updated":"2020-12-03T14:20:46.829Z","comments":true,"path":"posts/f1ee3abb/","link":"","permalink":"https://www.beenli.cn/posts/f1ee3abb/","excerpt":"","text":"Dependency ä¾èµ–åˆ†ä¸ºï¼šæ‰˜ç®¡ä¾èµ–ã€Œmanagedã€å’Œéæ‰˜ç®¡ä¾èµ–ã€Œunmanagedã€ Unmanagedéæ‰˜ç®¡ä¾èµ–ï¼šæ¯”å¦‚JARåŒ… ä½¿ç”¨æ–¹æ³•ï¼š æŠŠéœ€è¦çš„JARåŒ…æ‹·è´åˆ°é¡¹ç›®æ ¹ç›®å½•çš„libæ–‡ä»¶å¤¹ ä¸‹ã€‚ å¦‚æœè¯¥JARåŒ…è¿˜ä¾èµ–å…¶å®ƒJARåŒ…ï¼Œä½ ä¹Ÿè¦ä¸‹è½½å…¶å®ƒJARå¹¶æŠŠå…¶åŒæ ·æ‹·è´åˆ°libç›®å½•ä¸­ ç¼ºç‚¹ï¼š è¦è‡ªå·±è§£å†³åŒ…ä¾èµ–å…³ç³»ï¼Œä¸€æ—¦é¡¹ç›®å˜å¤§äº†ï¼Œé æ‰‹å·¥ç»´æŠ¤åŸºæœ¬ä¸å¯èƒ½ Managed(key)æ‰˜ç®¡ä¾èµ–ï¼šé€šè¿‡ç»™å®šé¡¹ç›®ä¸€äº›å±æ€§ï¼Œç”±æ„å»ºå·¥å…·(å¦‚sbt)è‡ªåŠ¨å»é»˜è®¤ä»“åº“ä¸‹è½½ã€‚ Single libåŸºæœ¬è¯­æ³•: å†™åœ¨é¡¹ç›®çš„ã€Œbuild.sbtã€æ–‡ä»¶ä¸­ 1libraryDependencies += groupID % artifactID % revision % configuration æœ€å°å®Œæ•´çš„æ–‡ä»¶: 1234567name := \"BasicProjectWithScalaTest\" // é¡¹ç›®åç§°version := \"1.0\" // é¡¹ç›®ç‰ˆæœ¬scalaVersion := \"2.10.0\" // é¡¹ç›®Scalaç‰ˆæœ¬libraryDependencies += \"org.scalatest\" %% \"scalatest\" % \"1.9.1\" % \"test\" ğŸ‘†æ–¹æ³•è¯´æ˜ï¼š Method Description += é”®å€¼å¯¹;ç”¨+=è¡¨ç¤ºç»™é”®(libraryDependencies)é™„åŠ å€¼ % ç”¨äºä»ä½ æä¾›çš„å­—ç¬¦ä¸²ä¸­æ„å»ºIvy module ID %% å½“å…¶åœ¨groupIDåä½¿ç”¨æ—¶,è‡ªåŠ¨æŠŠä½ é¡¹ç›®Scalaç‰ˆæœ¬å·æ·»åŠ åˆ°å·¥ä»¶åå­—æœ«å°¾ exampleï¼šğŸ‘‡ä¸¤ä¸ªç­‰æ•ˆ 12libraryDependencies += \"org.scalatest\" % \"scalatest_2.10\" % \"1.9.1\" % \"test\"libraryDependencies += \"org.scalatest\" %% \"scalatest\" % \"1.9.1\" % \"test\" libraryDependencieså¯ä»¥åœ¨sbté»˜è®¤è¿œç¨‹ä»“åº“ä¸­æ‰¾åˆ° notes: å‡è®¾ä½ æ·»åŠ ä¸€ä¸ªä¾èµ–ï¼Œä½†æ˜¯è¿™ä¸ªå·¥ä»¶ä¾èµ–å…¶å®ƒçš„å·¥ä»¶ï¼Œé‚£ä¹ˆsbtä¼šè‡ªåŠ¨å¸®ä½ ä¸‹è½½ä¾èµ–ï¼Œè¿™æ˜¯éæ‰˜ç®¡æ— æ³•æ¯”æ‹Ÿçš„ å·¥ä»¶çš„ç‰ˆæœ¬å¾ˆæ€»è¦;ä¸€å®šè¦ä¸è‡ªå·±é¡¹ç›®ä¸­Scalaç‰ˆæœ¬å…¼å®¹ SBTä½¿ç”¨Apache Ivyä½œä¸ºè‡ªå·±çš„ä¾èµ–ç®¡ç†å™¨ï¼Œè€ŒIvyä¹Ÿè¢«Antå’ŒMavenä½¿ç”¨ï¼Œå› æ­¤èƒ½åœ¨Scalaé¡¹ç›®ä¸­å¾ˆå®¹æ˜“ä½¿ç”¨å¤šå¹´æ¥åˆ›å»ºçš„ä¸°å¯ŒJavaåº“ã€‚ SBTä½¿ç”¨standard Maven repositoryä½œä¸ºé»˜è®¤ä»“åº“(ç´¢å¼•çš„å·¥ä»¶æ•°æˆªè‡³2020/12/03å·²ç»æ˜¯18.4M); å¦‚æœä½ éœ€è¦çš„åº“æ²¡æœ‰å‘å¸ƒåˆ°æ”¹æ ‡å‡†åº“ä¸­ï¼Œä½ å¿…é¡»å‘Šè¯‰SBTå»å“ªé‡Œå¯»æ‰¾ï¼Œè¿™ä¸ªè¿‡ç¨‹é€šè¿‡æ·»åŠ ä¸€ä¸ªresolverè§£å†³ Multiple lib ä½¿ç”¨Seqæ–¹æ³•ï¼ˆæ³¨æ„æ˜¯++=ï¼‰ 12345libraryDependencies ++= Seq( \"net.sourceforge.htmlcleaner\" % \"htmlcleaner\" % \"2.4\", \"org.scalatest\" % \"scalatest_2.10\" % \"1.9.1\" % \"test\", \"org.foobar\" %% \"foobar\" % \"1.8\") Multiple project ä½¿ç”¨lazyï¼šæ„å»ºå¤šä¸ªé¡¹ç›® ä½¿ç”¨projectsï¼šæŸ¥çœ‹é¡¹ç›®ç»“æ„ ä½¿ç”¨.dependsOn:ä¸»é¡¹ç›®ä¾èµ–å¯ä»¥ç§»åˆ°å­é¡¹ç›®ä¸­ï¼Œç„¶åæ˜¾ç¤ºæŒ‡æ˜ 1.dependsOn(helloCore) // è¡¨ç¤ºä¾èµ–å­é¡¹ç›® ä½¿ç”¨distï¼šç”Ÿæˆé€šç”¨jaråŒ… åœ¨~/project/plugins.sbtæ·»åŠ æ’ä»¶ ã€~ä»£è¡¨é¡¹ç›®æ ¹ç›®å½•ã€ 1addSbtPlugin(\"com.typesafe.sbt\" % \"sbt-native-packager\" % \"1.3.4\") // æ·»åŠ sbt-native-packageræ’ä»¶,ç”¨äºæ‰“åŒ…universal package åœ¨build.sbtä¸­æ·»åŠ JavaAppPackaging 1.enablePlugins(JavaAppPackaging) // ç”¨äºæ‰“åŒ…dist? ä½¿ç”¨publishlocal: æŠŠåŒ…å‘å¸ƒåˆ°æœ¬åœ° é»˜è®¤æ˜¯åœ¨~\\.ivy2\\local\\æ–‡ä»¶å¤¹ä¸‹ ä¸¥æ ¼æŒ‰ç…§ä¸Šè¿°groupID % artifactID % revision % configurationæ¥ç»„ç»‡ 123456789101112131415161718192021-com.example // groupID - hello_2.12 // artifactID - 1.0.0 // revision - docs - ivys - jars - proms - scrs - hello-core_2.12 // å­é¡¹ç›®ç”Ÿæˆçš„å·¥ä»¶ - 1.0.0 - docs - ivys - jars - proms - scrs - 0.1.0-SNAPSHOT(è¿™æ˜¯è‡ªå‰å‘å¸ƒçš„) - docs - ivys - jars - proms - scrs ä½¿ç”¨Docker/publishLocal:ç”Ÿæˆé•œåƒ References[1] sbt-by-example [2] sbt-how-to-manage-project-dependencies-in-scala [3] mvnrepo-chisel3-core [4] Sbt ä¾èµ–é…ç½®","categories":[{"name":"CS","slug":"CS","permalink":"https://www.beenli.cn/categories/CS/"},{"name":"Programming","slug":"CS/Programming","permalink":"https://www.beenli.cn/categories/CS/Programming/"},{"name":"env_problems","slug":"CS/Programming/env-problems","permalink":"https://www.beenli.cn/categories/CS/Programming/env-problems/"}],"tags":[{"name":"Scala","slug":"Scala","permalink":"https://www.beenli.cn/tags/Scala/"}]},{"title":"The most used Scala Build Tools(SBT)","slug":"The-most-used-Scala-Build-Tools-SBT","date":"2020-12-03T01:19:39.000Z","updated":"2020-12-03T03:50:29.538Z","comments":true,"path":"posts/67dea116/","link":"","permalink":"https://www.beenli.cn/posts/67dea116/","excerpt":"","text":"æœ‰å¾ˆå¤šæ„å»ºå·¥å…·ï¼Œæ¯”å¦‚ Ant, Maven, Gradleç­‰ç­‰ï¼Œä½†æ˜¯ sbtæ˜¯ä¸“é—¨ä¸ºScalaè®¾è®¡çš„ã€‚å®ƒå‰äº›æ—¥å­è¿˜è¢«Scalaåˆ›å§‹äººMartin Oderskyè”åˆåˆ›åŠçš„Lightbendå…¬å¸æ”¯æŒã€‚ What is sbt sbt æ˜¯ä¸€ä¸ªäº¤äº’å¼æ„å»ºå·¥å…·:ä½ å¯ä»¥åœ¨Scala projectä¸­å®šä¹‰ä½ çš„taskï¼Œç„¶åä»äº¤äº’å¼sbt shell å¹¶è¡Œçš„è¿è¡Œå®ƒä»¬ã€‚ Why sbt ä¸“ä¸ºScalaå’ŒJavaè®¾è®¡ï¼šå®ƒèƒ½ä½¿ç”¨å¤šä¸ªScalaç‰ˆæœ¬äº¤å‰ç¼–è¯‘ä½ çš„é¡¹ç›®ã€‚ ç±»å‹å®‰å…¨å’Œå¹¶è¡Œçš„build.sbtï¼šä¸€ä¸ªåŸºäºScalaçš„DSL(domain specific language)ï¼Œç”¨äºè¡¨ç¤ºå¹¶è¡Œä»»åŠ¡å¤„ç†å›¾è°±ã€‚ä»»ä½•æ‰“å­—é”™è¯¯éƒ½ä¼šå¼•å‘ç¼–è¯‘é”™è¯¯ã€‚ å¿«é€Ÿè¿­ä»£ï¼šä½¿ç”¨Zinc å¢é‡ç¼–è¯‘å™¨å’Œæ–‡ä»¶ç›‘è§†å™¨ï¼Œä½¿å¾—ç¼–è¾‘-ç¼–è¯‘-æµ‹è¯•å¾ªç¯è¾¾åˆ°å¿«é€Ÿå¹¶ä¸”é€’å¢ å¯æ‰©å±•æ€§ï¼šæˆ‘ä»¬åªç”¨åœ¨build.sbtä¸­å†™å…¥ç›¸åº”ä»£ç ï¼Œå°±å¯ä»¥å¢åŠ å¯¹æ–°çš„ä»»åŠ¡æˆ–å¹³å°(æ¯”å¦‚Scala.js)çš„æ”¯æŒã€‚ Join 100+ community-maintained plugins to share and reuse sbt tasks Install sbt(1.4.4) for windows windows installer universal package ä½¿ç”¨Chocolateyã€ŒWindows å¹³å°åŒ…ç®¡ç†å™¨ã€ï¼š&gt; choco install sbt for linux æ¨èæŠŠsbtè½¯ä»¶åŒ…å‘å¸ƒçš„aptä»“åº“åŠ å…¥åˆ°æºåˆ—è¡¨ The sbt directory structure æ‰‹åŠ¨åˆ›å»ºé¡¹ç›®ç›®å½• 1234mkdir HelloWorldcd HelloWorldmkdir -p src/{main,test}/{java,resources,scala}mkdir project target é¡¹ç›®ä¸»ç›®å½•ä¸‹çš„åŸºæœ¬æ–‡ä»¶ç»“æ„å›¾ â€‹ ä½¿ç”¨sbtå‘½ä»¤è¡Œå·¥å…· 1sbt new scala/hello-world.g8 // ä»Githubä»“åº“ä¸Šæ‹‰ä¸‹æ¥é¡¹ç›®æ¨¡æ¿ ç›®å½•ç»“æ„å’ŒğŸ‘†å¤§åŒå°å¼‚ 12345678- hello-world - project (sbt uses this to install and manage plugins and dependencies) - build.properties - src - main - scala (All of your scala code goes here) - Main.scala (Entry point of program) &lt;-- this is all we need for now - build.sbt (sbt's build definition file) Running the project1sbt run Project management build.sbtæ–‡ä»¶éå¸¸é‡è¦ï¼Œä½ é¡¹ç›®çš„Scalaç‰ˆæœ¬ï¼Œä¾èµ–é¡¹å…¨åœ¨é‡Œé¢æœ‰è¯´æ˜ã€‚ æ·»åŠ ä¾èµ–åï¼Œä½ æ‰å¯ä»¥åœ¨ä½ çš„ç¨‹åºé‡Œé¢æ­£å¸¸importï¼› å‘å¸ƒçš„åŒ…å¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹ æ›´å¤šå†…å®¹è¯·è§ä¸‹ä¸€ç¯‡æ–‡ç« ï¼šã€build.sbt è¯¦è§£ã€‘ğŸ˜¸ References[1] Scala book [2] GETTING STARTED WITH SCALA [3] sbt reference","categories":[{"name":"CS","slug":"CS","permalink":"https://www.beenli.cn/categories/CS/"},{"name":"Programming","slug":"CS/Programming","permalink":"https://www.beenli.cn/categories/CS/Programming/"},{"name":"env_problems","slug":"CS/Programming/env-problems","permalink":"https://www.beenli.cn/categories/CS/Programming/env-problems/"}],"tags":[{"name":"Scala","slug":"Scala","permalink":"https://www.beenli.cn/tags/Scala/"}]},{"title":"batch file(1) -- for statement","slug":"batch-file-1-for-statement","date":"2020-12-02T13:09:50.000Z","updated":"2020-12-03T00:46:22.889Z","comments":true,"path":"posts/c8d1a621/","link":"","permalink":"https://www.beenli.cn/posts/c8d1a621/","excerpt":"","text":"1 official explanation type for /? in your cmd.exe prompt 2 common usage1 è·Ÿpythoné‡Œé¢è¿­ä»£å™¨å‘ã€Œiteratorã€å¾ˆåƒï¼Œå¯¹ä¸€ä¸ªé›†åˆçš„æ•°æ®åšç›¸åŒçš„æ“ä½œã€‚ note: å¦‚æœæ˜¯åœ¨å‘½ä»¤è¡Œ,é‚£ä¹ˆä½¿ç”¨%G;åœ¨è„šæœ¬æ–‡ä»¶ä¸­ä½¿ç”¨%%G å¦‚æœè¿­ä»£å™¨æ¯æ¬¡äº§ç”Ÿä¸€ä¸ªå€¼,é‚£æ­£å¥½èµ‹å€¼ä¸º%%G å¦‚æœè¿­ä»£å™¨æ¯æ¬¡äº§ç”Ÿå¤šä¸ªå€¼,é‚£ä¹ˆç³»ç»Ÿéšå¼å®šä¹‰å‡ ä¸ªå˜é‡æ¥ä¿å­˜å€¼ï¼Œé»˜è®¤æ˜¯æŒ‰å­—æ¯é¡ºåº:%%H %%I %%Jâ€¦ å¦‚æœè¿­ä»£å™¨äº§ç”Ÿæ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨æ‰©å±•ç¬¦æ¥æå–æ–‡ä»¶åç§°/è·¯å¾„/æ—¥æœŸ/å¤§å°ç­‰ 1 for 1FOR %%parameter IN (set) DO command æŠŠä¸€ç³»åˆ—æ–‡ä»¶æ‹·è´åˆ°å¤‡ä»½ 1FOR %%G IN (\"C:\\demo files\\file1.txt\" \"C:\\demo files\\File2.txt\") DO copy %%G d:\\backups\\ 2 for /R 1FOR /R [[drive:]path] %%parameter IN (set) DO command å¦‚æœçœç•¥[[drive:]path] é‚£ä¹ˆç”¨å½“å‰çš„ä»£æ›¿ setå¿…é¡»ä½¿ç”¨é€šé…ç¬¦?å’Œ. å¦‚æœ(set)ä¸º(.), é‚£ä¹ˆä¾¿åˆ©æ¯ä¸ªæ–‡ä»¶å¤¹ï¼Œä¸éå†æ–‡ä»¶test åˆ—å‡ºä»C:\\temp\\å¼€å§‹çš„æ¯ä¸ªå­æ–‡ä»¶å¤¹ä¸­çš„æ¯ä¸ª.bakæ–‡ä»¶ 1For /R C:\\temp\\ %%G IN (*.bak) do Echo \"%%G\" å°†â€™demoâ€™æ–‡ä»¶å¤¹å’Œæ‰€æœ‰å­æ–‡ä»¶å¤¹ä¸­çš„.LOGæ–‡ä»¶é‡å‘½åä¸º.TXT: 1For /R C:\\demo\\ %%G in (*.LOG) do Echo REN \"%%G\" \"%%~nG.TXT\" ä¾æ¬¡å°†ç›®å½•æ›´æ”¹ä¸ºå½“å‰æ–‡ä»¶å¤¹ä¸‹çš„æ¯ä¸ªå­æ–‡ä»¶å¤¹(åŒ…å«è‡ªå·±æ‰€åœ¨æ–‡ä»¶å¤¹)2 12345FOR /R %%G in (.) DO ( Pushd %%G Echo now in %%G Popd )Echo \"back home\" 3 for /D 1FOR /D [/r] %%parameter IN (folder_set) DO command åœ¨å‡ ä¸ªç›®å½•/æ–‡ä»¶å¤¹ä¸Šæœ‰æ¡ä»¶åœ°æ‰§è¡Œä¸€ä¸ªå‘½ä»¤ã€‚ /r é€’å½’çš„è¿›å…¥å­æ–‡ä»¶å¤¹ åˆ—å‡ºåç§°ä»¥â€œUsersâ€å¼€å¤´çš„æ–‡ä»¶å¤¹C:\\Work\\ä¸‹é¢çš„æ¯ä¸ªå­æ–‡ä»¶å¤¹ 123@Echo OffCD \\WorkFOR /D /r %%G in (\"User*\") DO Echo We found %%~nxG 4 for /L 1FOR /L %%parameter IN (start,step,end) DO command æœ‰æ¡ä»¶åœ°å¯¹ä¸€ç»„æ•°å­—æ‰§è¡Œå‘½ä»¤ã€‚ ä»1æ•°åˆ°5 1FOR /L %%G IN (1,1,5) DO echo %%G éæ•°å€¼åˆ—è¡¨å¯ä»¥ä½¿ç”¨æ ‡å‡†çš„forå‘½ä»¤ 1FOR %%G IN (Sun Mon Tue Wed Thur Fri Sat) DO echo %%G ç»™æ–‡ä»¶åˆ›å»º1000ä¸ªå‰¯æœ¬ 1FOR /l %%G in (1,1,1000) DO copy SourceFile.txt NewFile%%G.txt 5 for /F 123FOR /F [\"options\"] %%parameter IN (filenameset) DO command FOR /F [\"options\"] %%parameter IN (\"Text string to process\") DO command é’ˆå¯¹æ–‡ä»¶é‡Œé¢çš„å­—ç¬¦å¤„ç† options:(ä¼˜å…ˆçº§ï¼šusebackq &gt; skip &gt; delims &gt; eol &gt; tokens) delims=xxx(åˆ†éš”ç¬¦, é»˜è®¤ä¸ºç©ºæ ¼) skip=n ï¼ˆæ–‡ä»¶å¼€å¤´è¦è·³è¿‡çš„ä¸€äº›è¡Œ,é»˜è®¤ä¸º0) eol=; (æ¯è¡Œå¼€å¤´æŒ‡ç¤ºæ³¨é‡Šçš„å­—ç¬¦ï¼Œé»˜è®¤ä¸ºåˆ†å·;) tokens=n (æŒ‡å®šè¦ä»æ¯è¡Œè¯»å–å“ªäº›ç¼–å·çš„é¡¹,é»˜è®¤ä¸º1) usebackq (ä½¿ç”¨äº¤æ›¿å¼•ç”¨çš„é£æ ¼) å¦‚æœâ€delims=â€,é‚£ä¹ˆæŠŠä¸€è¡Œéƒ½è§†ä¸ºç¬¬ä¸€ä¸ªtoken â€œeol=&amp;â€ ä¸€èˆ¬æŠŠeolè®¾ç½®ä¸ºä¸å®¹æ˜“ç¢°åˆ°çš„å­—ç¬¦ï¼Œé¿å…æŠŠæœ¬è¯¥è§£é‡Šçš„è¡Œæ³¨é‡Šæ‰ â€œskip=3â€ å»æ‰å‰é¢ä¸‰ä¸ªç©ºè¡Œ tokensç”¨æ³•:2,4,6, 2-6(2åˆ°6),*(æ‰€æœ‰), 3*(ç¬¬4ä¸ªèµ·åé¢çš„) å¤åˆ¶æ–‡æœ¬æ–‡ä»¶ä¸­åˆ—å‡ºçš„æ–‡ä»¶åˆ°æ–°çš„ç›®çš„åœ°: 12å‡è®¾files.txtæ¯è¡ŒåŒ…å«ä¸€ä¸ªæ–‡ä»¶åFOR /f \"delims=\" %%G in (files.txt) DO copy \"\\\\source\\folder\\%%G\" \"H:\\destination\\%%G\" ä»åŒ…å«å­—ç¬¦å’Œé€—å·çš„æ–‡æœ¬æ–‡ä»¶ä¸­æå–æ•°æ® æ–‡ä»¶å¦‚ä¸‹ï¼š January,Snowy,02February,Rainy,15March,Sunny,25 1FOR /F \"tokens=1,3 delims=,\" %%G IN (weather.txt) DO @echo %%G %%H ç»“æœå¦‚ä¸‹ï¼š January 02February 15March 25 è§£æä¸€æ®µå­—ç¬¦ä¸² 1FOR /F \"tokens=4 delims=,\" %%G IN (\"deposit,$4500,123.4,12-AUG-09\") DO @echo Date paid %%G è¾“å‡ºï¼šDate paid 12-AUG-09 6 for /F 1FOR /F [\"options\"] %%parameter IN ('command to process') DO command å‘½ä»¤è§£æï¼šå¯¹å‘½ä»¤çš„å¤„ç†åŒ…æ‹¬æ¯æ¬¡è¯»å–ä¸€è¡Œå‘½ä»¤çš„è¾“å‡ºï¼Œç„¶åå°†è¯¥è¡Œåˆ†è§£ä¸ºå•ä¸ªçš„æ•°æ®é¡¹æˆ–â€œtokensâ€ã€‚ç„¶åæ‰§è¡ŒDOå‘½ä»¤ï¼Œå¹¶å°†å‚æ•°è®¾ç½®ä¸ºæ‰¾åˆ°çš„tokensã€‚ ä½¿ç”¨åœºæ™¯ï¼šä½ æƒ³æ‰§è¡Œä¸€äº›å‘½ä»¤ï¼ŒæŠŠå‘½ä»¤æŒ‡ä»¤çš„ç»“æœæå–å‡ºæ¥å¹¶èµ‹äºˆå˜é‡ï¼Œç„¶åå¯¹è¯¥å˜é‡è¿›è¡Œä¸€ç³»åˆ—æ“ä½œ åªæ‰“å°ç¯å¢ƒå˜é‡ï¼Œä¸æ‰“å°å…¶å€¼ 1FOR /F \"delims==\" %G IN ('SET') DO @Echo %G æŠŠWindowsç‰ˆæœ¬è®¾ç½®ä¸ºç¯å¢ƒå˜é‡ 1FOR /F \"tokens=4*\" %%G IN ('ver') DO SET _version=%%G è¾“å‡ºç»“æœï¼š SET _version=10.0.19042.630] ï¼ˆå…¶ä¸­å‘½ä»¤envè¾“å‡º:Microsoft Windows [Version 10.0.19042.630]) åˆ—å‡ºä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰æ–‡æœ¬æ–‡ä»¶ï¼ŒåŒ…æ‹¬å®Œæ•´è·¯å¾„ 1FOR /F \"tokens=*\" %%G IN ('dir/b /s ^\"c:\\program files\\*.txt^\"') DO echo %%G References1.For - Looping commands - Windows CMD â†©2.windows-commands pushd â†©","categories":[{"name":"CS","slug":"CS","permalink":"https://www.beenli.cn/categories/CS/"},{"name":"Programming","slug":"CS/Programming","permalink":"https://www.beenli.cn/categories/CS/Programming/"},{"name":"Scripts","slug":"CS/Programming/Scripts","permalink":"https://www.beenli.cn/categories/CS/Programming/Scripts/"}],"tags":[{"name":"Batch","slug":"Batch","permalink":"https://www.beenli.cn/tags/Batch/"}]},{"title":"Install Scala","slug":"Install-Scala","date":"2020-12-02T07:39:04.000Z","updated":"2020-12-03T00:54:33.211Z","comments":true,"path":"posts/74349f7/","link":"","permalink":"https://www.beenli.cn/posts/74349f7/","excerpt":"","text":"1 Install what1 å®‰è£…Installæ„å‘³ç€å®‰è£…å„ç§å‘½ä»¤è¡Œå·¥å…·ã€ŒScala compiler, coursier, sbtâ€¦ã€å’Œæ„å»ºå·¥å…·ã€Œbuild toolsã€ 2 how to install æœ‰ä¸¤ç§åŠæ³•ï¼š Scala Installer toolï¼šè‡ªåŠ¨å®‰è£…æ‰€æœ‰ä¾èµ– æ‰‹åŠ¨å®‰è£… â‘  Scala InstallerWindows msiï¼šè·å–å®‰è£…åŒ…Scala-2.13.4(è¿™ç§æ–¹æ³•æœ€ç®€ä¾¿, è·ŸWindowså…¶å®ƒè½¯ä»¶åŒ…å®‰è£…æ–¹å¼ä¸€æ ·) æˆ–è€…ä¸‹è½½coursier(Scalaå·¥ä»¶ã€Œartifactã€è·å–å™¨) ğŸ‘‡ä¸‰ç§æ–¹æ³•ä»»é€‰å…¶ä¸€ ä¸‹è½½æºä»£ç (è‡ªå·±ç¼–è¯‘,æ‰“åŒ…æˆjaråŒ…) ä¸‹è½½è„šæœ¬+jaråŒ… ä¸‹è½½äºŒè¿›åˆ¶æ–‡ä»¶ æ–¹æ³•äºŒè¯¦è§£: ç¡®ä¿ä½ æœ‰Javaï¼ˆè¿è¡ŒJava â€”version) ç¡®ä¿ç¯å¢ƒå˜é‡è®¾ç½®æ­£ç¡®âœ”(set JAVA_HOME=/path/to/java/installation) notes: æ¯”å¦‚ä½ java.exeåœ¨D:\\app\\jdk\\bin\\java.exe; é‚£å°±è®¾ç½®JAVA_HOME=D:\\app\\jdkå³å¯,ä¸è¦å†åŠ \\ è„šæœ¬è‡ªåŠ¨æ£€æµ‹ä½ ç”µè„‘ä¸Šçš„Javaç¯å¢ƒ, å¦‚æœæ²¡æœ‰è‡ªåŠ¨ä¸‹è½½ è‡ªåŠ¨ä¸‹è½½æ ‡å‡†Scalaåº”ç”¨ç¨‹åºåˆ°~\\AppData\\Local\\Coursier\\data\\bin ammonite improved Scala REPL(ç›¸å½“äºipython) cs coursier scala Scala REPL scalac scala compiler sbt Scalaæ„å»ºå·¥å…· â‘¡ manually ä¸‹è½½Oracle Java 8\\11 ä¸‹è½½sbt ğŸ‘†coursierå¯ä»¥çœ‹æˆå®ƒçš„æ’ä»¶ï¼Œç”¨äºè§£å†³åŒ…ä¾èµ–é—®é¢˜ ä¸ºè‡ªå·±é¡¹ç›®é€‰å®šç‰¹å®šScalaç‰ˆæœ¬ï¼Œç›¸åº”çš„åŒ…ç‰ˆæœ¬;sbtä¼šå¸®ä½ è‡ªåŠ¨è§£å†³ 3 check å¦‚æœä½ ç”¨çš„msiå®‰è£…åŒ…,é»˜è®¤å®‰è£…åœ¨c/Program Files (x86)/scala/bin/ä¸‹ å¦‚æœä½¿ç”¨csï¼Œé‚£ä¹ˆåœ¨~/AppData/Local/Coursier/data/bin ä¸‹ References1.Getting started with scala â†©","categories":[{"name":"CS","slug":"CS","permalink":"https://www.beenli.cn/categories/CS/"},{"name":"Programming","slug":"CS/Programming","permalink":"https://www.beenli.cn/categories/CS/Programming/"},{"name":"env_problems","slug":"CS/Programming/env-problems","permalink":"https://www.beenli.cn/categories/CS/Programming/env-problems/"}],"tags":[{"name":"Scala","slug":"Scala","permalink":"https://www.beenli.cn/tags/Scala/"}]},{"title":"Generate constructs","slug":"Generate-constructs","date":"2020-11-10T10:55:31.000Z","updated":"2020-11-10T12:28:34.126Z","comments":true,"path":"posts/7a9bb3ef/","link":"","permalink":"https://www.beenli.cn/posts/7a9bb3ef/","excerpt":"","text":"Preface Generate constructs are used to either conditionally or multiply instantiate generate blocks into a model ç”Ÿæˆç»“æ„ç”¨äºè¦ä¹ˆæœ‰æ¡ä»¶åœ°æˆ–æˆå€åœ°å®ä¾‹åŒ–ç”Ÿæˆå—åˆ°ä¸€ä¸ªæ¨¡å‹ä¸­ã€‚ æœ‰ä¸¤ç§ç”Ÿæˆç»“æ„ï¼šloopså’Œconditionals loops: ç”¨äºå®ä¾‹ç”Ÿæˆå—å¤šæ¬¡ conditionals: åŒ…æ‹¬if-generateå’Œcase-generateç»“æ„;æœ€å¤šä»ä¸€ç³»åˆ—generate blocksä¸­é€‰æ‹©ä¸€ä¸ª. Generate schemes are evaluated during elaboration of the model. ç”Ÿæˆæ–¹æ³•ï¼šå†³å®šå“ªä¸ªç”Ÿæˆå—è¢«å®ä¾‹åŒ–æˆ–å¤šå°‘ç”Ÿæˆå—è¢«å®ä¾‹åŒ–çš„æ–¹æ³•ã€‚ Elaboration occurs after parsing the HDL and before simulation(ç”Ÿæˆå‘ç”Ÿåœ¨è§£æHDLä¹‹åä»¿çœŸä¹‹å‰);åŒ…æ‹¬å¦‚ä¸‹äº”ä¸ªè¿‡ç¨‹ï¼š expanding module instantiations computing parameter values resolving hierarchical names establishing net connectivity preparing the model for simulation Loop generate constructs loopç”Ÿæˆç»“æ„è¿è¡Œä½¿ç”¨ç±»ä¼¼for loop çš„è¯­æ³•æŠŠä¸€ä¸ªç”Ÿæˆå—å®ä¾‹å¤šæ¬¡ã€‚å¾ªç¯ç´¢å¼•å˜é‡åº”è¯¥åœ¨ä½¿ç”¨å‰ç”¨genvarå£°æ˜ï¼›genvaråªåœ¨elaborationæ—¶æœ‰ç”¨ï¼Œæ‰€ä»¥ä½ ä¸èƒ½åœ¨ç”Ÿæˆå—ä»»ä½•åœ°æ–¹å¼•ç”¨å®ƒã€‚ å‚æ•°åŒ– 123456789101112131415module gray2bin1 (bin, gray); parameter SIZE = 8; // this module is parameterizable output [SIZE-1:0] bin; input [SIZE-1:0] gray; genvar i; generate for (i=0; i&lt;SIZE; i=i+1) begin :bit assign bin[i] = ^gray[SIZE-1:i]; // i refers to the implicitly defined localparam whose // value in each instance of the generate block is // the value of the genvar when it was elaborated. end endgenerateendmodule ä½¿ç”¨äºŒç»´netæŠŠç”Ÿæˆçš„å®ä¾‹è¿æ¥èµ·æ¥ 1234567891011121314151617181920212223242526272829303132module addergen1 (co, sum, a, b, ci); parameter SIZE = 4; output [SIZE-1:0] sum; output co; input [SIZE-1:0] a, b; input ci; wire [SIZE :0] c; wire [SIZE-1:0] t [1:3]; genvar i; assign c[0] = ci; // Hierarchical gate instance names are: // xor gates: bit[0].g1 bit[1].g1 bit[2].g1 bit[3].g1 // bit[0].g2 bit[1].g2 bit[2].g2 bit[3].g2 // and gates: bit[0].g3 bit[1].g3 bit[2].g3 bit[3].g3 // bit[0].g4 bit[1].g4 bit[2].g4 bit[3].g4 // or gates: bit[0].g5 bit[1].g5 bit[2].g5 bit[3].g5 // Generated instances are connected with // multidimensional nets t[1][3:0] t[2][3:0] t[3][3:0] // (12 nets total) for (i=0; i&lt;SIZE; i=i+1) begin :bit xor g1 ( t[1][i], a[i], b[i]); xor g2 ( sum[i], t[1][i], c[i]); and g3 ( t[2][i], a[i], b[i]); and g4 ( t[3][i], t[1][i], c[i]); or g5 ( c[i+1], t[2][i], t[3][i]); end assign co = c[SIZE]; endmodule multilevel generate loop 123456789101112131415161718192021222324parameter SIZE = 2; genvar i, j, k, m; generate for (i=0; i&lt;SIZE; i=i+1) begin :B1 // scope B1[i] M1 N1(); // instantiates B1[i].N1 for (j=0; j&lt;SIZE; j=j+1) begin :B2 // scope B1[i].B2[j] M2 N2(); // instantiates B1[i].B2[j].N2 for (k=0; k&lt;SIZE; k=k+1) begin :B3 // scope B1[i].B2[j].B3[k] M3 N3(); // instantiates B1[i].B2[j].B3[k].N3 end end if (i&gt;0) begin :B4 // scope B1[i].B4 for (m=0; m&lt;SIZE; m=m+1) begin :B5 // scope B1[i].B4.B5[m] M4 N4(); // instantiates B1[i].B4.B5[m].N4 end end end endgenerate // Some examples of hierarchical names for the module instances: // B1[0].N1 B1[1].N1 // B1[0].B2[0].N2 B1[0].B2[1].N2 // B1[0].B2[0].B3[0].N3 B1[0].B2[0].B3[1].N3 // B1[0].B2[1].B3[0].N3 // B1[1].B4.B5[0].N4 B1[1].B4.B5[1].N4 Conditional generate constructs æ¡ä»¶ç”Ÿæˆç»“æ„åªèƒ½é€‰æ‹©ä¸€ä¸ªç”Ÿæˆå— 1234567891011121314151617181920212223242526272829303132module test;parameter p = 0, q = 0;wire a, b, c;//---------------------------------------------------------// Code to either generate a u1.g1 instance or no instance.// The u1.g1 instance of one of the following gates:// (and, or, xor, xnor) is generated if// {p,q} == {1,0}, {1,2}, {2,0}, {2,1}, {2,2}, {2, default}//---------------------------------------------------------if (p == 1) if (q == 0) begin : u1 // If p==1 and q==0, then instantiate and g1(a, b, c); // AND with hierarchical name test.u1.g1 end else if (q == 2) begin : u1 // If p==1 and q==2, then instantiate or g1(a, b, c); // OR with hierarchical name test.u1.g1 end // \"else\" added to end \"if (q == 2)\" statement else ; // If p==1 and q!=0 or 2, then no instantiationelse if (p == 2) case (q) 0, 1, 2: begin : u1 // If p==2 and q==0,1, or 2, then instantiate xor g1(a, b, c);// XOR with hierarchical name test.u1.g1 end default : begin : u1 // If p==2 and q!=0,1, or 2, then instantiate xnor g1(a, b, c);// XNOR with hierarchical name test.u1.g1 end endcaseendmodule External names for unnamed å°½ç®¡ä¸€ä¸ªæ²¡æœ‰åå­—çš„ç”Ÿæˆå—æ²¡æœ‰å¯ä»¥è¢«ä½¿ç”¨çš„é˜¶çº§åå­—(hierarchical name)ï¼Œä½†æ˜¯å®ƒéœ€è¦ä¸€ä¸ªåå­—è®©å¤–éƒ¨æ¥å£å¯ä»¥è®¿é—®å®ƒã€‚å› æ­¤å‡ºäºè¯¥ç›®çš„å°†ä¼šç»™ä»–ä»¬åˆ†é…åå­—ã€‚ æ‰€æœ‰æ²¡åå­—çš„ç”Ÿæˆå—å°†è¢«ç»™äºˆgenblk&lt;n&gt;åå­—,å…¶ä¸­æ˜¯è¢«åˆ†é…åˆ°å®ƒåŒ…æ‹¬çš„ç”Ÿæˆç»“æ„çš„æ¬¡æ•°ã€‚ï¼ˆä»1å¼€å§‹è®¡æ•°ï¼‰ï¼›å¦‚æœæœ‰å†²çª,åœ¨å‰é¢åŠ 0ç›´åˆ°ä¸å†²çªä¸ºæ­¢ 1234567891011121314151617181920212223242526272829module top; parameter genblk2 = 0; genvar i; // The following generate block is implicitly named genblk1 if (genblk2) reg a; // top.genblk1.a else reg b; // top.genblk1.b // The following generate block is implicitly named genblk02 // as genblk2 is already a declared identifier if (genblk2) reg a; // top.genblk02.a else reg b; // top.genblk02.b // The following generate block would have been named genblk3 // but is explicitly named g1 for (i = 0; i &lt; 1; i = i + 1) begin : g1 // block name // The following generate block is implicitly named genblk1 // as the first nested scope inside of g1 if (1) reg a; // top.g1[0].genblk1.a end // The following generate block is implicitly named genblk4 since // it belongs to the fourth generate construct in scope \"top\". // The previous generate block would have been // named genblk3 if it had not been explicitly named g1 for (i = 0; i &lt; 1; i = i + 1) // The following generate block is implicitly named genblk1 // as the first nested generate block in genblk4 if (1) reg a; // top.genblk4[0].genblk1.a // The following generate block is implicitly named genblk5 if (1) reg a; // top.genblk5.aendmodule","categories":[{"name":"Digital IC","slug":"Digital-IC","permalink":"https://www.beenli.cn/categories/Digital-IC/"},{"name":"verilog","slug":"Digital-IC/verilog","permalink":"https://www.beenli.cn/categories/Digital-IC/verilog/"}],"tags":[{"name":"specification","slug":"specification","permalink":"https://www.beenli.cn/tags/specification/"}]},{"title":"jupyterlab environment","slug":"jupyterlab-environment","date":"2020-10-21T12:44:31.000Z","updated":"2020-10-21T14:10:01.843Z","comments":true,"path":"posts/e121429a/","link":"","permalink":"https://www.beenli.cn/posts/e121429a/","excerpt":"","text":"The blog is derived from the transition of JupyterLab document Preface JupyterLab is the next-generation web-based user interface for Project Jupyter. JupyterLab enables you to work with documents and activities such as Jupyter notebooks, text editors, terminals, and custom components in a flexible, integrated, and extensible manner. jupyterlabæ˜¯ä¸‹ä¸€ä»£åŸºäºwebçš„Jupyteré¡¹ç›®ç”¨æˆ·ç•Œé¢ï¼›å®ƒèƒ½è®©ä½ ä»¥çµæ´»ã€é›†æˆå’Œå¯æ‰©å±•çš„æ–¹å¼ä¸æ–‡æ¡£å’Œæ´»åŠ¨ä¸€èµ·å·¥ä½œï¼Œæ¯”å¦‚notebookï¼Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼Œç»ˆç«¯è¿˜æœ‰è‡ªå®šä¹‰ç»„ä»¶ã€‚ Installation prerequisite å®‰è£…notebook 1conda install -c conda-forge notebook å®‰è£…jupyterlab 1conda install -c conda-forge jupyterlab Start åœ¨conda promptä¸­æ•²å¦‚ä¸‹å‘½ä»¤ 1jupyter lab jupyter labä¼šè‡ªåŠ¨åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ 1http(s)://&lt;server:port&gt;/&lt;lab-location&gt;/lab å› ä¸ºJupyterLabæ˜¯jupyter notebookä¸€ä¸ªæœåŠ¡å™¨æ‰©å±•ï¼Œæ‰€ä»¥ä½ ä¹Ÿèƒ½å¤Ÿé€šè¿‡è°ƒç”¨jupyter notebookå¹¶è®¿é—®/lab URLæ¥ç™»å½•JupyterLabã€‚ å¦‚æœğŸ‘†æœ‰é—®é¢˜,å¤šåŠæ˜¯kernelæœ‰é—®é¢˜; é¦–å…ˆå°è¯•å»ºç«‹ä¸€ä¸ªå¹²å‡€çš„jupyterç¯å¢ƒ 123conda create -n jlab-test --override-channels --strict-channel-priority -c conda-forge -c anaconda jupyterlab // åˆ›å»ºä¸€ä¸ªæ–°çš„ç¯å¢ƒconda activate jlab-test // åˆ‡æ¢åˆ°è¯¥ç¯å¢ƒjupyter lab // å¯åŠ¨jupyterlab","categories":[{"name":"Software","slug":"Software","permalink":"https://www.beenli.cn/categories/Software/"},{"name":"jupyter","slug":"Software/jupyter","permalink":"https://www.beenli.cn/categories/Software/jupyter/"}],"tags":[{"name":"python","slug":"python","permalink":"https://www.beenli.cn/tags/python/"},{"name":"toolkits","slug":"toolkits","permalink":"https://www.beenli.cn/tags/toolkits/"}]},{"title":"Conda environment","slug":"Conda-environment","date":"2020-10-21T05:20:57.000Z","updated":"2020-12-20T13:56:31.303Z","comments":true,"path":"posts/ac51cf39/","link":"","permalink":"https://www.beenli.cn/posts/ac51cf39/","excerpt":"","text":"The blog is derived from the transilation of conda document: https://docs.conda.io/projects/conda/en/latest/ Preface Package, dependency and environment management for any languageâ€”-Python, R, Ruby, Lua, Scala, Java, JavaScript, C/ C++, FORTRAN å¯¹python, Rç­‰è¯­è¨€å…¶åŒ…ï¼Œä¾èµ–å’Œç¯å¢ƒçš„ç®¡ç† 1ã€åŸºæœ¬åŠŸèƒ½ Condaæ˜¯ä¸€ä¸ªå¼€æºåŒ…ç®¡ç†ç³»ç»Ÿå’Œç¯å¢ƒç®¡ç†ç³»ç»Ÿ,å¯ä»¥è¿è¡Œåœ¨Windows, MacOS, Linuxä¸Š. Condaèƒ½å¤Ÿå¿«é€Ÿå®‰è£…,è¿è¡Œ,å‡çº§åŒ…å’ŒåŒ…çš„ä¾èµ–. Condaèƒ½è½»æ˜“åœ°åœ¨æœ¬åœ°åˆ›å»º,ä¿å­˜å’Œåˆ‡æ¢ç¯å¢ƒ. condaèµ·åˆæ˜¯ä¸ºPythonç¨‹åºåˆ›å»º,ä½†å®ƒèƒ½æ‰“åŒ…å’Œå‘å¸ƒ(package and distribute)å…¶å®ƒè¯­è¨€çš„è½¯ä»¶. 2ã€åº”ç”¨åœºæ™¯ Condaä½œä¸ºåŒ…ç®¡ç†å™¨ï¼Œå¸®åŠ©ä½ æ‰¾åˆ°å¹¶å®‰è£…ä½ éœ€è¦çš„åŒ…ã€‚å¦‚æœæ‚¨éœ€è¦ä¸€ä¸ªéœ€è¦ä¸åŒç‰ˆæœ¬Pythonçš„åŒ…ï¼Œä½ ä¸éœ€è¦åˆ‡æ¢åˆ°å¦ä¸€ä¸ªç¯å¢ƒç®¡ç†å™¨ï¼Œå› ä¸ºcondaä¹Ÿæ˜¯ä¸€ä¸ªç¯å¢ƒç®¡ç†å™¨(environment manager)ã€‚åªéœ€è¦ä¸€äº›å‘½ä»¤ï¼Œä½ å°±èƒ½å»ºç«‹ä¸€ä¸ªå®Œå…¨ç‹¬ç«‹çš„ç¯å¢ƒå»è¿è¡Œä¸åŒç‰ˆæœ¬çš„pythonï¼ŒåŒæ—¶åœ¨æ­£å¸¸ç¯å¢ƒä¸­ç»§ç»­è¿è¡Œæ‚¨é€šå¸¸ç‰ˆæœ¬çš„Python åœ¨condaé»˜è®¤çš„é…ç½®ä¸­ï¼Œcondaèƒ½å¤Ÿåœ¨repo.anaconda.comå®‰è£…å’Œç®¡ç†è¶…è¿‡7500ä¸ªåŒ…;è¿™äº›åŒ…è¢«AnacondaÂ®æ„å»ºã€è¯„å®¡å’Œç»´æŠ¤. Condaå¯ä»¥ä¸Travis CIå’ŒAppVeyorç­‰æŒç»­é›†æˆç³»ç»Ÿç›¸ç»“åˆï¼Œä¸ºä»£ç æä¾›é¢‘ç¹çš„è‡ªåŠ¨åŒ–æµ‹è¯•ã€‚ 3ã€è·å–Conda é€šè¿‡ä¸‹è½½AnacondaÂ®, Miniconda, and Anaconda Repository é€šè¿‡Anaconda Enterprise(æ”¶è´¹) Conda is also available on conda-forge, a community channel You may also get conda on PyPI, but that approach may not be as up to date. 4ã€Anaconda anaconda is a graphical user interface that lets you use conda in a web-like interface without having to enter manual commands anacondaæœ‰å›¾å½¢ç•Œé¢ï¼Œå¯¹ç”¨æˆ·æ›´åŠ å‹å¥½,ä½†å†…æ ¸è¿˜æ˜¯conda Getting stated1ã€æ‰“å¼€å‘½ä»¤è¡Œå¦‚æœæ˜¯Windows,æœ€å¥½ç”¨anaconda prompt,è²Œä¼¼cmdä¹Ÿå¯;Linuxå°±ç›´æ¥åœ¨terminalè¾“å‘½ä»¤å³å¯. å¦‚æœä¸æ˜¯æœ€æ–°çš„ï¼Œå»ºè®®æ›´æ–°åˆ°æœ€æ–° 123conda --veriosn4.9.0conda updata conda å¦‚æœğŸ‘†ä¸èµ·ä½œç”¨ï¼šå‡ºç°äº†RemoveError ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š 1conda update --force-reinstall conda(é‡æ–°å®‰è£…) 2ã€åˆ›å»ºä¸€ä¸ªç¯å¢ƒ Condaå…è®¸æ‚¨åˆ›å»ºåŒ…å«æ–‡ä»¶ã€åŒ…åŠå…¶ä¸ä¸å…¶ä»–ç¯å¢ƒäº¤äº’çš„ä¾èµ–é¡¹çš„ç‹¬ç«‹ç¯å¢ƒã€‚ å½“ä½ å¼€å§‹ä½¿ç”¨condaï¼Œå°±å·²ç»æœ‰ä¸€ä¸ªé»˜è®¤çš„ç¯å¢ƒbase;ä½†æ˜¯,æ‚¨ä¸å¸Œæœ›å°†ç¨‹åºæ”¾åˆ°åŸºæœ¬ç¯å¢ƒä¸­ã€‚åˆ›å»ºå•ç‹¬çš„ç¯å¢ƒï¼Œä½¿æ‚¨çš„ç¨‹åºå½¼æ­¤éš”ç¦»ã€‚ åˆ›å»ºä¸€ä¸ªæ–°çš„ç¯å¢ƒ,å¹¶åœ¨å…¶ä¸­å®‰è£…ä¸€ä¸ªåŒ…. 1conda create --name snowflakes numpy condaéšåä¼šæ£€æŸ¥æ˜¯å¦æœ‰é¢å¤–çš„åŒ…(â€œdependenciesâ€)æ˜¯numpyæ‰€éœ€,å¹¶é—®ä½ æ˜¯å¦è¦ç»§ç»­: 1Proceed ([y]/n)? y è¾“å…¥â€yâ€å¹¶æŒ‰Enterç»§ç»­. åˆ‡æ¢åˆ°åˆšåˆšåˆ›å»ºçš„ç¯å¢ƒ 123456conda info --envs [-e] // æŸ¥çœ‹å·²æœ‰çš„ç¯å¢ƒåˆ—è¡¨(å¸¦*è¡¨ç¤ºå½“å‰ç¯å¢ƒ)# conda environments:#base D:\\APP\\minicondapy38 D:\\APP\\miniconda\\envs\\py38snowflakes * D:\\APP\\miniconda\\envs\\snowflakes 1conda activate snowflakes // åˆ‡æ¢åˆ°ç¯å¢ƒsnowflakes ä¿®æ”¹åˆšåˆšåˆ›å»ºçš„ç¯å¢ƒçš„åå­— 12conda create -n new_name --clone old_nameconda remove -n old_name --all 3ã€ç®¡ç†åŒ… åœ¨è¿™éƒ¨åˆ†ï¼Œä½ å°†å­¦ä¼šæ£€æŸ¥ä½ å®‰è£…äº†å“ªäº›åŒ…, æ£€æŸ¥å“ªäº›åŒ…æ˜¯å¯ä»¥å¾—åˆ°çš„ï¼Œå¹¶æŸ¥æ‰¾ä¸€ä¸ªç‰¹å®šçš„åŒ…å¹¶å®‰è£…å®ƒã€‚ æ¿€æ´»ä¸€ä¸ªç¯å¢ƒ æ£€æŸ¥ä½ æ²¡æœ‰å®‰è£…çš„â€beautifulsoup4â€æ˜¯å¦åœ¨Anaconda repositoryä¸­å­˜åœ¨.(ä½ å¿…é¡»è”ç½‘) 1conda search beautifulsoup4 condaä¼šåˆ—å‡ºåŒ…å«é‚£ä¸ªåŒ…åçš„æ‰€æœ‰åŒ…,è¿™æ ·ä½ å°±çŸ¥é“å®ƒä»¬æ˜¯å¯ä»¥å¾—åˆ°çš„ã€‚ å®‰è£…æ­¤åŒ…åˆ°å½“å‰ç¯å¢ƒä¸­ 1conda install beautifulsoup4=4.9.1 æ£€æŸ¥æ–°å®‰è£…çš„ç¨‹åºæ˜¯å¦åœ¨è¿™ä¸ªç¯å¢ƒä¸­: 1conda list å…³äºä½¿ç”¨condaçš„æœ€é‡è¦ä¿¡æ¯çš„å•é¡µæ‘˜è¦ã€‚ conda cheat sheet PDF (1 MB) Installation æœ€å¿«çš„å®‰è£…æ–¹æ³•æ˜¯:å®‰è£…Miniconda(400MB) å®ƒæ˜¯å…è´¹çš„condaæœ€å°å®‰è£…åŒ… ä»…ä»…åŒ…å«condaï¼ŒPythonï¼Œpackages they depend onï¼Œè¿˜æœ‰ä¸€äº›éå¸¸æœ‰ç”¨çš„åŒ…(åŒ…æ‹¬pip, zlibç­‰ç­‰). éœ€è¦ä½¿ç”¨conda installå‘½ä»¤ä»Anaconda repositoryå®‰è£…é¢å¤–çš„7500+åŒ…(anacondaç›´æ¥å®‰è£…å¥½) Minicondaæ˜¯ä¸€ä¸ªPythonå‘è¡Œç‰ˆï¼Œå®ƒå¯ä»¥ä½¿å®‰è£…Pythonå˜å¾—åˆå¿«åˆå®¹æ˜“ï¼Œç”šè‡³å¯¹æ–°ç”¨æˆ·ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ noteï¼šä½ æ²¡æœ‰å¿…è¦ä¸ºäº†ä½¿ç”¨condaå»å¸è½½æ‰ä½ ç³»ç»Ÿä¸­åŸå…ˆçš„pythonå’Œç›¸åº”çš„åŒ…. æˆ‘ä»¬åªéœ€è¦æ­£å¸¸å®‰è£…miniconda,å¹¶è®©å®‰è£…ç¨‹åºå°†conda installation of Pythonæ·»åŠ åˆ°PATHç¯å¢ƒå˜é‡ä¸­.æ²¡æœ‰å¿…è¦è®¾ç½®PYTHONPATHç¯å¢ƒå˜é‡ã€‚ for windos: å®‰è£…åŒ…ä¸‹è½½åœ°å€:https://docs.conda.io/en/latest/miniconda.html#windows-installers for linux ä½¿ç”¨è„šæœ¬ 12345wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh // è·å–å®‰è£…è„šæœ¬echo \"&lt;sha-hash&gt; *filename\" | shasum -a 256 -c // æ£€æµ‹æ–‡ä»¶å®Œæ•´æ€§echo \"879457af6a0bf5b34b48c12de31d4df0ee2f06a8e68768e5758c3293b2daf688 *Miniconda3-latest-Linux-x86_64.sh\" | sha256sum -cMiniconda3-latest-Linux-x86_64.sh: OK // å®Œæ•´æ€§æ­£å¸¸bash Miniconda3-latest-Linux-x86_64.sh // å®‰è£…è„šæœ¬ ä½¿ç”¨åŒ…ç®¡ç†å™¨(aptæˆ–è€…npm) Managing channels Conda channels are the locations where packages are stored. They serve as the base for hosting and managing packages. Conda packages are downloaded from remote channels, which are URLs to directories containing conda packages. The conda command searches a default set of channels and packages are automatically downloaded and updated from https://repo.anaconda.com/pkgs/ Condaé€šé“æ˜¯å­˜æ”¾åŒ…çš„ä½ç½®ï¼›ä¸åŒçš„é€šé“å¯ä»¥æœ‰ç›¸åŒçš„åŒ…ï¼Œæ‰€ä»¥condaå¿…é¡»å¤„ç†è¿™äº›é€šé“å†²çªã€‚ Condaåˆ—å‡ºä»æ‰€æœ‰é€šé“æ”¶é›†åˆ°çš„å…·æœ‰ç›¸åŒåç§°çš„åŒ…ï¼Œå¹¶æŒ‰ç…§å¦‚ä¸‹æ–¹å¼å¤„ç†å®ƒä»¬: æŒ‰é€šé“ä¼˜å…ˆçº§æ’åº å†æŒ‰ç‰ˆæœ¬å·æ’åº; å†æŒ‰æ„å»ºå·æ’åºï¼› å®‰è£…æ’åºåˆ—è¡¨ä¸­æ»¡è¶³å®‰è£…è§„èŒƒçš„ç¬¬ä¸€ä¸ªåŒ…ã€‚ channelA::numpy-1.13_1 &gt; channelA::numpy-1.12.1_1 &gt; channelA::numpy-1.12.1_0 &gt; channelB::numpy-1.13_1(å¦‚æœæ‰“å¼€äº†ä¸¥æ ¼é€šé“æ’åºï¼Œé‚£ä¹ˆchannelBçš„åŒ…å°±ä¸ä¼šåœ¨æ­¤åˆ—è¡¨ä¸­) 1234conda config --prepend/add channels new_channel // ä¼˜å…ˆçº§æœ€é«˜conda config --append channels new_channel // ä¼˜å…ˆçº§æœ«å°¾conda config --set channel_priority false // ä¼˜å…ˆçº§å…³é—­,é‚£ä¹ˆæ¯æ¬¡å®‰è£…æœ€æ–°ç‰ˆæœ¬æˆ–è€…æŠŠ`channel_priority: false`æ·»åŠ åˆ°`.condarc`æ–‡ä»¶ä¸­ æ·»åŠ æ¸…åçš„channel(å°†ä¸‹é¢ä»£ç å¤åˆ¶åˆ°.condarcæ–‡ä»¶ä¸­): 1234567891011121314151617channels: - defaultsshow_channel_urls: truechannel_alias: https://mirrors.tuna.tsinghua.edu.cn/anaconda default_channels: - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/r - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/pro - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/msys2custom_channels: conda-forge: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud msys2: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud bioconda: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud menpo: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud pytorch: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud simpleitk: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud é»˜è®¤channel_aliasä¸º:https://repo.anaconda.com/pkgs/ é€šå¸¸,default_channelsæŒ‡å‘repo.anaconda.comå­˜å‚¨åº“ä¸­çš„å‡ ä¸ªé€šé“ï¼Œä½†æ˜¯å¦‚æœå®šä¹‰äº†default_channelsï¼Œå®ƒå°†è®¾ç½®é»˜è®¤é€šé“çš„æ–°åˆ—è¡¨ã€‚è¿™å¯¹airgappedå’Œä¼ä¸šå®‰è£…éå¸¸æœ‰ç”¨ã€‚ ä¸ºäº†ç¡®ä¿æ‰€æœ‰çš„ç”¨æˆ·ä»å†…éƒ¨éƒ¨ç½²çš„ä»“åº“æ‹‰å–åŒ…ï¼Œç®¡ç†å‘˜å¯ä»¥è®¾ç½®ğŸ‘†ä¸¤ä¸ªå‚æ•°ã€‚ channel_alias: åœ¨ä»¥åä½ æŒ‡å®šchannelä¸æ˜¯urlæ—¶,ä¼šåŠ ä¸Šè¿™ä¸ªå‰ç¼€ å¦‚æœè¦ä¸‹è½½çš„åŒ…æ¸…åæºæ²¡æœ‰ï¼Œåœ¨anocondaçš„å­˜å‚¨åº“ä¸­ï¼Œå¯ä»¥åœ¨custom_channelåŠ ä¸Šç›¸åº”çš„é€šé“ 1234567 peterjc123: https://conda.anaconda.org // ç®€å†™ä¸º conda install -c peterjc123 vc vs2017_runtime // å¦åˆ™è¦å†™å…¨ conda install --channel https://conda.anaconda.org/peterjc123 vc vs2017_runtime // ä¹Ÿå¯ä»¥å†™æˆconda install -c defaults https://conda.anaconda.org/peterjc123 vc vs2017_runtime","categories":[{"name":"Software","slug":"Software","permalink":"https://www.beenli.cn/categories/Software/"},{"name":"jupyter","slug":"Software/jupyter","permalink":"https://www.beenli.cn/categories/Software/jupyter/"}],"tags":[{"name":"python","slug":"python","permalink":"https://www.beenli.cn/tags/python/"},{"name":"toolkits","slug":"toolkits","permalink":"https://www.beenli.cn/tags/toolkits/"}]},{"title":"AMBA AHB spec(2)--bus interface","slug":"AMBA-AHB-spec-2-bus-interface","date":"2020-10-09T11:16:03.000Z","updated":"2020-10-09T11:28:44.625Z","comments":true,"path":"posts/d1f5324a/","link":"","permalink":"https://www.beenli.cn/posts/d1f5324a/","excerpt":"","text":"The blog is derived from the translation of ARM IHI 0011A AHB specification Copyright Â© 1999 ARM Limited æ–‡æ¡£é“¾æ¥ï¼šhttps://pan.baidu.com/s/19fG2h8Jw4k29AjWfRBliFw æå–ç ï¼šmmme 0 Convention0.1 timing parameters generic timing parameters that are required to analyze an AMBA design â€¢ Tis - input setup time â€¢ Tih - input hold time â€¢ Tov - output valid time â€¢ Toh - output hold time. 0.2 timing diagrams Notesï¼š æ€»çº¿å’Œä¿¡å·ä¸­çš„é˜´å½±åŒºåŸŸæ˜¯æœªå®šä¹‰çš„ï¼Œæ‰€ä»¥å¯ä»¥å‡å®šä»–ä»¬åœ¨è¿™ä¸ªåŒºåŸŸçš„å€¼æ˜¯ä»»æ„çš„ã€‚å®ƒä»¬å®é™…çš„å€¼ä¸é‡è¦ï¼Œä¸å½±å“æ­£å¸¸çš„æ“ä½œã€‚ å•æ¯”ç‰¹ä¿¡å·æœ‰æ—¶åœ¨åŒä¸€æ—¶åˆ»è¢«æ˜¾ç¤ºä¸ºHIGHå’ŒLOWï¼Œå®ƒä»¬å’Œæ€»çº¿å˜åŒ–(ğŸ‘†Bus change)ç›¸ä¼¼ã€‚å¦‚æœå•æ¯”ç‰¹ä¿¡å·åƒè¿™æ ·æ˜¾ç¤ºï¼Œæ„å‘³ç€å®ƒçš„å€¼ä¸å½±å“é™„å¸¦çš„æè¿°(accompanying description) 1 Slave slaveå¯¹ç³»ç»Ÿå†…masterå‘èµ·çš„ä¼ è¾“åšå‡ºå“åº”ã€‚slaveä½¿ç”¨è§£ç å™¨ä¼ æ¥çš„HSELxä¿¡å·æ¥å†³å®šåˆé€‚å¯¹ä¼ è¾“åšå‡ºå“åº”ã€‚æ‰€æœ‰å…¶å®ƒè¢«ä¼ è¾“éœ€è¦çš„ä¿¡å·ï¼Œä¾‹å¦‚åœ°å€å’Œæ§åˆ¶ä¿¡å·ï¼Œéƒ½æœ‰masteräº§ç”Ÿã€‚ 17.1 Interface diagram 17.2 Timing diagrams17.2.1 Reset Tihrstï¼šresetè¾“å…¥ä¿¡å·ä¿æŒæ—¶é—´[åœ¨æ—¶é’Ÿè¾¹æ²¿åè¿˜å¾—ä¿æŒä¸€æ®µæ—¶é—´ä¿è¯è¢«é‡‡æ ·åˆ°] (ih=input hold time; rst=HRESETn) Tisrstï¼šresetè¾“å…¥ä¿¡å·å»ºç«‹æ—¶é—´[åœ¨æ—¶é’Ÿè¾¹æ²¿ä¹‹å‰ç»´æŒvalidä¸€æ®µå¿…è¦çš„æ—¶é—´ï¼Œè®©ä¸»è§¦å‘å™¨èƒ½å¤Ÿé‡‡æ ·åˆ°âœ”çš„å€¼] 17.2.2 Normal signals Tovrdyï¼šè¾“å‡ºä¿¡å·HREADYçš„æœ‰æ•ˆæ—¶é—´ 17.2.3 Additional signals 2 Master åœ¨AMBAç³»ç»Ÿä¸­ï¼Œmasteræœ‰æœ€å¤æ‚çš„æ€»çº¿æ¥å£ã€‚é€šå¸¸æ¥è¯´ï¼Œä¸€ä¸ªAMBAç³»ç»Ÿè®¾è®¡è€…ä¼šä½¿ç”¨é¢„å…ˆè®¾è®¡å¥½çš„master(å¯èƒ½æ˜¯å¤„ç†å™¨æ ¸ï¼Œåå¤„ç†å™¨ç­‰)ï¼Œå› æ­¤æ²¡å¿…è¦æ‹…å¿ƒmasteræ¥å£çš„ç»†èŠ‚ã€‚ 2.1 Interface diagram 3 Arbiter åœ¨AMBAç³»ç»Ÿä¸­ä»²è£å™¨çš„è§’è‰²ï¼šæ§åˆ¶å“ªä¸ªmasteræœ‰æƒè®¿é—®æ€»çº¿ã€‚æ¯ä¸ªmasteræœ‰ä¸€ä¸ªé€šå‘ä»²è£å™¨çš„REQUESET/GRANTæ¥å£ï¼Œä»²è£å™¨ä½¿ç”¨ä¸€ä¸ªä¼˜å…ˆçº§ç­–ç•¥å†³å®šå½“å‰è¯·æ±‚æ€»çº¿çš„æ‰€æœ‰masterä¸­å“ªä¸ªä¼˜å…ˆçº§æœ€é«˜ã€‚ æ¯ä¸ªmasterä¹Ÿä¼šäº§ç”Ÿä¸€ä¸ªHLOCKxä¿¡å·ï¼Œç”¨æ¥å‘masteræŒ‡ç¤ºæˆ‘éœ€è¦å¯¹æ€»çº¿ç‹¬å è®¿é—®ã€‚(exclusive access to the bus) ä¼˜å…ˆçº§åˆ«ç­–ç•¥çš„ç»†èŠ‚æ²¡æœ‰è§„å®šï¼Œè€Œæ˜¯æ¯ä¸ªåº”ç”¨è‡ªå·±å†³å®šã€‚å¯¹äºä»²è£å™¨ä½¿ç”¨å…¶å®ƒçš„ä¿¡å·(ä¾‹å¦‚AMBAæˆ–non-AMBA)å»å½±å“æ­£åœ¨ä½¿ç”¨çš„ä¼˜å…ˆçº§ç­–ç•¥æ˜¯å¯ä»¥æ¥å—çš„ã€‚ 3.1 Interface diagram 4 Decoder AMBAç³»ç»Ÿä¸­çš„decoderç”¨äºå®Œæˆä¸€ä¸ªä¸­å¿ƒåŒ–åœ°å€è¯‘ç çš„åŠŸèƒ½ï¼Œé€šè¿‡ä½¿å®ƒä»¬ç‹¬ç«‹äºç³»ç»Ÿå†…å­˜æ˜ å°„(system memory map)æ¥æé«˜å¤–è®¾å¯ç§»æ¤æ€§ã€‚","categories":[{"name":"RISC-V","slug":"RISC-V","permalink":"https://www.beenli.cn/categories/RISC-V/"},{"name":"spec","slug":"RISC-V/spec","permalink":"https://www.beenli.cn/categories/RISC-V/spec/"}],"tags":[{"name":"specification","slug":"specification","permalink":"https://www.beenli.cn/tags/specification/"}]},{"title":"AMBA AHB spec(1)--bus scheme","slug":"AMBA-AHB-spec-1-bus-scheme","date":"2020-10-09T10:25:09.000Z","updated":"2020-10-09T11:28:41.027Z","comments":true,"path":"posts/d26415ba/","link":"","permalink":"https://www.beenli.cn/posts/d26415ba/","excerpt":"","text":"The blog is derived from the translation of ARM IHI 0011A AHB specification Copyright Â© 1999 ARM Limited æ–‡æ¡£é“¾æ¥ï¼šhttps://pan.baidu.com/s/19fG2h8Jw4k29AjWfRBliFw æå–ç ï¼šmmme 0 Overall framwork 1 Bus interconnection AHBæ€»çº¿åè®®è¢«è®¾è®¡æˆå¸¦æœ‰ä¸€ä¸ªä¸­å¿ƒé€‰æ‹©å™¨(central multiplexor)çš„äº’è¿æ–¹æ¡ˆã€‚ ä¸»è®¾å¤‡é©±åŠ¨åœ°å€å’Œæ§åˆ¶ä¿¡å·ï¼Œä¿¡å·æŒ‡ç¤ºå®ƒä»¬æƒ³è¦æ‰§è¡Œçš„ä¼ è¾“ã€‚ å¹¶ä¸”ä»²è£å™¨å†³å®šå“ªä¸ªä¸»è®¾å¤‡èƒ½å¤ŸæŠŠä»–ä»¬çš„ä¿¡å·è·¯ç”±ç»™æ‰€æœ‰çš„ä»è®¾å¤‡ï¼› è¿˜éœ€è¦ä¸€ä¸ªä¸­å¿ƒè¯‘ç å™¨æ§åˆ¶è¯»æ•°æ®(read data)å’Œå›åº”ä¿¡å·(response signal)å¤šé€‰å™¨ï¼Œå®ƒä»æ¶‰åŠè¿™æ¬¡ä¼ è¾“çš„ä»è®¾å¤‡ä¸­é€‰æ‹©åˆé€‚çš„ä¿¡å·ã€‚ 2 Overview of operation åœ¨ä¸€æ¬¡ä¼ è¾“å¼€å§‹(commence)ä¹‹å‰ï¼Œmasterå¿…é¡»è¢«æˆäºˆè®¿é—®æ€»çº¿(granted access to the bus)ã€‚è¿™ä¸ªè¿‡ç¨‹ç”±masterå‘ä»²è£å™¨å‘èµ·ä¸€ä¸ªè¯·æ±‚ä¿¡å·å¼€å§‹(assert a request signal)ã€‚ç„¶åä»²è£å™¨æŒ‡ç¤ºä½•æ—¶å°†æˆäºˆmasteræ€»çº¿ä½¿ç”¨æƒã€‚ å¾—åˆ°æˆäºˆçš„masteré€šè¿‡é©±åŠ¨åœ°å€å’Œæ§åˆ¶ä¿¡å·å¼€å§‹ä¸€æ¬¡AHB transferã€‚è¿™äº›ä¿¡å·æä¾›äº†å…³äºåœ°å€ï¼Œæ–¹å‘ï¼Œä¼ è¾“å®½åº¦å’Œè¿™æ¬¡ä¼ è¾“æ˜¯å¦æ˜¯burstçš„ä¸€éƒ¨åˆ†çš„æŒ‡ç¤ºä¿¡å·(indiction)ã€‚ä¸¤ç§ä¸åŒå½¢å¼çš„burst transferéƒ½è¢«å…è®¸ï¼š é€’å¢çš„çªå‘(incrementing burst)ï¼Œå®ƒä¸åŒ…è£…åœ¨åœ°å€è¾¹ç•Œ åŒ…è£…çš„çªå‘(wrapping burst)ï¼ŒåŒ…è£¹åœ¨ç‰¹æ®Šçš„åœ°å€è¾¹ç•Œ å†™æ•°æ®æ€»çº¿æŠŠæ•°æ®ä»masteræ¬è¿åˆ°slaveï¼›ä½†è¯»æ•°æ®æ€»çº¿æŠŠæ•°æ®ä»Slaveæ¬è¿åˆ°masterã€‚ æ¯æ¬¡ä¼ è¾“éƒ½åŒ…æ‹¬å¦‚ä¸‹ä¸¤ä¸ªéƒ¨åˆ†ï¼š ä¸€ä¸ªåœ°å€å’Œæ§åˆ¶å‘¨æœŸ(an address and control cycle) ä¸€ä¸ªæˆ–å¤šä¸ªæ•°æ®å‘¨æœŸ(one or more cycle for the data) ç”±äºåœ°å€ä¸èƒ½è¢«æ‰©å±•(extended)ï¼Œæ‰€æœ‰æ‰€æœ‰çš„ä»è®¾å¤‡å¿…é¡»åœ¨æ­¤æœŸé—´å–æ ·åœ°å€ã€‚ä½†æ˜¯æ•°æ®å¯ä»¥ç”¨HREADYä¿¡å·æ‰©å±•ã€‚å½“è¯¥ä¿¡å·ä¸ºä½æ—¶å¯¼è‡´ç­‰å¾…çŠ¶æ€(wait states)è¢«å¡è¿›è¿™æ¬¡ä¼ è¾“é‡Œé¢ï¼›å› æ­¤å…è®¸slaveæœ‰é¢å¤–çš„æ—¶é—´å–æä¾›æˆ–è€…é‡‡æ ·æ•°æ®ã€‚ åœ¨ä¼ è¾“ä¸­ï¼Œslaveé€šè¿‡response signalä¼ è¾¾çŠ¶æ€ä¿¡æ¯ï¼ŒHRESP[1:0]ï¼š OkAYï¼šæŒ‡ç¤ºä¼ è¾“è¿›å±•æ­£å¸¸ï¼Œå½“HREADYå˜é«˜æ—¶ï¼Œè¯¥ä¿¡å·æŒ‡ç¤ºä¼ è¾“æˆåŠŸå®Œæˆ(complete successfully) ERRORï¼šæŒ‡ç¤ºä¼ è¾“âŒå‘ç”Ÿï¼Œä¼ è¾“å¤±è´¥ RETRY and SPLITï¼šä¸¤è€…éƒ½è¡¨ç¤ºä¼ è¾“ä¸èƒ½ç«‹åˆ»å®Œæˆï¼Œä½†æ˜¯masteråº”è¯¥ç»§ç»­å°è¯•ä¼ è¾“ã€‚ notes:åœ¨æ­£å¸¸æ“ä½œä¸­ï¼Œå…è®¸masteråœ¨ä»²è£å™¨æˆäºˆå…¶å®ƒmasterè®¿é—®æ€»çº¿å‰å®Œæˆä¸€æ¬¡burstçš„æ‰€æœ‰ä¼ è¾“ã€‚ä½†æ˜¯ï¼Œä¸ºäº†é¿å…è¿‡å¤šçš„(excessive)ä»²è£å»¶è¿Ÿï¼Œæœ‰å¯èƒ½ä»²è£å™¨ä¼šæ‰“æ–­ä¸€æ¬¡burstï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œmasterå¿…é¡»é‡æ–°å‘ä»²è£å™¨ç”³è¯·æ€»çº¿ä»¥å®Œæˆburstä¸­å‰©ä½™çš„ä¼ è¾“ã€‚ 3 Basic transfer3.1 simple without wait ä¸€æ¬¡AHBä¼ è¾“åŒ…å«ä¸¤ä¸ªä¸åŒçš„éƒ¨åˆ†(two distinct sections)ï¼š The address phase, which lasts only a single cycle The data phase, which may require several cycles. This is achieved using the HREADY signal. ğŸ‘†æ²¡æœ‰ç­‰å¾…çŠ¶æ€çš„ç®€å•ä¼ è¾“ masteråœ¨HCLKä¸Šå‡æ²¿æŠŠåœ°å€å’Œæ§åˆ¶ä¿¡å·é©±åŠ¨åˆ°busä¸Š slaveåœ¨ä¸‹ä¸€ä¸ªä¸Šå‡æ²¿é‡‡æ ·åœ°å€å’Œæ§åˆ¶ä¿¡å· åœ¨slaveé‡‡æ ·å®Œæˆä¹‹åï¼Œå®ƒå¼€å§‹é©±åŠ¨åˆé€‚çš„å›åº”ä¿¡å·ï¼Œç„¶åresponseè¢«masteråœ¨ä¸‰ä¸ªä¸Šå‡æ²¿é‡‡æ ·ã€‚ notes: äº‹å®ä¸Šï¼Œä»»ä½•ä¼ è¾“çš„åœ°å€ç›¸ä¸å‰ä¸€ä¸ªä¼ è¾“çš„æ•°æ®ç›¸å‘ç”Ÿåœ¨åŒä¸€æ—¶æœŸã€‚æ­£æ˜¯å› ä¸ºè¿™ç§é‡å ï¼Œå®ƒä»¬æ„æˆäº†æ€»çº¿æµæ°´ç‰¹æ€§ï¼Œä¸ºé«˜æ€§èƒ½æ“ä½œæä¾›å¥‘æœºï¼ŒåŒæ—¶ä¸ºslaveå¯¹æ¥æ”¶çš„æ•°æ®åšå‡ºååº”æä¾›äº†è¶³å¤Ÿçš„æ—¶é—´ã€‚ 3.2 simple with wait notes: â… ã€å¯¹äºå†™æ“ä½œï¼Œmasteréœ€è¦åœ¨æ‰©å±•å‘¨æœŸä¸€ç›´ä¿æŒç¨³å®šçš„æ•°æ®ï¼›â…¡ã€å¯¹äºè¯»æ“ä½œï¼Œslaveä¸éœ€è¦ä¸€ç›´æä¾›æœ‰æ•ˆæ•°æ®ï¼Œç›´åˆ°ä¼ è¾“å°†è¦å®Œæˆã€‚ 3.3 multiple transfersæ‰©å±•å¯¹ä¸‹æ¬¡ä¼ è¾“çš„åœ°å€ç›¸çš„side-effect åœ°å€Aå’Œåœ°å€Cçš„ä¼ è¾“æ²¡æœ‰ç­‰å¾…çŠ¶æ€ åœ°å€Bçš„ä¼ è¾“æœ‰ä¸€ä¸ªç­‰å¾…çŠ¶æ€ åœ°å€Bä¼ è¾“ä¸­çš„æ•°æ®phaseæ‰©å±•å¯¹åœ°å€Cä¼ è¾“çš„åœ°å€phaseæ‰©å±•æœ‰å½±å“ã€‚ 4 Transfer type æ¯ä¸€ç§ä¼ è¾“éƒ½å¯ä»¥è¢«å½’ç±»ä¸ºä»¥ä¸‹å››ç§ä¸­çš„ä¸€ç§ï¼Œç”¨HTRANS[1:0]ä¿¡å·æŒ‡ç¤º HTRANS[1:0] Type Description 00 IDLE â‘ æ²¡æœ‰æ•°æ®ä¼ è¾“è¯·æ±‚ã€‚IDLEç”¨åœ¨masterè·å¾—æˆæƒï¼Œä½†ä¸æƒ³å¼€å§‹æ•°æ®ä¼ è¾“æ—¶ã€‚â‘¡slaveå¿…é¡»æ€»æ˜¯å¯¹è¿™ç§ä¼ è¾“æä¾›ä¸€ä¸ªæ²¡æœ‰ç­‰å¾…çŠ¶æ€çš„OKAYå“åº”ï¼Œå¹¶ä¸”è¯¥ä¼ è¾“åº”è¯¥è¢«slaveå¿½ç•¥æ‰ 01 BUSY â‘ è¯¥çŠ¶æ€å…è®¸masteråœ¨burstä¸­é—´æ’å…¥IDLEå‘¨æœŸï¼›è¯¥çŠ¶æ€è¡¨æ˜masteræ­£åœ¨ç»§ç»­ä¸€æ¬¡burstï¼›ä½†æ˜¯ä¸‹ä¸€ä¸ªä¼ è¾“ä¸èƒ½ç«‹å³å‘ç”Ÿã€‚â­å½“masterä½¿ç”¨è¯¥ç±»å‹æ—¶ï¼Œåœ°å€å’Œæ§åˆ¶ä¿¡å·ä¸€å®šååº”(reflect)burstçš„ä¸‹ä¸€æ¬¡ä¼ è¾“ã€‚â‘¡ä¼ è¾“åº”è¯¥è¢«slaveå¿½è§†ï¼Œslaveä¸€å®šæ€»æ˜¯æä¾›é›¶ç­‰å¾…çŠ¶æ€çš„OKAYå›åº”ï¼Œè·ŸIDLEåŒæ ·çš„æ–¹å¼ 10 NONSEQ â‘ æŒ‡ç¤ºburstçš„ç¬¬ä¸€æ¬¡ä¼ è¾“æˆ–è€…ä¸€ä¸ªå•æ¬¡ä¼ è¾“ï¼›åœ°å€å’Œæ§åˆ¶ä¿¡å·ä¸ä¸Šæ¬¡ä¼ è¾“æ²¡æœ‰å…³ç³»ã€‚â‘¡æ€»çº¿ä¸Šå•ä¸€ä¼ è¾“(single transfer)ä¸burstä¼ è¾“ä¸­çš„ç¬¬ä¸€ä¸ªä¼ è¾“åŒæ ·å¯¹å¾…ï¼Œå› æ­¤ä¼ è¾“ç±»å‹ä¸ºNONSEQUENTIAL 11 SEQ â‘ busrtä¸­é™¤äº†ç¬¬ä¸€æ¬¡ä¼ è¾“å‰©ä½™çš„æ‰€æœ‰ä¼ è¾“éƒ½æ˜¯SEQENTIAL;å¹¶ä¸”åœ°å€ä¸ä¸Šæ¬¡ä¼ è¾“æœ‰å…³ã€‚æ§åˆ¶ä¿¡æ¯ä¸ä¸Šæ¬¡ä¼ è¾“ç›¸åŒï¼Œåœ°å€ä¿¡æ¯=ä¸Šæ¬¡åœ°å€ä¿¡æ¯+æ•°æ®å¤§å°(in byte)ã€‚â‘¡åœ¨wrappingä¸­ï¼Œåœ°å€åŒ…è£¹åœ¨åœ°å€è¾¹ç•Œ(warps at the address boundry)ï¼Œåœ°å€è¾¹ç•Œ=beatsçš„æ•°é‡(4,8æˆ–è€…16)*æ•°æ®å¤§å°(in byte) 5 Burst operation 4ï¼Œ8ï¼Œ16èŠ‚æ‹çš„burstsåœ¨AHBåè®®ä¸­æœ‰å®šä¹‰ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜æœ‰æ²¡æœ‰å®šä¹‰é•¿åº¦çš„burstså’Œå•ä¸ªçš„ä¼ è¾“ï¼›é€’å¢å’ŒåŒ…è£¹çš„é˜µå‘ä¼ è¾“éƒ½è¢«æ”¯æŒï¼š é€’å¢çš„é˜µå‘è®¿é—®é¡ºåºçš„ä½ç½®ï¼Œçªå‘ä¸­çš„æ¯ä¸ªä¼ è¾“çš„åœ°å€åªæ˜¯å…ˆå‰åœ°å€çš„ä¸€ä¸ªå¢é‡ã€‚ å¯¹äºå°è£…é˜µå‘ï¼Œå¦‚æœä¼ è¾“çš„èµ·å§‹åœ°å€æ²¡æœ‰å¯¹é½é˜µå‘çš„æ€»å­—èŠ‚æ•°(size * beats)ï¼Œé‚£ä¹ˆä¼ è¾“åœ°å€å°†åŒ…è£¹å½“è¾¾åˆ°è¾¹ç•Œæ—¶(trap when the boundary is reached)ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ª4-beatçš„åŒ…è£¹é˜µå‘ä»¥å­—(4-byte)è®¿é—®å°†å°è£…åœ¨16-byteçš„è¾¹ç•Œã€‚å› æ­¤å¦‚æœä¼ è¾“çš„èµ·å§‹åœ°å€ä¸ºOx34ï¼Œé‚£ä¹ˆå®ƒç”±å››æ¬¡ä¼ è¾“ç»„æˆï¼Œæ¯æ¬¡åœ°å€ä¸ºOx34, Ox38, Ox3C, Ox30 Table 4-1 Burst signal encoding HBURS[2:0] Type Description 000 SINGLE Single transfer 001 INCR æ²¡æœ‰æŒ‡å®šé•¿åº¦çš„é€’å¢é˜µå‘ 010 WRAP4 4-beat wrapping burst 011 INCR4 4-beat incrementing burst 100 WRAP8 8-beat wrapping burst 101 INCR8 8-beat incrementing burst 110 WRAP16 16-beat wrapping burst 111 INCR16 16-beat incrementing burst é˜µå‘ä¸èƒ½è·¨è¶Š1KBçš„åœ°å€è¾¹ç•Œ(å³A[9:0]=0)ã€‚å› æ­¤å¯¹äºmasterä¸è¦å°è¯•å¼€å§‹ä¸€ä¸ªå›ºå®šé•¿åº¦é€’å¢é˜µå‘ï¼Œè®©è¿™ä¸ªç•Œé™è¢«è·¨è¶Šã€‚ ä½¿ç”¨æ²¡æœ‰æŒ‡å®šé•¿åº¦çš„é˜µå‘ï¼Œå¹¶ä¸”åªæœ‰ä¸€ä¸ªé•¿åº¦ä¸º1çš„é˜µæ³•æ¥ä»£æ›¿single transfersã€‚ ä¸€ä¸ªé€’å¢é˜µå‘å¯ä»¥æ˜¯ä»»ä½•é•¿åº¦,ä½†æ˜¯ä¸Šé™è¢«1KBè®¾å®š notes: â‘ é˜µå‘çš„å¤§å°æ˜¯æ¯ä¸ªé˜µå‘èŠ‚æ‹çš„æ•°é‡ï¼Œä¸æ˜¯ä¼ é€çš„å­—èŠ‚æ•°ã€‚ä¸€ä¸ªburstä¼ é€çš„æ€»çš„æ•°æ®é‡=èŠ‚æ‹æ•°*æ¯ä¸ªèŠ‚æ‹æ•°æ®é‡(HSIZE[2:0])â‘¡ï¼šåœ¨ä¸€æ¬¡burstä¸­çš„æ‰€æœ‰ä¼ è¾“å¿…é¡»å¯¹é½åœ°å€è¾¹ç•Œï¼Œï¼ˆè¾¹ç•Œç­‰äºä¼ è¾“çš„å¤§å°)ï¼›ä¾‹å¦‚ï¼Œå­—ä¼ è¾“å¿…é¡»å¯¹é½å­—åœ°å€è¾¹ç•Œ(A[1:0]=00å­—åœ°å€çš„åœ°ä¸¤ä½ä¸º0ï¼›å³è¡¨ç¤ºåœ°å€æ˜¯4çš„å€æ•°)ï¼ŒåŠå­—ä¼ è¾“å¿…é¡»å¯¹é½åŠå­—åœ°å€è¾¹ç•Œ( A[0] = 0(åœ°å€çš„æœ€åä¸€ä½ä¸º0;å³è¡¨ç¤ºåœ°å€æ˜¯2çš„å€æ•°))ã€‚ 5.1 early termination æœ‰å¾ˆå¤šæƒ…å½¢ï¼Œé˜µå‘ä¸èƒ½å®Œæˆï¼›å› æ­¤å¯¹äºslaveçš„è®¾è®¡ä¸­ï¼Œå……åˆ†åˆ©ç”¨é˜µå‘ä¿¡æ¯åœ¨é˜µå‘æå‰ç»ˆæ­¢æ—¶é‡‡å–æ­£ç¡®çš„è¡ŒåŠ¨å¾ˆé‡è¦ã€‚slaveå¯ä»¥é€šè¿‡ç›‘è§†HTRANSä¿¡å·ç¡®å®šé˜µå‘ä½•æ—¶æå‰ç»ˆæ­¢ï¼Œç¡®ä¿é˜µå‘å¼€å§‹åçš„æ¯ä¸€ä¸ªä¼ è¾“éƒ½è¢«è´´ä¸ŠSEQUENTIALæˆ–è€…BUSYæ ‡ç­¾ã€‚å¦‚æœå¸¦æœ‰NONSEQUENTIALæˆ–è€…IDLEçš„ä¼ è¾“å‡ºç°ï¼Œé‚£è¡¨æ˜æ–°çš„é˜µå‘å¼€å§‹å¹¶ä¸”ä¹‹å‰çš„é˜µå‘ä¸€å®šè¢«ç»ˆæ­¢äº†ã€‚ å¦‚æœmasterä¸èƒ½å®Œæˆä¸€ä¸ªé˜µå‘ï¼Œå› ä¸ºå®ƒå¤±å»äº†æ€»çº¿æ‹¥æœ‰æƒï¼Œé‚£ä¹ˆå®ƒå¿…é¡»åœ¨å®ƒä¸‹æ¬¡è·å¾—æƒé™æ—¶åˆé€‚åœ°é‡æ–°å»ºç«‹é˜µå‘ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªmasterä»…ä»…å®Œæˆäº†4-beaté˜µå‘ä¸­çš„ä¸€ä¸ªbeatï¼Œé‚£ä¹ˆå®ƒä¸‹æ¬¡å¿…é¡»ä½¿ç”¨undefined-lengthé˜µå‘æ¥å®Œæˆå‰©ä½™çš„ä¸‰ä¸ªé˜µå‘ã€‚ 5.2 4-beat notes: å› ä¸ºæ˜¯ä¼ é€å¤§å°4-byteçš„4-beaté˜µå‘ï¼›â‘ for warpingï¼šåœ°å€è¦å°è£…åœ¨16-byteçš„è¾¹ç•Œå†…ï¼›å› æ­¤åœ°å€ä¸ºOx3Cçš„ä¼ è¾“åç´§è·Ÿçš„æ˜¯åœ°å€ä¸ºOx30çš„ä¼ è¾“ã€‚â‘¡ï¼šfor increment: å®ƒå¯ä»¥è·¨è¶Š16-byteè¾¹ç•Œã€‚ 5.3 8-beat å¯ä»¥çœ‹åˆ°åœ°å€è¾¹ç•Œä¸ºï¼š8*4=32ï¼›é‚£ä¹ˆæ•´ä¸ªåœ°å€ç©ºé—´è¢«åˆ†å‰²æˆå¾ˆå¤šåŒ…å«32ä¸ªå­—èŠ‚çš„å—ï¼›00-1F; 20-3F; 40-5Fâ€¦.ï¼›ç”±äºèµ·å§‹åœ°å€ä¸ºOX34â€”â€”&gt;è¢«å°è£…åœ¨Ox20-3Fè¿™å—é‡Œé¢ï¼› 5.4 xx-beatUndefined-length bursts ä¸¤ä¸ªåŠå­—ä¼ è¾“ä»åœ°å€Ox20å¼€å§‹ï¼Œåœ°å€æ¯æ¬¡å¢åŠ 2 ä¸‰ä¸ªå­—ä¼ è¾“ä»åœ°å€Ox5Cå¼€å§‹ï¼Œåœ°å€ä¼ è¾“å¢åŠ 4 6 Control signals å’Œä¼ è¾“ç±»å‹å’Œé˜µå‘ç±»å‹ä¸€æ ·ï¼Œæ¯æ¬¡ä¼ è¾“éƒ½æœ‰è®¸å¤šæ§åˆ¶ä¿¡å·ï¼Œè¿™äº›ä¿¡å·æä¾›äº†ä¼ è¾“çš„é¢å¤–ä¿¡æ¯ã€‚è¿™äº›æ§åˆ¶ä¿¡å·æœ‰ç€å’Œåœ°å€æ€»çº¿å®Œå…¨ç›¸åŒçš„æ—¶åºã€‚ä½†æ˜¯ï¼Œå®ƒä»¬å¿…é¡»åœ¨æ•´ä¸ªé˜µå‘æœŸé—´ä¿æŒæ’å®š.(remain constant) 6.1 Transfer direction å½“HWRITEä¸ºé«˜ï¼Œä¿¡å·æŒ‡ç¤ºä¸€ä¸ªå†™ä¼ é€ï¼Œå¹¶ä¸”masteråœ¨å†™æ•°æ®æ€»çº¿ä¸Šå¹¿æ’­æ•°æ®(HWDATA[31:0])ã€‚å½“å…¶ä¸ºä½æ—¶ï¼Œä¸€ä¸ªè¯»ä¼ é€å°†æ‰§è¡Œï¼Œslaveå¿…é¡»åœ¨è¯»æ•°æ®æ€»çº¿ä¸Šç”Ÿæˆæ•°æ®(HRDATA[31:0])ã€‚ 6.2 Transfer sizeHsize[2:0]æŒ‡ç¤ºä¼ é€çš„å¤§å°ã€‚ è¿™ä¸ªå¤§å°(transfer size)ç”¨äºå’ŒHBURST[2:0]ä¿¡å·è”ç»“èµ·æ¥å†³å®šwrapping burstsçš„åœ°å€è¾¹ç•Œ 6.3 Protection control æ§åˆ¶ä¿æŠ¤ä¿¡å·HPROT[3:0]ï¼Œæä¾›äº†å…³äºæ€»çº¿è®¿é—®çš„é¢å¤–ä¿¡æ¯ï¼Œä¸»è¦æ˜¯ä¸ºäº†æƒ³è¦å®ç°æŸç§ä¿æŠ¤çš„æ¨¡å—ä½¿ç”¨ã€‚ è¿™ä¸ªä¿¡å·æŒ‡ç¤ºè¿™æ¬¡ä¼ è¾“ä¸ºï¼š å–æ“ä½œç \\ æ•°æ®è®¿é—® ç‰¹æƒæ¨¡å¼è®¿é—®\\ ç”¨æˆ·æ¨¡å¼è®¿é—® å¯¹äºå¸¦æœ‰å†…å­˜ç®¡ç†å•å…ƒçš„masterï¼Œè¿™äº›ä¿¡å·è¿˜å¯ä»¥æŒ‡ç¤ºå½“å‰çš„è®¿é—®æ˜¯å¦å¯ç¼“å­˜(cacheable or bufferable) notes: å¹¶ä¸æ˜¯æ‰€æœ‰çš„masteréƒ½æœ‰èƒ½åŠ›ç”Ÿæˆæ­£ç¡®ä¿æŠ¤ä¿¡æ¯ï¼Œå› æ­¤æ¨èslaveä¸è¦ä½¿ç”¨HPROTä¿¡å·çš„ä¿¡æ¯ï¼Œé™¤éä¸¥æ ¼éœ€è¦(strictly necessary)ã€‚ 7 Address decodingâ“ ä¸­å¿ƒåŒ–çš„åœ°å€è¯‘ç å™¨(central address decoder)ä¸ºæ€»çº¿ä¸Šæ¯ä¸€ä¸ªslaveæä¾›ä¸€ä¸ªé€‰æ‹©ä¿¡å·ï¼ŒHSELxã€‚é€‰æ‹©ä¿¡å·æ˜¯é«˜é˜¶åœ°å€ä¿¡å·çš„ç»„åˆè¯‘ç ï¼Œç®€å•åœ°å€è¯‘ç æ–¹æ¡ˆé¼“åŠ±ä½¿ç”¨æ¥é¿å…å¤æ‚è¯‘ç é€»è¾‘ï¼Œå¹¶ä¸”å¯ä»¥ä¿è¯é«˜é€Ÿæ“ä½œã€‚ å½“HREADYä¿¡å·ä¸ºé«˜æ—¶(æŒ‡ç¤ºå½“å‰ä¼ è¾“å®Œæˆ)ï¼Œslaveä¸€å®šä»…é‡‡æ ·åœ°å€ï¼Œæ§åˆ¶ä¿¡å·å’ŒHSELxã€‚åœ¨ç‰¹ç‚¹æƒ…æ™¯ä¸‹ï¼ŒHSELxä¿¡å·å¯èƒ½åœ¨HREADYä¸ºä½çš„æ—¶è¢«å£°æ˜(å‘å‡º)ï¼Œä½†æ˜¯æ‰€é€‰slaveåœ¨å½“å‰ä¼ è¾“å®Œæˆæ—¶å°†ä¼šæ”¹å˜ã€‚ â“èƒ½å¤Ÿåˆ†é…ç»™å•ä¸ªslaveçš„æœ€å°åœ°å€ç©ºé—´ä¸º1kBã€‚æ‰€æœ‰çš„masteréƒ½è¢«è®¾è®¡æˆä¸å…è®¸æ‰§è¡Œè·¨è¶Š1KBè¾¹ç•Œçš„é€’å¢ä¼ è¾“(incrementing transfers)ï¼Œå› æ­¤ç¡®ä¿burstæ°¸è¿œä¸ä¼šè¶Šè¿‡åœ°å€è¯‘ç è¾¹ç•Œã€‚ åœ¨ç³»ç»Ÿè®¾è®¡ä¸åŒ…å«ä¸€ä¸ªå®Œå…¨å¡«å……çš„å†…å­˜æ˜ å°„çš„æƒ…å†µä¸‹ï¼Œä¸€ä¸ªé¢å¤–çš„é»˜è®¤slaveåº”è¢«å®ç°ï¼Œä»¥æä¾›ä¸€ä¸ªå“åº”æ—¶ï¼Œä»»ä½•ä¸å­˜åœ¨çš„åœ°å€ä½ç½®è¢«è®¿é—®ã€‚å¦‚æœNONSEQUENTIALæˆ–è€…SEQUENTIALä¼ è¾“å°è¯•ä¸€ä¸ªä¸å­˜åœ¨çš„åœ°å€ä½ç½®ï¼Œé‚£ä¹ˆé»˜è®¤çš„slaveåº”è¯¥æä¾›ä¸€ä¸ªERRORå“åº”ã€‚IDLEæˆ–è€…BUSYä¼ è¾“å°è¯•ä¸€ä¸ªä¸å­˜åœ¨çš„åœ°å€ä½ç½®æ—¶ï¼Œåº”è¯¥è¿”å›é›¶ç­‰å¾…çŠ¶æ€çš„OKAYå“åº”ã€‚é»˜è®¤slaveçš„åŠŸèƒ½é€šå¸¸ç”±decoderçš„ä¸€éƒ¨åˆ†å®Œæˆã€‚ 8 Slave response åœ¨masterå¼€å§‹ä¸€ä¸ªä¼ è¾“åï¼Œslaveéšå³åˆ¤æ–­ä¼ è¾“æ”¹æ€æ ·è¿›å±•ï¼Œåœ¨AHB specä¸­æ²¡æœ‰[å½“ä¼ è¾“å¼€å§‹åï¼Œmasterå¯ä»¥å–æ¶ˆä¼ è¾“]çš„è§„å®šã€‚ æ— è®ºslaveä½•æ—¶è¢«è®¿é—®ï¼Œå®ƒä¸€å®šæä¾›ä¸€ä¸ªresponse,æŒ‡ç¤ºä¼ è¾“çš„çŠ¶æ€ã€‚HREADYä¿¡å·ç”¨äºæ‰©å±•ä¼ è¾“ï¼Œå®ƒè¿˜å’Œå“åº”ä¿¡å·HRESP[1:0]ç»„åˆæä¾›ä¼ è¾“çŠ¶æ€ã€‚ slaveå¯ä»¥ç”¨å¤šç§æ–¹æ³•å®Œæˆä¼ è¾“ï¼š ç«‹å³å®Œæˆ æ’å…¥ä¸€ä¸ªæˆ–å¤šä¸ªç­‰å¾…çŠ¶æ€åŒ€å‡ºæ—¶é—´æ¥å®Œæˆ å‘é€ä¸€ä¸ªerrorä¿¡å·å‘ŠçŸ¥ä¼ è¾“å¤±è´¥ å»¶è¿Ÿä¼ è¾“çš„å®Œæˆï¼Œä½†æ˜¯å…è®¸masterå’Œslaveè®©å‡ºæ€»çº¿ï¼Œè…¾ç»™å…¶å®ƒä¼ è¾“ä½¿ç”¨ã€‚ 8.1 transfer done HREADYä¿¡å·ç”¨äºæ‰©å±•AHBä¼ è¾“çš„æ•°æ®éƒ¨åˆ†ã€‚å½“æ‹‰ä½è¯¥ä¿¡å·æ—¶è¡¨æ˜ä¼ è¾“è¢«æ‰©å±•ï¼Œå½“æ‹‰é«˜è¯¥ä¿¡å·è¡¨ç¤ºä¼ è¾“å®Œæˆ note: ä¸ºäº†è®¡ç®—è®¿é—®æ€»çº¿çš„å»¶è¿Ÿæ—¶é—´ï¼Œæ¯ä¸ªmasterå¿…é¡»æœ‰ä¸€ä¸ªé¢„å…ˆç¡®å®šçš„ç­‰å¾…çŠ¶æ€çš„æœ€å¤§æ•°ç›®ï¼Œå®ƒå°†åœ¨é€€å‡ºæ€»çº¿ä¹‹å‰æ’å…¥ã€‚æˆ‘ä»¬æ¨èä½†ä¸å¼ºåˆ¶ï¼šæ¯ä¸ªslaveä¸è¦æ’å…¥è¶…è¿‡16ä¸ªwait statesï¼Œä»¥é˜²ä»»ä½•å•ä¸ªè®¿é—®ğŸ”’ä½æ€»çº¿è¿‡å¤šçš„æ—¶é’Ÿå‘¨æœŸã€‚ 8.2 transfer response é€šå¸¸ï¼Œslaveä½¿ç”¨HREADYä¿¡å·æ¥æ’å…¥åˆé€‚çš„æ•°é‡çš„wait statesï¼Œå¹¶åœ¨ä¼ è¾“å®Œæˆæ—¶ç½®é«˜HREADYï¼Œè¿”å›OKAYresponseï¼ŒæŒ‡ç¤ºä¼ è¾“æˆåŠŸå®Œæˆã€‚ ERROR responseç”¨äºæŒ‡ç¤ºæŸç§å½¢å¼çš„ä¼ è¾“å¤±è´¥ã€‚å¾ˆå…¸å‹çš„æ˜¯ä¿æŠ¤é”™è¯¯ï¼Œä¾‹å¦‚å°è¯•å†™å…¥åªèƒ½è¯»çš„å­˜å‚¨åŒºåŸŸã€‚ SPLITå’ŒRETRYå“åº”ç»„åˆè®©slaveèƒ½å»¶è¿Ÿä¼ è¾“çš„å®Œæˆï¼Œä½†æ˜¯é‡Šæ”¾æ€»çº¿ç»™å…¶å®ƒmasterç”¨ã€‚è¿™äº›å“åº”ç»„åˆé€šå¸¸ä»…ä»…è¢«é‚£äº›è®¿é—®å»¶è¿Ÿé•¿çš„masterä½¿ç”¨ï¼Œå……åˆ†åˆ©ç”¨è¿™äº›å“åº”ç å¯ä»¥ç¡®ä¿å…¶å®ƒçš„masterç”³è¯·busä¸ä¼šç­‰å¾…å¤ªé•¿çš„æ—¶é—´ã€‚ note: å½“slaveå‘ç°è¿˜ä¸èƒ½ç«‹åˆ»ç»™å‡ºå“åº”ç»“æœï¼Œéœ€è¦æ’å…¥å‡ ä¸ªç­‰å¾…å‘¨æœŸæ—¶ï¼Œå®ƒåº”è¯¥å“åº”OKAY 8.3 Two-cycle response åªæœ‰OKAYå“åº”æ‰å¯èƒ½å‡ºç°åœ¨å•å‘¨æœŸä¸­ã€‚ERRORï¼ŒSPLITå’ŒRETRYå“åº”è‡³å°‘éœ€è¦ä¸¤ä¸ªå‘¨æœŸã€‚ä¸ºäº†ç”¨è¿™äº›å“åº”ä¸­çš„ä»»ä½•ä¸€ä¸ªæ¥å®Œæˆä¼ è¾“ï¼Œåœ¨å€’æ•°ç¬¬äºŒä¸ªå‘¨æœŸï¼Œslaveé©±åŠ¨HRESP[1:0]æŒ‡ç¤ºERROR, RETRY or SPLITï¼ŒåŒæ—¶é©±åŠ¨HREADYä½ç”µå¹³æ¥æ‰©å±•ä¸€ä¸ªé¢å¤–çš„å‘¨æœŸã€‚åœ¨æœ€åä¸€ä¸ªå‘¨æœŸHREADYé©±åŠ¨åˆ°é«˜ç”µå¹³ç»“æŸè¿™æ¬¡ä¼ è¾“ï¼Œä½†æ˜¯HRESP[1:0]ä»ç„¶ä¿æŒä¸å˜æŒ‡ç¤ºERROR, RETRY or SPLITã€‚ å¦‚æœslaveéœ€è¦å¤šäºä¸¤ä¸ªå‘¨æœŸæ¥æä¾›ERROR, RETRY or SPLITå“åº”ï¼Œé‚£ä¹ˆé¢å¤–çš„ç­‰å¾…çŠ¶æ€åœ¨ä¼ è¾“çš„å¼€å§‹è¢«æ’å…¥ã€‚ç­‰å¾…æœŸé—´HREADY=0ï¼Œå“åº”è®¾ç½®ä¸ºOKAY ç”±äºæ€»çº¿æµæ°´çº¿çš„ç‰¹æ€§ï¼Œéœ€è¦ä¸¤ä¸ªå‘¨æœŸçš„å“åº”ã€‚è¿™æ—¶slaveå¼€å§‹å‘å°„ ERROR, SPLIT or RETRYä¸­çš„ä»»ä½•ä¸€ä¸ªå“åº”ï¼Œç„¶åä¸‹ä¸€æ¬¡ä¼ è¾“çš„åœ°å€å·²ç»è¢«å¹¿æ’­åˆ°æ€»çº¿ä¸Šã€‚ä¸¤å‘¨æœŸçš„å“åº”ç»™masterè¶³å¤Ÿçš„æ—¶é—´å–æ¶ˆåœ°å€ï¼Œåœ¨ä¸‹ä¸€æ¬¡ä¼ è¾“å¼€å§‹å‰é©±åŠ¨HTRANS[1:0]åˆ°IDLEã€‚ å¯¹äºSPLITå’ŒRETRYå“åº”ï¼Œæ¥ä¸‹æ¥çš„ä¼ è¾“ä¸€å®šè¢«å–æ¶ˆï¼Œå› ä¸ºåœ¨å½“å‰ä¼ è¾“å®Œæˆå‰ä¸èƒ½è¿›è¡Œæ­¤ä¼ è¾“ã€‚ä½†æ˜¯ï¼Œå¯¹äºERRORå“åº”ï¼Œå…¶ä¸­å½“å‰ä¼ è¾“æ²¡æœ‰é‡å¤æ—¶ï¼Œå®Œæˆæ¥ä¸‹æ¥ä¼ è¾“çš„æ˜¯å¯é€‰çš„ã€‚ 8.3.1 retry masterå¼€å§‹ä¸€ä¸ªåœ°å€Açš„ä¼ è¾“ åœ¨è¿™æ¬¡ä¼ è¾“çš„å“åº”æ”¶åˆ°å‰ï¼Œå®ƒå¼€å§‹æ–°çš„ä¼ è¾“A+4 åœ¨åœ°å€Açš„slaveä¸èƒ½ç«‹åˆ»å®Œæˆæ”¹æ¬¡ä¼ è¾“ï¼Œå› æ­¤å®ƒå›å¤RETRYå“åº”ï¼›è¿™ä¸ªå“åº”å‘Šè¯‰masteråœ°å€Açš„ä¼ è¾“ä¸èƒ½å®Œæˆï¼Œæ‰€ä»¥åœ°å€A+4çš„ä¼ è¾“è¢«å–æ¶ˆå¹¶ç”¨IDLEä¼ è¾“æ›¿ä»£ã€‚ 8.3.2 Error slaveéœ€è¦ä¸€ä¸ªå‘¨æœŸå†³å®šå“åº”(æ­¤æœŸé—´HRESPæŒ‡ç¤ºOKAY) ç„¶åslaveç”¨ä¸¤å‘¨æœŸçš„ERRORå“åº”ç»ˆæ­¢è¯¥ä¼ è¾“ 8.4 Error response å¦‚æœä¸€ä¸ªslaveæä¾›ä¸€ä¸ªé”™è¯¯å“åº”ï¼Œç„¶åmasterå¯ä»¥é€‰æ‹©å–æ¶ˆåœ¨çªå‘çš„å‰©ä½™ä¼ è¾“ã€‚ä½†æ˜¯ï¼Œè¿™ä¸æ˜¯ä¸€ä¸ªä¸¥æ ¼çš„è¦æ±‚ï¼Œå¹¶ä¸”masterç»§ç»­åœ¨çªå‘ä¸­ä¼ è¾“å‰©ä½™çš„æ•°æ®ä¹Ÿæ˜¯å¯ä»¥æ¥å—çš„ã€‚ 8.5 Split and retry åˆ†å‰²å’Œé‡è¯•å“åº”æä¾›äº†ä¸€ç§æœºåˆ¶ï¼Œå½“slaveä¸èƒ½ç«‹å³ä¸ºä¼ è¾“æä¾›æ•°æ®æ—¶ï¼Œå¯ä»¥é‡Šæ”¾æ€»çº¿ã€‚è¿™ä¸¤ç§æœºåˆ¶éƒ½å…è®¸åœ¨æ€»çº¿ä¸Šçš„ä¼ è¾“å®Œæˆï¼Œå› æ­¤å…è®¸é«˜ä¼˜å…ˆçº§çš„masterè®¿é—®æ€»çº¿ã€‚ ä¸¤è€…çš„ä¸åŒåœ¨äºä»²è£å™¨åˆ†é…æ€»çº¿çš„æ–¹æ³•ï¼š å¯¹äºretryï¼šä»²è£ç»§ç»­ä½¿ç”¨æ­£å¸¸çš„ä¼˜å…ˆçº§ç­–ç•¥ï¼Œå› æ­¤åªæœ‰æ›´é«˜ä¼˜å…ˆçº§çš„masterèƒ½è·å¾—æ€»çº¿ å¯¹äºsplitï¼šä»²è£å™¨è°ƒæ•´ä¼˜å…ˆç­–ç•¥ï¼Œä»¥è‡³äºä»»ä½•ç”³è¯·çš„masteréƒ½æœ‰æœºä¼šè·å¾—ï¼Œå³ä½¿æ˜¯é‚£äº›ä½ä¼˜å…ˆçº§çš„ã€‚ä¸ºäº†å®ŒæˆSPLITçš„ä¼ è¾“ï¼Œä»²è£å™¨å¿…é¡»è¢«é€šçŸ¥slaveä½•æ—¶å‡†å¤‡å¥½äº†æ•°æ®ã€‚ SPLITä¼ è¾“éœ€è¦åŒæ—¶åœ¨ä»²è£å™¨å’Œslaveä¸Šå¢åŠ å¤æ‚åº¦ï¼Œä½†æ˜¯å®ƒçš„ä¼˜åŠ¿åœ¨äºå®ƒå®Œå…¨é‡Šæ”¾æ€»çº¿ç»™å…¶å®ƒmasters, ä¸æ­¤ç›¸å¯¹çš„æ˜¯retryï¼Œå®ƒåªé‡Šæ”¾æ€»çº¿ç»™ä¼˜å…ˆçº§æ›´é«˜çš„masterã€‚ masteråº”è¯¥ç”¨åŒæ ·çš„æ–¹å¼å¯¹å¾…SPLITå’ŒRETRYã€‚å®ƒåº”è¯¥ç»§ç»­ç”³è¯·æ€»çº¿ï¼Œå°è¯•ä¼ è¾“ç›´åˆ°å®ƒè¦ä¹ˆæˆåŠŸå®Œæˆï¼Œè¦ä¹ˆå®ƒä»¥ERRORå“åº”æå‰ç»ˆæ­¢äº†ã€‚ 9 Data buses ä¸ºäº†AHBç³»ç»Ÿå®ç°ä¸éœ€è¦ä½¿ç”¨ä¸‰æ€é©±åŠ¨å™¨(tristate drivers)ï¼Œæˆ‘ä»¬éœ€è¦ç‹¬ç«‹çš„è¯»å’Œå†™æ•°æ®æ€»çº¿ã€‚æœ€å°çš„æ•°æ®æ€»çº¿å®½åº¦è¢«æŒ‡å®šä¸º32 bitsï¼Œä½†æ˜¯å¯ä»¥å¢åŠ ã€‚ 9.1 HWDATA[31:0] å†™æ•°æ®æ€»çº¿åœ¨å†™ä¼ è¾“æœŸé—´ç”±masteré©±åŠ¨ã€‚å¦‚æœä¼ è¾“è¢«æ‰©å±•ï¼Œmasterä¿æŒæ•°æ®æœ‰æ•ˆç›´åˆ°ä¼ è¾“å®Œæˆ(ç”±HREADY å˜é«˜æŒ‡ç¤º) å¯¹äºæ¯”èµ·æ€»çº¿å®½åº¦è¿˜çª„çš„ä¼ è¾“ï¼Œæ¯”å¦‚åœ¨32ä½æ€»çº¿ä¸Šä¼ è¾“16ä½ï¼Œé‚£ä¹ˆmasteråªç”¨é©±åŠ¨é€‚å½“çš„å­—èŠ‚é€šé“ï¼ˆbyte lanes)ã€‚slaveè´Ÿè´£ä¸ºå†™è¿›çš„æ•°æ®é€‰é€šæ­£ç¡®çš„å­—èŠ‚é€šé“ã€‚ğŸ‘‡è¡¨æ ¼è¯´æ˜å“ªä¸ªå­—èŠ‚é€šé“åˆ†åˆ«åœ¨å¤§ç«¯å’Œå°ç«¯ç³»ç»Ÿä¸­è¢«æ¿€æ´»ã€‚å¦‚æœéœ€è¦ï¼Œæ­¤ä¿¡æ¯å¯ä»¥æ‰©å±•ä¸ºæ›´å®½çš„æ•°æ®æ€»çº¿å®ç°ã€‚å¯¹äºä¼ è¾“å¤§å°å°äºæ•°æ®æ€»çº¿å®½åº¦çš„é˜µå‘ä¼ è¾“ï¼Œæ¯ä¸€æ‹æœ‰ä¸åŒçš„æ¿€æ´»å­—èŠ‚é€šé“ã€‚ æ¿€æ´»å­—èŠ‚é€šé“å–å†³äºç³»ç»Ÿæ˜¯å¤§ç«¯è¿˜æ˜¯å°ç«¯ï¼Œä½†æ˜¯AHBæ²¡æœ‰æŒ‡å®šæ‰€éœ€çš„ç«¯ã€‚å› æ­¤ï¼Œå¯¹äºç³»ç»Ÿä¸­çš„masterå’Œslaveä¿æŒç›¸åŒçš„ç«¯å¾ˆé‡è¦ã€‚ 9.2 HRDATA[31:0] è¯»æ•°æ®æ€»çº¿åœ¨è¯»ä¼ è¾“ä¸­è¢«å¯¹åº”çš„slaveé©±åŠ¨ã€‚å¦‚æœslaveæ‰©å±•ä¼ é€ï¼Œé‚£ä¹ˆslaveä»…ä»…éœ€è¦æä¾›æœ‰æ•ˆçš„æ•°æ®åœ¨ä¼ è¾“çš„æœ€åä¸€ä¸ªå‘¨æœŸï¼Œç”¨HREADY=1æŒ‡ç¤º å¯¹äºæ¯”æ€»çº¿å®½åº¦æ›´çª„çš„ä¼ è¾“ï¼Œslaveä»…ä»…éœ€è¦åœ¨æ¿€æ´»çš„å­—èŠ‚é€šé“ä¸Šæä¾›æœ‰æ•ˆçš„æ•°æ®ã€‚masterè´Ÿè´£ä»æ­£ç¡®çš„å­—èŠ‚é“ä¸­é€‰æ‹©æ•°æ® slaveåªè¦å½“ä¼ è¾“å¸¦æœ‰OKAYå“åº”å®Œæˆæ—¶æä¾›æœ‰æ•ˆæ•°æ®ã€‚ SPLIT, RETRY and ERROR responsesä¸éœ€è¦æä¾›æœ‰æ•ˆè¯»æ•°æ®ã€‚ 9.3 Endianness ä¸ºäº†è®©ç³»ç»ŸåŠŸèƒ½æ­£ç¡®ï¼Œæ‰€æœ‰æ¨¡å—ä½¿ç”¨åŒæ ·çš„ç«¯å¾ˆé‡è¦ï¼Œå¹¶ä¸”æ‰€æœ‰çš„æ•°æ®è·¯ç”±æˆ–è€…æ¡¥ä¹Ÿç”¨ä¸€æ ·çš„ã€‚ åŠ¨æ€ç«¯ä¸æ”¯æŒï¼Œå› ä¸ºç»å¤§å¤šåµŒå…¥ä¹¦ç³»ç»Ÿï¼Œè¿™å°†å¯¼è‡´å¤§é‡å†—ä½™çš„ç¡…å¼€é”€(silicon overhead that is redundant) å¯¹äºæŸå—è®¾è®¡è€…ï¼Œæˆ‘ä»¬æ¨èåªæœ‰é‚£äº›å¯è¢«ç”¨åœ¨è®¸å¤šåœ°æ–¹çš„æ¨¡å—æ‰åº”è¯¥è®¾è®¡æˆå¤§å°ç«¯ï¼Œè¦ä¹ˆå¸¦æœ‰å¯é…ç½®çš„å¼•è„š(pin)æˆ–è€…å†…éƒ¨æ§åˆ¶ä½å–é€‰æ‹©ç«¯çš„å¤§å°ã€‚å¯¹äºæ›´å¤šç‰¹å®šåº”ç”¨çš„æ¨¡å—ï¼Œå›ºå®šç«¯ä¸ºå°ç«¯æˆ–è€…å¤§ç«¯å¯ä»¥èŠ‚çœåŠŸè€—ï¼Œæé«˜æ¥å£æ€§èƒ½ã€‚ 10 Arbitration ä»²è£æœºåˆ¶è¢«ç”¨æ¥ç¡®ä¿ä»»ä½•æ—¶å€™åªæœ‰ä¸€ä¸ªmasterè®¿é—®æ€»çº¿ã€‚ä»²è£å™¨é€šè¿‡è§‚å¯Ÿä¸€äº›ä¸åŒçš„è¯·æ±‚ï¼Œåˆ¤æ–­å½“å‰è¯·æ±‚ä¸­æœ€é«˜ä¼˜å…ˆçº§çš„masteræ¥å®Œæˆè¿™ä¸€åŠŸèƒ½ã€‚ä»²è£ä¹Ÿæ¥å—æ¥è‡ªslaveçš„è¯·æ±‚ï¼Œè¯·æ±‚å®ŒæˆSPLITä¼ è¾“ã€‚ ä»»ä½•ä¸èƒ½å®ŒæˆSPLITä¼ è¾“çš„slaveéƒ½ä¸éœ€è¦çŸ¥é“ä»²è£çš„è¿‡ç¨‹ï¼Œé™¤éå®ƒä»¬éœ€è¦è§‚æµ‹è¿™æ ·çš„äº‹å®â€”â€”ä¸€è¿ä¸²çš„ä¼ è¾“å¯èƒ½æ— æ³•å®Œæˆå¦‚æœæ€»çº¿æ‰€æœ‰æƒæ”¹å˜äº†ã€‚ 10.1 Signal description HBUSREQx ï¼šæ€»çº¿è¯·æ±‚ä¿¡å·ï¼›æ¯ä¸ªmasteræœ‰å•ç‹¬çš„è¯·æ±‚ä¿¡å·è¿æ¥åˆ°ä»²è£å™¨ï¼Œæœ€å¤šæœ‰16ä¸ªç‹¬ç«‹çš„masterã€‚ HLOCKx ï¼šé”ä¿¡å·ä¸è¯·æ±‚ä¿¡å·è¢«masteråŒæ—¶å‘å‡ºï¼›å®ƒæŒ‡ç¤ºæˆ‘å°†è¦æ‰§è¡Œå¤§é‡ä¸å¯åˆ†å‰²çš„ä¼ è¾“ï¼Œå¹¶ä¸”ä¸€æ—¦å¸¦ğŸ”’ä¼ è¾“çš„ç¬¬ä¸€ä¸ªä¼ è¾“å¼€å§‹ï¼Œä»²è£ä¸€å®šä¸è¦æˆæƒå…¶å®ƒçš„masterã€‚è¯¥ä¿¡å·ä¸€å®šåœ¨å®ƒè®¿é—®çš„åœ°å€ä¹‹å‰è‡³å°‘ä¸€ä¸ªå‘¨æœŸå‘å‡ºï¼Œä»¥å…ä»²è£æ”¹å˜äº†æˆæƒä¿¡å·ã€‚ HGRANTx ï¼šæˆæƒä¿¡å·ç”±ä»²è£ç”Ÿæˆï¼ŒæŒ‡ç¤ºå½“å‰ç”³è¯·æ€»çº¿çš„masterä¸­ä¼˜å…ˆçº§æœ€é«˜çš„ï¼Œè€ƒè™‘é”ä¼ è¾“å’ŒSPLITä¼ è¾“åœ¨å†…ã€‚ HMASTER[3:0]ï¼šæŒ‡ç¤ºå½“å‰è°æœ‰æƒåˆ©ä½¿ç”¨æ€»çº¿ã€‚è¯¥ä¿¡å·è¿˜è¢«ç”¨æ¥å½“ä½œåœ°å€æ§åˆ¶å¤šé€‰å™¨çš„æ§åˆ¶ä¿¡å·ã€‚masterçš„å·ç è¿˜è¢«èƒ½å¤Ÿæ‰§è¡ŒSPLITä¼ è¾“çš„slavesä½¿ç”¨ï¼Œæ¥å‘ä»²è£æŒ‡ç¤ºå“ªä¸€ä¸ªmasterèƒ½å¤Ÿå®ŒæˆSPLITäº¤æ˜“ HMASTLOCKï¼šä»²è£å™¨é€šè¿‡å‘å‡ºè¯¥ä¿¡å·æŒ‡ç¤ºå½“å‰ä¼ è¾“æ˜¯å¸¦ğŸ”’ä¼ è¾“åºåˆ—çš„ä¸€éƒ¨åˆ†ï¼Œå…¶ä¸åœ°å€å’Œæ§åˆ¶ä¿¡å·æœ‰ç›¸åŒçš„æ—¶åºã€‚ HSPLIT[15:0] ï¼šèƒ½å¤Ÿå¤„ç†splitçš„slaveä½¿ç”¨16bitçš„SPLIT Complete busæ¥æŒ‡ç¤ºå“ªä¸ªmasterèƒ½å¤Ÿå®Œæˆsplitäº¤æ˜“ã€‚ä»²è£å™¨éœ€è¦è¿™ä¸ªä¿¡æ¯æ¥æˆæƒmasterå»å®Œæˆè¯¥æ¬¡ä¼ è¾“ã€‚ 10.2 Requesting bus access masterä½¿ç”¨HBUSREQxä¿¡å·æ¥è¯·æ±‚è®¿é—®æ€»çº¿ï¼Œå¹¶å¯èƒ½åœ¨ä»»ä½•å‘¨æœŸå‘èµ·è¯·æ±‚ã€‚ä»²è£å™¨å°†åœ¨æ—¶é’Ÿä¸Šå‡æ²¿å–æ ·è¯·æ±‚ä¿¡å·ç„¶åä½¿ç”¨å†…éƒ¨ä¼˜å…ˆçº§ç®—æ³•å†³å®šå“ªä¸ªmasterå°†æˆä¸ºä¸‹ä¸€ä¸ªæœ‰æƒåˆ©è®¿é—®æ€»çº¿çš„ã€‚ æ­£å¸¸æ¥è¯´ä»²è£å™¨åªä¼šå½“é˜µå‘å®Œæˆåæ‰æˆæƒä¸€ä¸ªä¸åŒçš„masterã€‚ä½†æ˜¯ï¼Œå¦‚æœéœ€è¦ï¼Œä»²è£å™¨èƒ½æå‰ç»ˆæ­¢ä¸€æ¬¡é˜µå‘æ¥è®©æ›´é«˜ä¼˜å…ˆçº§çš„masterè®¿é—®ã€‚ å¦‚æœmasteréœ€è¦é”è®¿é—®ï¼Œé‚£ä¹ˆå®ƒå¿…é¡»å‘é€HCLOKxä¿¡å·æ¥å‘ä»²è£å™¨æŒ‡ç¤ºï¼šä¸è¯¥æœ‰å…¶å®ƒçš„masterè¢«æˆæƒã€‚ å½“æœ‰ä¸€ä¸ªmasterè¢«æˆæƒæ€»çº¿å¹¶æ­£åœ¨æ‰§è¡Œä¸€ä¸ªå›ºå®šé•¿åº¦é•¿åº¦çš„é˜µå‘ï¼Œå®ƒæ²¡å¿…è¦æŒç»­è¯·æ±‚æ€»çº¿æ¥å®Œæˆé˜µå‘ã€‚ä»²è£å™¨è§‚å¯Ÿé˜µå‘çš„è¿›ç¨‹å¹¶ä½¿ç”¨HBURST[2:0]ä¿¡å·çŸ¥é“masterè¯·æ±‚äº†å¤šå°‘æ¬¡ä¼ è¾“ã€‚å¦‚æœmasterå¸Œæœ›åœ¨å½“å‰æ­£åœ¨è¿›è¡Œçš„burstä¹‹åå†æ‰§è¡Œç¬¬äºŒæ¬¡burstï¼Œé‚£ä¹ˆå®ƒåº”è¯¥åœ¨å½“å‰burstæœŸé—´é‡æ–°å‘å‡ºè¯·æ±‚ä¿¡å· å¦‚æœä¸€ä¸ªmasteråœ¨é˜µå‘ä¸­é€”å¤±å»äº†æ€»çº¿è®¿é—®æƒï¼Œé‚£ä¹ˆå®ƒå¿…é¡»é‡æ–°å‘å‡ºHBUSREQxè¯·æ±‚æ¥é‡æ–°è·å¾—æ€»çº¿è®¿é—®æƒã€‚ å¯¹äºæ²¡æœ‰å®šä¹‰é•¿åº¦çš„burstï¼Œmasterå¿…é¡»æŒç»­å‘å‡ºè¯·æ±‚çŸ¥é“å®ƒå¼€å§‹äº†æœ€åä¸€æ¬¡ä¼ è¾“(until it has started the last transfer)ã€‚åœ¨æ²¡æœ‰å®šä¹‰é•¿åº¦é˜µå‘çš„æœ«å°¾ï¼Œä»²è£å™¨ä¸èƒ½é¢„æµ‹ä½•æ—¶å»æ”¹å˜ä»²è£ã€‚ å½“masterä¸è¯·æ±‚æ€»çº¿æ—¶ï¼Œå®ƒå¯èƒ½è¢«æˆäºˆè¯¥æ€»çº¿ã€‚è¿™ç§æƒ…å†µå‘ç”Ÿåœ¨æ²¡æœ‰masterè¯·æ±‚æ€»çº¿å¹¶ä¸”ä»²è£å™¨æˆäºˆè®¿é—®æƒç»™ä¸€ä¸ªé»˜è®¤çš„masterã€‚å› æ­¤ï¼Œå¦‚æœmasterä¸éœ€è¦è®¿é—®æ€»çº¿ï¼Œå®ƒåº”è¯¥é©±åŠ¨ä¼ è¾“ç±»å‹HTRANSæŒ‡ç¤ºå½“å‰ä¼ è¾“ä¸ºIDLEã€‚ 10.3 Granting bus access10.3.1 granting with wait ä»²è£ç¨‹åºé€šè¿‡å£°æ˜é€‚å½“çš„HGRANTxä¿¡å·æ¥æŒ‡ç¤ºå½“å‰è¯·æ±‚æ€»çº¿ä¸­å“ªä¸ªmasteræ˜¯æœ€é«˜ä¼˜å…ˆçº§çš„ã€‚å½“å½“å‰ä¼ è¾“å®Œæˆï¼Œæœ‰HREADYä¸ºé«˜æ¥æŒ‡ç¤ºï¼Œä¹‹åmasterå°†è¢«æˆæƒå¹¶ä¸”ä»²è£å™¨ä¼šæ”¹å˜HMASTER[3:0]ä¿¡å·æ¥æŒ‡ç¤ºè¿™ä¸ªmasterçš„å·ç ã€‚ å½“masterå‘å‡ºHBUSREQxåå‡ ä¸ªå‘¨æœŸï¼Œä»²è£å™¨æ‰æˆæƒ(HGRANTxç½®é«˜) masteråªæœ‰ç­‰åˆ°HGRANTxå’ŒHREADYéƒ½ä¸ºé«˜æ‰å¼€å§‹ä¼ é€åœ°å€ã€‚åŒæ—¶HMASTER[3:0]æŒ‡ç¤ºè¯¥master åœ°å€è¢«slaveé‡‡æ ·ï¼Œå½“HREADYä¸ºé«˜æ—¶æ‰ä¼ é€ä¸‹ä¸€ä¸ªåœ°å€ã€‚ 10.3.2 Data bus owner æ•°æ®æ€»çº¿æ‹¥æœ‰æƒæ»åäºåœ°å€æ€»çº¿ã€‚(ğŸ‘†è½åT5å’ŒT6ä¸¤å‘¨æœŸ) æ— è®ºä¼ è¾“ä½•æ—¶å®Œæˆ(ç”±HREADYä¸ºé«˜æŒ‡ç¤º)ï¼Œé‚£ä¹ˆæ‹¥æœ‰åœ°å€æ€»çº¿çš„master(ğŸ‘†#2åœ¨T7å¯ä»¥ä¼ é€å†™æ•°æ®)å°†èƒ½å¤Ÿä½¿ç”¨æ•°æ®æ€»çº¿ï¼Œå¹¶ä¸€ç›´å æœ‰æ•°æ®æ€»çº¿ç›´åˆ°ä¼ è¾“å®Œæˆã€‚ 10.3.3 handover after burst ä»²è£å™¨åœ¨å€’æ•°ç¬¬äºŒä¸ªåœ°å€è¢«é‡‡æ ·å®Œ(ğŸ‘†T5)æ”¹å˜HGRANTxä¿¡å·ï¼Œæ–°çš„HGRANTxä¿¡å·å°†å’Œé˜µå‘çš„æœ€åä¸€ä¸ªåœ°å€ä¿¡å·åœ¨ç›¸åŒæ—¶åˆ»è¢«é‡‡æ ·(ğŸ‘†åªæœ‰HREADYä¸ºé«˜æ—¶æ‰é‡‡æ ·æˆåŠŸå³T7ï¼›æ­¤æ—¶HMASTERä¹Ÿæ”¹ä¸º#2)ã€‚ 10.3.4 hgrant and hmaster å› ä¸ºæœ‰ä¸­å¤®å¤ç”¨å™¨ï¼Œæ¯ä¸€ä¸ªmasteréƒ½èƒ½å¤Ÿé©±åŠ¨å®ƒä»¬æƒ³è¦ç«‹åˆ»æ‰§è¡Œçš„ä¼ è¾“çš„åœ°å€ï¼Œå¹¶ä¸”å®ƒä»¬ç›´åˆ°è¢«æˆäºˆæ€»çº¿æ‰éœ€è¦ç­‰å¾…ã€‚ HGRANTxä¿¡å·ä»…ä»…è¢«masterç”¨äºå†³å®šå®ƒä»¬ä½•æ—¶æ‹¥æœ‰æ€»çº¿ï¼Œå› æ­¤ä»€ä¹ˆæ—¶å€™å®ƒåº”è¯¥è€ƒè™‘åœ°å€å·²ç»è¢«é€‚å½“çš„slaveå–æ ·ã€‚ 10.4 Early burst termination æ­£å¸¸æ¥è¯´ï¼Œä»²è£å™¨ä¸ç”¨ç§»äº¤æ€»çº¿ç»™ä¸€ä¸ªæ–°çš„masterï¼Œç›´åˆ°é˜µå‘ä¼ è¾“çš„ç»“æŸã€‚ä½†æ˜¯ï¼Œå¦‚æœä»²è£å™¨è®¤ä¸ºé˜µå‘åº”è¯¥æå‰ç»ˆæ­¢ä¸ºäº†é¿å…è®¿é—®æ€»çº¿æ—¶é—´è¿‡é•¿ï¼Œé‚£ä¹ˆå®ƒå¯èƒ½åœ¨é˜µå‘å®Œæˆä¹‹å‰è½¬æ¢æˆæƒç»™å¦å¤–ä¸€ä¸ªmasterã€‚ 10.5 default bus master æ¯ä¸ªç³»ç»Ÿä¸€å®šåŒ…å«ä¸€ä¸ªé»˜è®¤çš„masterï¼Œå®ƒåœ¨å…¶å®ƒmasteréƒ½ä¸èƒ½è®¿é—®æ€»çº¿æ—¶è¢«æˆäºˆä½¿ç”¨ã€‚å½“è¢«æˆäºˆæ—¶ï¼Œé»˜è®¤masterä¸€å®šåªèƒ½è¿›è¡ŒIDLEçš„ä¼ è¾“ã€‚ å¦‚æœæ²¡æœ‰masterè¯·æ±‚æ€»çº¿ï¼Œé‚£ä¹ˆä»²è£å™¨è¦ä¹ˆæˆæƒé»˜è®¤çš„masterï¼Œè¦ä¹ˆæˆäºˆå¯èƒ½ä»è®¿é—®æ€»çº¿ä½å»¶è¿Ÿè·ç›Šæœ€å¤§çš„masterã€‚ æˆäºˆå¯¹æ€»çº¿é»˜è®¤çš„masterè®¿é—®æƒè¿˜æä¾›äº†ä¸€ç§æœ‰ç”¨çš„æœºåˆ¶ï¼Œä»¥ç¡®ä¿æ€»çº¿ä¸Šä¸ä¼šå¯åŠ¨æ–°çš„ä¼ è¾“ï¼Œæ˜¯åœ¨è¿›å…¥ä½åŠŸç‡å·¥ä½œæ¨¡å¼ä¹‹å‰æ‰§è¡Œçš„ä¸€ä¸ªæœ‰ç”¨çš„æ­¥éª¤ â­å¦‚æœæ‰€æœ‰å…¶å®ƒmasteréƒ½åœ¨ç­‰å¾…åˆ†å‰²ä¼ è¾“å®Œæˆï¼Œåˆ™å¿…é¡»æˆäºˆé»˜è®¤masterã€‚ 11 Split transfer SPLITä¼ è¾“é€šè¿‡åˆ†ç¦»masterå‘slaveæä¾›åœ°å€çš„æ“ä½œå’Œslaveå‘masteræä¾›æ­£ç¡®æ•°æ®çš„æ“ä½œï¼Œæ¥æé«˜æ€»çš„æ€»çº¿åˆ©ç”¨ç‡ã€‚ å½“ä¸€æ¬¡ä¼ è¾“å‘ç”Ÿæ—¶ï¼Œslaveå¦‚æœç›¸ä¿¡è¯¥æ¬¡ä¼ è¾“éœ€è¦èŠ±è´¹å¾ˆå¤šå‘¨æœŸå»æ‰§è¡Œï¼Œé‚£ä¹ˆå®ƒå°†å‘é€SPLITå“åº”ã€‚è¿™ä¸ªä¿¡å·å‘Šè¯‰ä»²è£å™¨å½“å‰å°è¯•ä¼ è¾“çš„masterä¸åº”è¯¥è¢«æˆæƒç›´åˆ°slaveè¡¨ç¤ºå®ƒå·²ç»å‡†å¤‡å¥½å®Œæˆä¼ è¾“ã€‚å› æ­¤ä»²è£å™¨éœ€è¦è§‚æµ‹å“åº”ä¿¡å·å¹¶åœ¨å†…éƒ¨å±è”½æ¥è‡ªå·²è¢«åˆ†å‰²(have been SPLIT)çš„masterçš„ä»»ä½•è¯·æ±‚ åœ¨ä¸€æ¬¡ä¼ è¾“çš„åœ°å€ç›¸ä¸­ï¼Œä»²è£å™¨äº§ç”Ÿä¸€ä¸ªæ ‡ç­¾æˆ–è€…masterç¼–å·HMASTER[3:0]ï¼ŒæŒ‡ç¤ºæ­£åœ¨æ‰§è¡Œä¼ è¾“çš„masterã€‚ä»»ä½•å‘å‡ºSPLITå“åº”çš„slaveå¿…é¡»èƒ½å¤ŸæŒ‡ç¤ºå®ƒä»¬æœ‰èƒ½åŠ›å®Œæˆä¼ è¾“ï¼Œå¹¶ä¸”å®ƒé€šè¿‡è®°å½•HMASTER[3:0]ä¿¡å·ä¸Šçš„masterç¼–å·æ¥åšåˆ°è¿™ä¸€ç‚¹ éšåï¼Œå½“slaveå®Œæˆäº†ä¼ è¾“ï¼Œå®ƒæ ¹æ®masterç¼–å·åœ¨HSPLITx[15:0]ä¸Šå‘ä»²è£å™¨å‘å‡ºåˆé€‚çš„ä½ã€‚ä»²è£å™¨ç„¶åä½¿ç”¨è¯¥ä¿¡æ¯unmask(åœæ­¢å±è”½)å¯¹åº”masterçš„è¯·æ±‚ä¿¡å·å¹¶åœ¨é€‚å½“çš„é€‚åˆ(in due course)masterè¢«æˆæƒè®¿é—®æ¥é‡å¯ä¹‹å‰çš„ä¼ è¾“ã€‚ä»²è£å™¨æ¯å‘¨æœŸéƒ½å–æ ·HSPLITxä¿¡å·ï¼Œå› æ­¤slaveåªéœ€è¦å‘å‡ºåˆé€‚çš„ä½æŒç»­ä¸€ä¸ªå‘¨æœŸä»¥ä¾¿ä»²è£å™¨èƒ½å¤Ÿè¯†åˆ«å®ƒã€‚ åœ¨å¸¦æœ‰å¤šä¸ªæœ‰èƒ½åŠ›å‘é€SPLITçš„slaveç³»ç»Ÿä¸­ï¼Œæ¥è‡ªæ¯ä¸ªslaveçš„HSPLITxä¿¡å·è¢«æˆ–æ“ä½œåˆ°ä¸€èµ·ï¼Œäº§ç”Ÿä¸€ä¸ªæœ€ç»ˆç»“æœçš„HSPLITä¿¡å·ç»™ä»²è£å™¨ã€‚ åœ¨å¤§å¤šæ•°ç³»ç»Ÿä¸­ï¼Œå¯èƒ½ç”¨ä¸åˆ°16ä¸ªmasterçš„æœ€å¤§å®¹é‡ã€‚å› æ­¤ä»²è£å™¨åªéœ€è¦ä¸€æ ¹HSPLITæ€»çº¿ï¼Œå…¶ä½æ•°ä¸masterä¸ªæ•°ç›¸åŒã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬æ¨èæ‰€æœ‰æœ‰èƒ½åŠ›å‘é€splitçš„slaveéƒ½è¢«è®¾è®¡æˆæ”¯æŒæœ€å¤šçš„16ä¸ªmasterã€‚ 11.1 split transfer seq SPLITäº¤æ˜“çš„åŸºæœ¬é˜¶æ®µå¦‚ä¸‹ï¼š masterä»¥å’Œå…¶ä»–ä»»ä½•ä¼ è¾“ç›¸åŒçš„æ–¹å¼å¼€å¯ä¼ è¾“ï¼Œå¹¶å‘å°„åœ°å€å’Œæ§åˆ¶ä¿¡æ¯ã€‚ å¦‚æœslaveèƒ½å¤Ÿç«‹åˆ»æä¾›æ•°æ®ï¼Œå®ƒå¯èƒ½è¿™æ ·åšã€‚å¦‚æœslaveå†³å®šå®ƒå¯èƒ½éœ€è¦å¤šä¸ªå‘¨æœŸè·å¾—æ•°æ®ï¼Œå®ƒå°†ç»™å‡ºä¸€ä¸ªSPLITå“åº”ã€‚åœ¨æ¯æ¬¡ä¼ è¾“ä¸­ï¼Œä»²è£å™¨å¹¿æ’­ä¸€ä¸ªå·ç æˆ–è€…æ ‡ç­¾â€”æŒ‡ç¤ºæ­£åœ¨ä½¿ç”¨æ€»çº¿çš„masterã€‚slaveå¿…é¡»è®°å½•è¿™ä¸ªå·ç ï¼Œåé¢ç”¨è¿™ä¸ªä¿¡æ¯é‡å¯è¿™ä¸ªä¼ è¾“ã€‚ ä»²è£å™¨æˆæƒå…¶å®ƒmasterï¼Œå¹¶ä¸”SPLITå“åº”çš„åŠ¨ä½œå…è®¸masteråˆ‡æ¢çš„å‘ç”Ÿã€‚å¦‚æœæ‰€æœ‰å…¶å®ƒçš„masterä¹Ÿæ”¶åˆ°äº†SPLITå“åº”ï¼Œé‚£ä¹ˆé»˜è®¤çš„masterè¢«æˆæƒã€‚ å½“slaveå‡†å¤‡å¥½å®Œæˆä¼ è¾“æ—¶ï¼Œå®ƒå‘å‡ºåˆé€‚çš„HSPLITxä¸­çš„ä½ç»™ä»²è£å™¨æŒ‡ç¤ºå“ªä¸ªmasterè¢«æˆæƒè®¿é—®æ€»çº¿ã€‚ ä»²è£å™¨æ¯ä¸ªå‘¨æœŸéƒ½ä¼šè§‚å¯ŸHSPLITxä¿¡å·ï¼Œå¹¶ä¸”å½“HSPLITxä¸­ä»»ä½•ä¸€ä½è¢«å£°æ˜æ—¶ï¼Œä»²è£å™¨æ¢å¤è¯¥masterçš„ä¼˜å…ˆçº§(å› ä¸ºä¹‹å‰è¢«å±è”½äº†) æœ€ç»ˆä»²è£å™¨æˆæƒè¯¥masterï¼Œå¥½è®©å®ƒèƒ½å¤Ÿé‡æ–°å°è¯•è¿™æ¬¡ä¼ è¾“ã€‚å¦‚æœä¸€ä¸ªæ›´é«˜ä¼˜å…ˆçº§çš„masteræ­£åœ¨ä½¿ç”¨ï¼Œä¸Šè¿°åœºæ™¯å¯èƒ½ä¸ä¼šç«‹åˆ»å‘ç”Ÿã€‚ å½“ä¼ è¾“æœ€ç»ˆå‘ç”Ÿæ—¶ï¼Œslaveç”¨OKAYå“åº”ç»“æŸè¿™æ¬¡ä¼ è¾“ã€‚ 11.2 multiple split transâ“ è¯¥æ€»çº¿åè®®ä»…å…è®¸æ¯ä¸ªmasteræœ‰ä¸€ä¸ªæ»å¤–äº¤æ˜“/æœªå®Œæˆäº‹ç‰©(outstanding transaction)ã€‚å¦‚æœä»»ä½•masteræ¨¡å—èƒ½å¤Ÿå¤„ç†ä¸æ­¢ä¸€ä¸ªæ»å¤–äº¤æ˜“ï¼Œä»–éœ€è¦ä¸ºæ¯ä¸ªå®ƒèƒ½å¤„ç†çš„æ»å¤–äº¤æ˜“æä¾›ä¸€ç»„é¢å¤–çš„è¯·æ±‚å’Œæˆæƒä¿¡å·ã€‚åœ¨åè®®çº§åˆ«ä¸Šï¼Œå•ä¸ªæ¨¡å—å¯ä»¥ä½œä¸ºè®¸å¤šä¸åŒçš„masterå‡ºç°ï¼Œæ¯ä¸€ä¸ªmasteråªèƒ½æœ‰ä¸€ä¸ªæ»å¤–äº¤æ˜“ã€‚ â“ä½†æ˜¯ï¼Œä¸€ä¸ªæœ‰èƒ½åŠ›å¤„ç†SPLITçš„slaveå¯èƒ½æ¥æ”¶æ¯”å®ƒæ‰€èƒ½å¹¶å‘å¤„ç†æ›´å¤šçš„ä¼ è¾“è¯·æ±‚ã€‚å¦‚æœè¿™ç§æƒ…å†µå‘ç”Ÿï¼Œslaveå‘é€SPLITå“åº”ï¼Œä½†æ²¡æœ‰è®°å½•ä¸ä¼ è¾“å¯¹åº”çš„åœ°å€å’Œæ§åˆ¶ä¿¡æ¯æ˜¯å¯æ¥å—çš„ï¼Œslaveåªæ˜¯å¿…é¡»è®°å½•masterçš„ç¼–å·ã€‚é€šè¿‡ä¸ºæ‰€æœ‰ä¹‹å‰æœ‰splitä¼ è¾“å…³è”çš„masterå£°æ˜HSPLITxä¸­åˆé€‚çš„ä½ï¼Œç„¶åslaveæŒ‡ç¤ºå®ƒå¯ä»¥å¤„ç†å¦ä¸€ä¸ªä¼ è¾“ï¼Œä½†æ˜¯slaveæ²¡æœ‰è®°å½•åœ°å€å’Œæ§åˆ¶ä¿¡æ¯ã€‚ ç„¶åä»²è£å™¨èƒ½å¤Ÿé‡æ–°æˆæƒmasterè®¿é—®ï¼Œå®ƒä»¬ä¹Ÿå°±èƒ½å¤Ÿé‡æ–°å°è¯•ä¼ è¾“ï¼Œç»™äºˆslaveæ‰€è¦æ±‚çš„åœ°å€å’Œæ§åˆ¶ä¿¡æ¯ã€‚è¿™æ„å¤–ç€masteråœ¨å®ƒæœ€ç»ˆè¢«å…è®¸å®Œæˆå®ƒè¯·æ±‚çš„ä¼ è¾“å‰éœ€è¦è¢«æˆæƒè®¸å¤šæ—¶é—´(a number of time)ã€‚ 11.3 preventing deadlock SPLITå’ŒRETRYå“åº”ä½¿ç”¨æ—¶ä¸€å®šè¦é¿å…æ­»é”ã€‚å•ä¸ªä¼ è¾“ä¸å¯èƒ½é”ä½AHB,å› ä¸ºæ¯ä¸ªslaveä¸€å®šè¢«æŒ‡æ´¾åœ¨é¢„å…ˆè§„å®šçš„å‘¨æœŸå†…å»å®Œæˆä¼ è¾“ã€‚ä½†æ˜¯ï¼Œå¦‚æœå¤§é‡ä¸åŒçš„masterå°è¯•è®¿é—®åŒä¸€ä¸ªslaveï¼Œè¿™ä¸ªslaveä»¥ä¸èƒ½å¤„ç†çš„æ–¹å¼å‘å°„SPLITå’ŒRETRYå“åº”æ—¶å¯èƒ½å‘ç”Ÿæ­»é”ã€‚ 11.3.1 Split å¯¹äºèƒ½å¤Ÿå‘å°„splitå“åº”çš„slaveï¼Œæ€»çº¿æ­»é”é€šè¿‡ç¡®ä¿slaveèƒ½å¤Ÿç»å—å¾—ä½ç³»ç»Ÿä¸­æ¯ä¸ªmasterçš„è¯·æ±‚æ¥é¿å…(æœ€å¤š16ä¸ª)ã€‚slaveæ²¡å¿…è¦ä¿å­˜æ¯æ¬¡ä¼ è¾“çš„åœ°å€å’Œæ§åˆ¶ä¿¡æ¯ï¼Œå®ƒä»…ä»…éœ€è¦è®°å½•è¿™æ ·çš„äº‹å®ï¼šä¸€æ¬¡ä¼ è¾“è¯·æ±‚å·²ç»å‘å‡ºï¼Œå¹¶ä¸”ä¸€ä¸ªSPLITå“åº”ä¹Ÿå‘å‡ºã€‚æœ€ç»ˆæ‰€æœ‰çš„masteréƒ½å°†åœ¨ä¸€ä¸ªè¾ƒä½ä¼˜å…ˆçº§ï¼Œç„¶åslaveå¯ä»¥æœ‰åºåœ°å¤„ç†è¿™äº›è¯·æ±‚ï¼Œå‘ä»²è£å™¨æŒ‡ç¤ºå®ƒæ­£åœ¨å¤„ç†å“ªä¸ªè¯·æ±‚ï¼Œå› æ­¤ä¿è¯æ‰€æœ‰çš„è¯·æ±‚æœ€ç»ˆéƒ½è¢«å®Œæˆã€‚ å½“ä¸€ä¸ªslaveæœ‰è®¸å¤šæœªå®Œæˆçš„è¯·æ±‚ï¼Œå®ƒå¯ä»¥é€‰æ‹©ä»¥ä»»ä½•æ¬¡åºå»å¤„ç†å®ƒä»¬ï¼Œå°½ç®¡slaveä¸€å®šè¦æ³¨æ„é”å®šçš„ä¼ è¾“(locked transfer)å¿…é¡»åœ¨ä»»ä½•å…¶å®ƒä¼ è¾“å¯ä»¥ç»§ç»­ä¹‹å‰å®Œæˆã€‚ ç†æƒ³æƒ…å†µä¸‹ï¼Œmasterçš„æœªå®Œæˆä¼ è¾“é‡ä¸åº”è¯¥è¶…è¿‡å®ƒæ‰€èƒ½æ”¯æŒçš„ä¼ è¾“é‡ï¼Œä½†æ˜¯éœ€è¦è¿™ç§æœºåˆ¶æ¥é˜²æ­¢æ€»çº¿æ­»é”ã€‚ 11.3.2 Retry å¯¹äºå‘é€RETRYå“åº”çš„slaveæ¯æ¬¡åªèƒ½ç”±ä¸€ä¸ªmasterè®¿é—®ã€‚è¿™ä¸æ˜¯ç”±æ€»çº¿çš„åè®®å¼ºåˆ¶æ‰§è¡Œçš„ï¼Œåº”è¯¥ç”±ç³»ç»Ÿä½“ç³»ç»“æ„ç¡®ä¿ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå‘é€RETRYå“åº”çš„slaveå¯èƒ½æ˜¯é‚£äº›ä¸€æ¬¡åªæœ‰ä¸€ä¸ªmasterè®¿é—®çš„å¤–å›´è®¾å¤‡ï¼Œæ‰€ä»¥èƒ½å¤Ÿè¢«æ›´é«˜çº§åˆ«åè®®ç¡®ä¿ã€‚ å¯¹å¤šmasterè®¿é—®RETRY slavesçš„ç¡¬ä»¶ä¿æŠ¤ä¸æ˜¯æœ¬åè®®çš„è¦æ±‚ï¼Œä½†å¯æŒ‰ä¸‹ä¸€æ®µæ‰€è¿°å®ç°ã€‚åœ¨æ€»çº¿çº§åˆ«ä¸Šï¼Œåªè¦æ±‚slaveä¸€å®šè¦åœ¨é¢„å®šæ•°é‡çš„æ—¶é’Ÿå‘¨æœŸå†…é©±åŠ¨HREADYåˆ°é«˜ç”µå¹³ã€‚ å¦‚æœéœ€è¦ç¡¬ä»¶ä¿æŠ¤ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨RETRY slaveæœ¬èº«ä¸Šå®ç°ã€‚å½“ä¸€ä¸ªslaveå‘å°„ä¸€ä¸ªRETRYï¼Œå®ƒèƒ½é‡‡æ ·masterå·ç ã€‚åœ¨è¯¥æ—¶åˆ»å’Œä¼ è¾“æœ€ç»ˆè¢«å®Œæˆä¹‹é—´ï¼Œslaveæ£€æŸ¥æ¯ä¸ªä¼ è¾“å°è¯•ï¼Œä»¥ç¡®ä¿æ˜¯ç›¸åŒçš„masterå·ç ã€‚å¦‚æœå®ƒæ£€æµ‹åˆ°ä¸»ç¼–å·ä¸åŒï¼Œé‚£ä¹ˆå®ƒå¯ä»¥é‡‡å–å¦ä¸€ç§æ“ä½œè¿‡ç¨‹ï¼Œä¾‹å¦‚ï¼š ERRORå“åº” å‘é€ä»²è£å™¨ä¸€ä¸ªä¿¡å· ç³»ç»Ÿçº§åˆ«ä¸­æ–­(a system level interrupt) ç³»ç»Ÿé‡ç½®(a complete system reset) 11.4 Bus handover åè®®è¦æ±‚masteråœ¨æ¥æ”¶åˆ†å‰²(split)æˆ–é‡è¯•(retry)å“åº”å,ç«‹å³æ‰§è¡Œä¸€æ¬¡IDLEä¼ è¾“å¥½è®©æ€»çº¿è¢«è½¬äº¤ç»™å¦ä¸€ä¸ªmasterã€‚ T1ä¹‹åä¼ è¾“çš„åœ°å€å‡ºç°åœ¨æ€»çº¿ä¸Šï¼›åœ¨T2å’ŒT3æ—¶é’Ÿæ²¿åslaveè¿”å›ä¸¤ä¸ªå‘¨æœŸSPLITå“åº” ç¬¬ä¸€ä¸ªå“åº”å‘¨æœŸç»“æŸï¼ŒT3ï¼Œmasteræ£€æµ‹åˆ°ä¼ è¾“è¢«åˆ†å‰²(be SPLIT)æ‰€ä»¥å®ƒæ”¹å˜ä¸‹ä¸€æ¬¡ä¼ è¾“çš„æ§åˆ¶ä¿¡å·ä¸ºIDLEã€‚ åŒæ—¶åœ¨T3ï¼Œä»²è£å™¨é‡‡æ ·å“åº”ä¿¡å·å¹¶å‘ç°ä¼ è¾“å°†æ˜¯SPLITã€‚ç„¶åä»²è£å™¨èƒ½å¤Ÿè°ƒæ•´ä»²è£ä¼˜å…ˆçº§ï¼Œå¹¶ä¸”grantä¿¡å·åœ¨æ¥ä¸‹æ¥çš„ä¸€ä¸ªå‘¨æœŸå‘ç”Ÿæ”¹å˜ï¼Œä»¥è‡³äºæ–°çš„masterèƒ½å¤Ÿè¢«æˆæƒåœ°å€æ€»çº¿åœ¨T4ä¹‹åã€‚ â­æ–°masterè¢«ä¿è¯ç«‹åˆ»è®¿é—®ï¼Œå› ä¸ºIDLEä¼ è¾“æ€»æ˜¯åœ¨ä¸€ä¸ªå‘¨æœŸå®Œæˆã€‚ 12 Reset HRESETnæ˜¯AHBæ–‡æ¡£ä¸­å”¯ä¸€çš„ä½ç”µå¹³æœ‰æ•ˆçš„ä¿¡å·ï¼Œå¹¶ä¸”æ˜¯æ‰€æœ‰æ€»çº¿å…ƒä»¶çš„ä¸»è¦å¤ä½ã€‚å¤ä½å¯å¼‚æ­¥å£°æ˜ï¼Œä½†æ˜¯åœ¨HCLKä¸Šå‡æ²¿ä¹‹ååŒæ­¥å¤±æ•ˆ(deasserted)ã€‚ åœ¨å¤ä½æœŸé—´ï¼Œæ‰€æœ‰masterç¡®ä¿åœ°å€å’Œæ§åˆ¶ä¿¡å·éƒ½åœ¨æœ‰æ•ˆçŠ¶æ€å¹¶ä¸”HTRANS[1:0]æŒ‡ç¤ºIDLEã€‚ 13 Data bus width åœ¨ä¸æé«˜æ“ä½œé¢‘ç‡ä¸‹ï¼Œæé«˜æ€»çº¿å¸¦å®½çš„ä¸€ç§æ–¹æ³•æ˜¯æé«˜æ€»çº¿æ•°æ®é€šé“å®½åº¦ã€‚é‡‘å±å±‚çš„å¢åŠ å’Œå¤§ç‰‡å†…å­˜å‚¨å—çš„ä½¿ç”¨(ä¾‹å¦‚åµŒå…¥çš„DRAM)éƒ½æ˜¯é¼“åŠ±æ›´å®½æ€»çº¿çš„ä½¿ç”¨çš„é©±åŠ¨å› ç´ ã€‚ æŒ‡å®šä¸€ä¸ªå›ºå®šå®½åº¦çš„æ€»çº¿æ„å‘³ç€ï¼Œåœ¨è®¸å¤šæƒ…å†µä¸‹æ€»çº¿çš„å®½åº¦å¯¹äºåº”ç”¨ä¸æ˜¯æœ€ä¼˜çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬é‡‡ç”¨çµæ´»çš„æ€»çº¿å®½åº¦ï¼Œä½†æ˜¯ä»»ç„¶ä¿è¯æ¨¡å—åœ¨è®¾è®¡ä¹‹é—´å…·æœ‰é«˜åº¦çš„å¯ç§»æ¤æ€§(highly portable) AHBåè®®å…è®¸æ•°æ®æ€»çº¿ä¸º8ï¼Œ16ï¼Œ32ï¼Œ64ï¼Œ128ï¼Œ256ï¼Œ512æˆ–è€…1024bitsã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬æ¨èæœ€å°æ€»çº¿å®½åº¦ä¸º32bits,é¢„è®¡æœ€å¤§256bitså°†å¯¹ç»å¤§å¤šæ•°åº”ç”¨éƒ½æ˜¯è¶³å¤Ÿçš„ã€‚ å¯¹äºè¯»å’Œå†™ä¼ è¾“ï¼Œæ¥æ”¶æ¨¡å—å¿…é¡»ä»æ€»çº¿ä¸Šæ­£ç¡®çš„å­—èŠ‚é€šé“é€‰æ‹©æ•°æ®ã€‚ä¸éœ€è¦è·¨æ‰€æœ‰å­—èŠ‚é€šé“å¤åˆ¶æ•°æ®ã€‚ 14 narrow slave on wide bus ğŸ‘‡å›¾å±•ç¤ºäº†ä¸€ä¸ªåŸæœ¬è¢«è®¾è®¡æˆå¤„ç†32ä½æ•°æ®æ€»çº¿çš„slaveæ¨¡å—ï¼Œæ˜¯å¦‚ä½•è¢«è½»æ¾è½¬æ¢ä¸ºå¤„ç†64ä½æ€»çº¿ã€‚è¿™ä»…ä»…éœ€è¦é¢å¤–çš„å¤–éƒ¨é€»è¾‘ï¼Œè€Œä¸éœ€è¦ä»»ä½•å†…éƒ¨è®¾è®¡çš„æ”¹å˜ï¼Œå› æ­¤è¿™é¡¹æŠ€æœ¯ä¹Ÿå¯ä»¥è¢«ç”¨åˆ°ç¡¬å®å•å…ƒã€‚ å¯¹äºè¾“å‡ºï¼Œå½“è½¬åŒ–çª„çš„æ€»çº¿åˆ°ä¸€ä¸ªå®½çš„æ€»çº¿ï¼Œåšä¸‹é¢ä¸­çš„ä¸€æ¡ï¼š å°†æ•°æ®å¤åˆ¶åˆ°å®½æ€»çº¿çš„ä¸¤ä¸ªéƒ¨åˆ†(åƒğŸ‘†) ä½¿ç”¨é¢å¤–å±‚æ¬¡é€»è¾‘ç¡®ä¿æ€»çº¿åªæœ‰åˆé€‚çš„åŠéƒ¨åˆ†æ”¹å˜ã€‚è¿™å¯ä»¥èŠ‚çº¦èƒ½è€—ã€‚ 15 wide slave on narrow slave ğŸ‘‡å›¾å±•ç¤ºäº†ä¸€ä¸ªå®½æ¥å£çš„slaveè¢«å®ç°åœ¨ä¸€ä¸ªçª„çš„æ€»çº¿ä¸Šã€‚","categories":[{"name":"RISC-V","slug":"RISC-V","permalink":"https://www.beenli.cn/categories/RISC-V/"},{"name":"spec","slug":"RISC-V/spec","permalink":"https://www.beenli.cn/categories/RISC-V/spec/"}],"tags":[{"name":"specification","slug":"specification","permalink":"https://www.beenli.cn/tags/specification/"}]},{"title":"12-hour clock using six BCD digits","slug":"12-hour-clock-using-six-BCD-digits","date":"2020-10-06T01:02:04.000Z","updated":"2020-10-06T03:32:55.882Z","comments":true,"path":"posts/8cc45ed0/","link":"","permalink":"https://www.beenli.cn/posts/8cc45ed0/","excerpt":"","text":"problem linkï¼šhttps://hdlbits.01xz.net/wiki/Count_clock Background æ—¶é’Ÿæ˜¯æ¯ä¸ªäººæ¯å¤©éƒ½ä¼šç”¨åˆ°çš„å·¥å…·ï¼Œé‚£æ€ä¹ˆç”¨ç”µå­ç”µè·¯æ­å»ºä¸€ä¸ª12-hour(å¸¦æœ‰am/pmæŒ‡ç¤º)çš„æ—¶é’Ÿå‘¢ï¼Ÿ Problem description é€‰æ‹©ä¸€ç³»åˆ—åˆé€‚çš„è®¡æ•°å™¨ã€‚ä½ çš„è®¡æ•°å™¨ç»Ÿä¸€è¢«å¿«æ—¶é’Ÿ(fast-running clock)é©±åŠ¨, è¿˜å¸¦æœ‰ä¸€ä¸ªè„‰å†²ä½¿èƒ½è¾“å…¥ï¼Œè¯¥è„‰å†²ä¼šåœ¨ä»»ä½•éœ€è¦æ—¶é’ŸåŠ 1çš„æ—¶å€™åˆ°æ¥ï¼ˆi.e.ï¼Œæ¯ç§’æ¥ä¸€æ¬¡) resetï¼šé‡ç½®æ—¶é’Ÿåˆ°12ï¼š00ï¼š00 AM pm is 0 for AM and 1 for PM hh:mm:ssï¼šéƒ½å„è‡ªä»£è¡¨ä¸¤ä½BCD(ç”¨å››ä½äºŒè¿›åˆ¶è¡¨è¾¾ä¸€ä½åè¿›åˆ¶)æ•°ï¼› hh(hours)ï¼š01-12ï¼›mm(minutes)ï¼š00-59ï¼›ss(seconds)ï¼š00-59 resetæ¯”enableæœ‰æ›´é«˜çš„æƒé™ï¼Œå³ä½¿åœ¨ä½¿èƒ½ä¿¡å·æ— æ•ˆçš„æ—¶å€™ä¹Ÿå¯ä»¥å€¼ä½ã€‚ ğŸ‘‡ï¼šä»11:59:59 AM åˆ°12:00:00 PMç¿»è½¬å’ŒåŒæ­¥å¤ä½ï¼Œä½¿èƒ½çš„è¡Œä¸ºã€‚ Hintï¼šNote that 11:59:59 PM(æ™šä¸Šè½¬é’Ÿ) advances to 12:00:00 AM, and 12:59:59 PMï¼ˆä¸­åˆå¿«1ç‚¹äº†) advances to 01:00:00 PM. There is no 00:00:00. Template1234567891011// Module Declarationmodule top_module( input clk, input reset, input ena, output pm, output [7:0] hh, output [7:0] mm, output [7:0] ss); endmodule Answerâ‘  1ä½BCDè®¡æ•°å™¨ å¤ä½åˆ°0ï¼šä¸ºåˆ†é’Ÿï¼Œç§’è®¡æ•°å™¨æœåŠ¡ 12345678910111213/************** 1ä½BCDè®¡æ•°å™¨,å¤ä½åˆ°0;å®ç°0-9çš„å¾ªç¯ ***************/module bcdreset0 ( input clk, input reset, // Synchronous active-high reset input enable, output [3:0] q); always @ (posedge clk) begin if(reset) q &lt;= 4'h0; else if(!enable) q &lt;= q; else if(q == 4'h9) q &lt;= 4'h0; else q &lt;= q + 4'h1; endendmodule å¤ä½åˆ°2ï¼šä¸ºå°æ—¶ä½ä½æœåŠ¡(x-&gt;2)[â­æ­¤å¤„æœ‰ç‰¹æ®Šæƒ…å†µ] 12345678910111213141516/************************* 1ä½BCDè®¡æ•°å™¨ï¼Œå¤ä½åˆ°2ï¼›å®ç°0-9çš„å¾ªç¯ *************************//************** ä¸ªä½ä¸º2æ—¶ï¼šå½“é«˜ä½ä¸º1ï¼Œä¸‹ä¸€æ¬¡åº”è¯¥æ˜¯1ï¼›ä½†æ˜¯å½“é«˜ä½ä¸º0ï¼Œä¸‹ä¸€æ¬¡ä¸º3 **************/module bcdreset2 ( input clk, input reset, // Synchronous active-high reset input flag, // æŒ‡ç¤ºå½“å‰ä¸ºç‰¹æ®Šæƒ…å†µï¼Œå³ä¸º12çš„æ—¶å€™ input enable, output [3:0] q); always @ (posedge clk) begin if(reset) q &lt;= 4'h2; else if(!enable) q &lt;= q; else if(flag) q &lt;= 4'h1; // ç‰¹æ®Šæƒ…å†µ else if(q == 4'h9) q &lt;= 4'h0; else q &lt;= q + 4'h1; endendmodule å¤ä½åˆ°1ï¼šä¸ºå°æ—¶é«˜ä½æœåŠ¡(x-&gt;1)[â­æ­¤å¤„æœ‰ç‰¹æ®Šæƒ…å†µ] 12345678910111213/*********** 1ä½BCDè®¡æ•°å™¨ï¼Œå¤ä½åˆ°2ï¼›å®ç°0-1çš„å¾ªç¯ *************//*********** æ¯æ¬¡ä½¿èƒ½åˆ°æ¥ï¼Œå°æ—¶é«˜ä½è¦ä¹ˆä»0-&gt;1ï¼›è¦ä¹ˆä»1-&gt;0;é€»è¾‘å¯¹åº”ä»£ç ç¬¬11è¡Œ***********/module bcd_zero_one( input clk, input reset, input enable, output [3:0] q); always @ (posedge clk) begin if (reset) q &lt;= 4'h1; // (å¤ä½ä¸º12ï¼› é«˜ä½ä¸º1ï¼‰ else if (!enable) q &lt;= q; else q[0] &lt;= ~q[0]; // 0å˜ä¸º1ï¼Œ1å˜ä¸º0(0000-&gt;0001) endendmodule â‘¡ ä¸¤ä½BCDè®¡æ•°å™¨ ç§’ï¼Œåˆ†é’Ÿè®¡æ•°å™¨ï¼šå®ç°0-59å¾ªç¯ï¼›å¤ä½ä¸º0 12345678910111213/**************** ä¸¤ä½BCD(8-bit)æ•°è¡¨ç¤º0-59 ;å¾ªç¯åˆ°59æ—¶èƒ½ä¸èƒ½ä¸‹ä¸€ä¸ªè®¡æ•°åˆ°0 **************/module zero2fifty_nine( input clk, input reset, input ena, output [7:0] ss); wire ena_ten, reset_ten; assign reset_ten = (((ss == 8'h59) &amp; ena) | reset)? 1'd1:1'd0;â­// å½“è®¡æ•°åˆ°59ä¸”ä¸‹ä¸€ä¸ªä½¿èƒ½åˆ°æ¥æ—¶ï¼ŒæŠŠé«˜ä½ç½®ä¸ºåˆ°0ï¼›å› ä¸ºä½ä½è‚¯å®šå›åˆ°0;å¦‚æœä¸resetï¼Œé‚£ä¹ˆè‚¯å®šä¸º60 assign ena_ten = ((ss[3:0] == 4'h9) &amp; ena)?1'd1:1'd0; â­ // ä¸ªä½åˆ°9(é‡ç‚¹:å¿…é¡»ä½¿èƒ½åˆ°æ¥)æ‰èƒ½ä½¿èƒ½åä½(å‡è®¾ç°åœ¨ä¸º29åˆ†:00ç§’,åˆ†é’Ÿçš„åä½ä½¿èƒ½å¿…é¡»åœ¨60såæ‰ä¼šåˆ°æ¥;ä½†æ˜¯ä¸å¹¶ä¸Šä½¿èƒ½,é‚£ä¹ˆä¸‹ä¸€ç§’å°†æ˜¯39åˆ†:01ç§’ decade_counter one (clk, reset, ena, ss[3:0]); // 4ä½äºŒè¿›åˆ¶è¡¨ç¤ºä¸ªä½çš„0-9 decade_counter ten (clk, reset_ten, ena_ten, ss[7:4]); // 4ä½äºŒè¿›åˆ¶è¡¨ç¤ºåä½çš„0-9endmodule å°æ—¶è®¡æ•°å™¨ï¼šå®ç°1-12å¾ªç¯ï¼Œå¤ä½ä¸º12 12345678910111213/************* ä¸¤ä½BCD(8-bit)æ•°è¡¨ç¤º1-12;å¾ªç¯åˆ°12æ—¶èƒ½ä¸èƒ½ä¸‹ä¸€ä¸ªè®¡æ•°åˆ°1 ***************//* â­(flag12) å°æ—¶ä¸ªä½ä¸º2æ—¶ï¼šå½“é«˜ä½ä¸º1(12)ï¼Œä¸‹ä¸€æ¬¡åº”è¯¥æ˜¯1ï¼›ä½†æ˜¯å½“é«˜ä½ä¸º0(02)ï¼Œä¸‹ä¸€æ¬¡ä¸º3 */module one2twelve( input clk, input reset, input ena, output [7:0] hh); wire ena_ten, flag12; assign ena_ten = (ena &amp; ((hh == 8'h9)|(hh == 8'h12)))? 1'd1:1'd0; // å°æ—¶é«˜ä½çš„æ”¹å˜ä¿¡å·(09-&gt;10;12-&gt;01) assign flag12 = (hh == 8'h12); // æŒ‡ç¤ºå½“å‰ä¸º12 BCDreset2 one (clk, reset, flag12, ena, hh[3:0]); // 4ä½äºŒè¿›åˆ¶è¡¨ç¤ºä¸ªä½çš„0-9 BCDzero_one ten (clk, reset, ena_ten, hh[7:4]); // 4ä½äºŒè¿›åˆ¶è¡¨ç¤ºåä½çš„0-1endmodule â‘¢ å®ä¾‹åŒ–ä¸‰ä¸ªâ‘¡ 123456789101112131415161718192021module top_module( input clk, input reset, input ena, output pm, output [7:0] hh, output [7:0] mm, output [7:0] ss); wire ena_hr, ena_min, ena_pm; one2twelve hour (clk, reset, ena_hr, hh); zero2fifty_nine minite(clk, reset, ena_min, mm); zero2fifty_nine second(clk, reset, ena, ss); assign ena_min = (ss==8'h59)?1'd1:1'd0; // å½“59sæ—¶æ‰ä½¿èƒ½åˆ†é’Ÿè®¡æ•°å™¨; assign ena_hr = ((mm == 8'h59) &amp; (ss == 8'h59))? 1'd1: 1'd0; // å½“59åˆ†59sæ‰ä½¿èƒ½å°æ—¶è®¡æ•°å™¨ assign ena_pm = ena_hr &amp; (hh == 8'h11); // å½“11æ—¶59åˆ†59sæ‰èƒ½æ”¹å˜pmâ­ always @ (posedge clk) begin if (reset) pm &lt;= 1'd0; else if(ena_pm) pm &lt;= ~pm; // æ¯å½“æ—¶é’Ÿè½¬åˆ°11:59:59pméƒ½ä¼šå˜æ¢ä¸€æ¬¡ else pm &lt;= pm; endendmodule","categories":[{"name":"Digital IC","slug":"Digital-IC","permalink":"https://www.beenli.cn/categories/Digital-IC/"},{"name":"HDL Bits","slug":"Digital-IC/HDL-Bits","permalink":"https://www.beenli.cn/categories/Digital-IC/HDL-Bits/"}],"tags":[{"name":"circuits","slug":"circuits","permalink":"https://www.beenli.cn/tags/circuits/"}]},{"title":"From 1000Hz clock to 1Hz--OneHertz","slug":"From-1000Hz-clock-to-1Hz-OneHertz","date":"2020-10-03T06:47:49.000Z","updated":"2020-10-06T01:20:58.342Z","comments":true,"path":"posts/8cdff568/","link":"","permalink":"https://www.beenli.cn/posts/8cdff568/","excerpt":"","text":"problem linkï¼šhttps://hdlbits.01xz.net/wiki/Exams/ece241_2014_q7b Background ä»é¢‘ç‡ä¸º1000Hzçš„æ—¶é’Ÿä¸­å¾—åˆ°é¢‘ç‡ä¸º1Hzçš„ä¿¡å·(OneHertz)ï¼Œå®ƒç”¨æ¥é©±åŠ¨ä¸€ç³»åˆ—æ—¶/åˆ†/ç§’è®¡æ•°å™¨çš„ä½¿èƒ½ä¿¡å·(Enable signal)ä»¥æ­¤åˆ›å»ºä¸€ä¸ªæ•°å­—æ—¶é’Ÿå¢™(digital wall clock)ã€‚å› ä¸ºéœ€è¦æ—¶é’Ÿæ¯ç§’è®¡æ•°ä¸€æ¬¡ï¼ŒOneHertzä¿¡å·å¿…é¡»æ¯ç§’å‡†ç¡®åœ°æ–­è¨€ä¸€ä¸ªå‘¨æœŸ(å‘¨æœŸä¸º1ç§’ï¼Œä¸”æ¯å‘¨æœŸåªèƒ½ç¿»è½¬ä¸€æ¬¡)ã€‚ Problem Description ç”¨BCDè®¡æ•°å™¨å’Œå°‘è®¸å…¶å®ƒçš„é—¨æ„å»ºåˆ†é¢‘å™¨(frequency divider)ã€‚å¹¶ä¸”è¾“å‡ºä½ æ‰€ä½¿ç”¨çš„BCDè®¡æ•°å™¨çš„ä½¿èƒ½ä¿¡å·ã€‚(c_enable[0] for the fastest counter, c_enable[2] for the slowest) å¦‚ä¸‹çš„BCDè®¡æ•°å™¨å·²ç»æä¾›ç»™ä½ ï¼ŒEnableä¸ºé«˜ç”µå¹³è®¡æ•°å™¨æ‰èƒ½æ­£å¸¸å·¥ä½œï¼ŒResetä¸ºåŒæ­¥é«˜ç”µå¹³ç½®ä½0ï¼›123456module bcdcount ( input clk, input reset, input enable, output reg [3:0] Q);ä½ è®¾è®¡çš„ç”µè·¯ä¸­æ‰€æœ‰çš„è®¡æ•°å™¨å¿…é¡»ç›´æ¥ä½¿ç”¨ç›¸åŒçš„1000Hzæ—¶é’Ÿä¿¡å·ã€‚ Template1234567module top_module ( input clk, input reset, output OneHertz, output [2:0] c_enable); First Tryanswer12345678910111213141516module top_module ( input clk, input reset, output OneHertz, output [2:0] c_enable); reg [3:0] Q0,Q1,Q2; /************ BCDåè¿›åˆ¶,å½“Q=1001æ—¶ä½¿èƒ½--&gt;åå€é¢‘ ***************/ assign c_enable[0] = 1'b1; // è®©ç¬¬ä¸€ä¸ªè®¡æ•°å™¨å…¨é€Ÿè®¡æ•° assign c_enable[1] = Q0[3] &amp; Q0[0]; // ç¬¬äºŒè®¡æ•°å™¨è®¡æ•°å‘¨æœŸæ˜¯ç¬¬ä¸€ä¸ªçš„10å€ assign c_enable[2] = Q1[3] &amp; Q1[0]; // ç¬¬äºŒè®¡æ•°å™¨è®¡æ•°å‘¨æœŸæ˜¯ç¬¬äºŒä¸ªçš„10å€ assign OneHertz = Q2[3] &amp; Q2[0]; bcdcount counter0 (clk, reset, c_enable[0], Q0); bcdcount counter1 (clk, reset, c_enable[1], Q1); bcdcount counter2 (clk, reset, c_enable[2], Q2);endmodule resultâŒ åœ¨è®¡æ•°0-10çš„æ—¶å€™æ˜¯æ­£ç¡®çš„ åœ¨è®¡æ•°90-99çš„æ—¶å€™: c_enable[2]æœ¬è¯¥ä¸º0å´å˜ä¸ºäº†1ï¼Œå¯¼è‡´è¾“å‡ºc_enable=5=3â€™b101; ç”±äºc_enable[2]=Q1[3] &amp; Q1[0]ï¼Œèµ·åˆæˆ‘è®¤ä¸ºæ˜¯Q1æœ‰é—®é¢˜ï¼›åç»­ç”»å‡ºå¦‚ä¸‹è‰å›¾å‘ç°è¿˜æ˜¯c_enableæœ‰é—®é¢˜ ç”±äºQ1æ˜¯ç”±è®¡æ•°å™¨ç”Ÿæˆçš„ï¼Œåªè¦ä½¿èƒ½ä¿¡å·æ²¡é—®é¢˜ï¼Œé‚£ä¹ˆå®ƒå°±è¿˜ğŸ†— åˆç”±äºä½¿èƒ½ä¿¡å·1å’Œ2æ˜¯æˆ‘ä»¬å®šä¹‰ï¼Œæ‰€ä»¥ä»è¿™é‡Œä¸‹æ‰‹è§£å†³é—®é¢˜æ¯”è¾ƒæ–¹ä¾¿ï¼› ç”±ä¸Šå›¾çŸ¥ä½¿èƒ½ä¿¡å·2æœ‰é—®é¢˜ï¼Œå®ƒåœ¨è®¡æ•°90-99æœŸé—´ä¸€ç›´ä¸ºé«˜ç”µå¹³ï¼Œæˆ‘ä»¬åªå¸Œæœ›å…¶åœ¨99æ—¶ä¸ºé«˜ç”µå¹³ã€‚ æ‰€æœ‰ä¿®æ”¹ä½¿èƒ½2çš„èµ‹å€¼ï¼šc_enable[2] = Q1[3] &amp; Q1[0] &amp; c_enable[1] åŒç†æˆ‘ä»¬ä¹Ÿè¦ä¿®æ”¹OneHertz = Q2[3] &amp; Q2[0] &amp; c_enable[2];ï¼Œè®©å…¶åªåœ¨999æ—¶æ‰æœ‰æ•ˆï¼›å¦åˆ™å…¶åœ¨900-999ä¸€ç›´æœ‰æ•ˆï¼› Final answer123456789101112131415module top_module ( input clk, input reset, output OneHertz, output [2:0] c_enable); // reg [3:0] Q0,Q1,Q2; assign c_enable[0] = 1'b1; assign c_enable[1] = Q0[3] &amp; Q0[0]; assign c_enable[2] = Q1[3] &amp; Q1[0] &amp; c_enable[1]; assign OneHertz = Q2[3] &amp; Q2[0] &amp; c_enable[2]; bcdcount counter0 (clk, reset, c_enable[0], Q0); bcdcount counter1 (clk, reset, c_enable[1], Q1); bcdcount counter2 (clk, reset, c_enable[2], Q2);endmodule Advanced problem(â“)â­å¦‚ä½•å®ç°50%(xx%)å ç©ºæ¯”çš„10(xx)å€é¢‘ç”µè·¯","categories":[{"name":"Digital IC","slug":"Digital-IC","permalink":"https://www.beenli.cn/categories/Digital-IC/"},{"name":"HDL Bits","slug":"Digital-IC/HDL-Bits","permalink":"https://www.beenli.cn/categories/Digital-IC/HDL-Bits/"}],"tags":[{"name":"circuits","slug":"circuits","permalink":"https://www.beenli.cn/tags/circuits/"}]},{"title":"Unprivileged Spec(1)--RV32I","slug":"RISC-V-ISA-Unprivileged-Specification-1-RV32I","date":"2020-09-30T01:01:08.000Z","updated":"2020-09-30T12:18:10.086Z","comments":true,"path":"posts/6c2bdcd1/","link":"","permalink":"https://www.beenli.cn/posts/6c2bdcd1/","excerpt":"","text":"RV32I Base Integer Instruction Set 1 Preface RV32Iæ˜¯ä¸ºäº†è¶³å¤Ÿæˆä¸ºç¼–è¯‘å™¨ç›®æ ‡å¹¶èƒ½æ”¯æŒç°ä»£æ“ä½œç³»ç»Ÿç¯å¢ƒè€Œè®¾è®¡çš„ä¸€ä¸ªåŸºæœ¬æ•´æ•°æŒ‡ä»¤é›†ã€‚å®ƒä¹Ÿä¸ºäº†å‡å°‘ç¡¬ä»¶å®ç°çš„æœ€å°éœ€æ±‚è€Œè®¾è®¡ã€‚RV32IåŒ…å«40ä¸ªç‹¬ç«‹çš„æŒ‡ä»¤ï¼Œå°½ç®¡ä¸€äº›ç®€å•çš„å®ç°å¯èƒ½ç”¨å•ä¸€çš„ç³»ç»Ÿç¡¬ä»¶æŒ‡ä»¤ï¼ˆa single SYSTEM hardware instruction)ä»£æ›¿ECALL/EBREAKæŒ‡ä»¤ï¼Œå®ƒæ€»æ˜¯æ•è·å¼‚å¸¸(always traps)å¹¶ä¸”å¯èƒ½å°†FENCEæŒ‡ä»¤å®ç°ä¸ºNOPï¼Œä»¥å‡å°‘æŒ‡ä»¤æ•°åˆ°38ä¸ªã€‚RV32Ièƒ½å¤Ÿæ¨¡æ‹Ÿå‡ ä¹ä»»ä½•çš„ISAæ‰©å±•ï¼ˆé™¤äº†Aæ‰©å±•ï¼Œå®ƒéœ€è¦é¢å¤–ç¡¬ä»¶æ”¯æŒåŸå­æ“ä½œ(atomicityï¼‰ åœ¨å®è·µä¸­ï¼ŒåŒ…å«æœºå™¨æ¨¡å¼ç‰¹æƒæ¶æ„çš„ç¡¬ä»¶å®ç°å°†éœ€è¦9ä¸ªCSRæŒ‡ä»¤ã€‚ åŸºæœ¬æ•´æ•°æŒ‡ä»¤é›†çš„å­é›†ä¹Ÿè®¸å¯¹äºæ•™å­¦ç›®çš„å¾ˆæœ‰ç”¨(pedagogical purposes), ä½†æ˜¯åŸºç¡€å·²ç»è¢«å®šä¹‰ï¼Œå¯¹å®ç°å…¶å­é›†çš„çœŸæ­£çš„ç¡¬ä»¶é™¤äº†å¿½ç•¥éå¯¹é½å†…å­˜è®¿é—®å¹¶æŠŠæ‰€æœ‰çš„SYSTEM instructionè§†ä¸ºå•ä¸€çš„å¼‚å¸¸(single trap)ï¼Œæˆ‘ä»¬ä¸åº”è¯¥æœ‰ä»€ä¹ˆå…¶å®ƒçš„åŠ¨æœºã€‚ å…³äºRV32Içš„å¤§å¤šæ³¨é‡Šä¹Ÿé€‚ç”¨äºRV64I baseã€‚ 2 Programmerâ€™s Model å¯¹äºRV32Iéç‰¹æƒçŠ¶æ€ä¸€å…±æœ‰32ä¸ªå¯„å­˜å™¨(éƒ½æ˜¯32ä½å®½ï¼Œi.e. ,XLEN=32)ï¼šx0~x31;x0è¢«ç¡¬ç¼–ç åˆ°0ã€‚å¦å¤–31ä¸ªå¯„å­˜å™¨ä¿å­˜çš„å€¼å¯ä»¥è¢«è§£é‡Šä¸ºï¼šâ… ã€å¸ƒå°”å€¼çš„é›†åˆï¼Œâ…¡ã€è¡¥ç çš„æœ‰ç¬¦å·äºŒè¿›åˆ¶æ•´æ•°ï¼Œâ…¢ã€æ— ç¬¦å·äºŒè¿›åˆ¶æ•´æ•° æœ‰ä¸€ä¸ªé¢å¤–çš„éç‰¹æƒå¯„å­˜å™¨ï¼Œpc(program counter)ï¼šä¿å­˜å½“å‰æŒ‡ä»¤çš„åœ°å€ åœ¨Base Integer ISAä¸­ï¼Œæ²¡æœ‰æŒ‡å®šçš„æ ˆæŒ‡é’ˆæˆ–è€…å­ä¾‹ç¨‹è¿”å›åœ°å€é“¾æ¥å¯„å­˜å™¨(link register)ï¼›æŒ‡ä»¤ç¼–ç å…è®¸ä»»ä½•å¯„å­˜å™¨è¢«ç”¨äºè¿™ä¸ªç›®çš„ï¼›ä½†æ˜¯ï¼Œæ ‡å‡†è½¯ä»¶è°ƒç”¨æƒ¯ä¾‹(calling convention)ä½¿ç”¨å¯„å­˜å™¨x1ä¿å­˜è°ƒç”¨çš„è¿”å›åœ°å€ï¼Œx5ä½œä¸ºå¤‡ç”¨é“¾æ¥å¯„å­˜å™¨ã€‚æ ‡å‡†è°ƒç”¨ä¾‹ç¨‹ä½¿ç”¨x2ä½œä¸ºæ ˆæŒ‡é’ˆ(stack pointer) ç¡¬ä»¶å¯ä»¥ä½¿ç”¨x1æˆ–x2æ¥åŠ é€Ÿå‡½æ•°è°ƒç”¨å’Œè¿”å›(å› ä¸ºå¯ä»¥å°½æ—©è§£ç )ï¼›è¯¦æƒ…è§JALå’ŒJALRæŒ‡ä»¤ å¯é€‰çš„å‹ç¼©16-bitæŒ‡ä»¤æ ¼å¼åŸºäºè¿™æ ·çš„å‡è®¾è®¾è®¡çš„ï¼šx1ï¼šè¿”å›åœ°å€å¯„å­˜å™¨ï¼›x2:æ ˆæŒ‡é’ˆã€‚ä½¿ç”¨å…¶ä»–çº¦å®šçš„è½¯ä»¶å°†æ­£å¸¸è¿è¡Œï¼Œä½†å¯èƒ½æœ‰è¾ƒå¤§çš„ä»£ç å¤§å°ã€‚ notesï¼š å¯ç”¨æ¶æ„å¯„å­˜å™¨(available architectural registers)çš„æ•°é‡èƒ½å¤Ÿå¯¹ä»£ç å¤§å°ï¼Œæ€§èƒ½ï¼Œèƒ½è€—äº§ç”Ÿé‡å¤§å½±å“ã€‚å°½ç®¡16ä¸ªå¯„å­˜å™¨å¯¹äºè¿è¡Œç¼–è¯‘ä»£ç çš„æ•´æ•°ISAæ¥è¯´æ˜¯è¶³å¤Ÿçš„ï¼Œä½†æ˜¯åœ¨é•¿åº¦ä¸º16ä½ä½¿ç”¨3-addressæ ¼å¼çš„æŒ‡ä»¤ä¸­ç¼–ç æ‹¥æœ‰16ä¸ªå¯„å­˜å™¨å®Œæ•´çš„ISAæ˜¯ä¸å¯èƒ½çš„ã€‚(â­PS:16ä¸ªå¯„å­˜å™¨ï¼Œaddressè‡³å°‘4ä½ï¼Œä¸‰åœ°å€å°±12ä½ï¼Œé‚£ä¹ˆåªå‰©ä¸‹4ä½åŒºåˆ†ä¸åŒçš„æŒ‡ä»¤äº†,å³æœ€å¤š16æ¡ä¸åŒçš„æŒ‡ä»¤)ã€‚ å°½ç®¡2-addressæ˜¯å¯èƒ½çš„ã€‚ä½†å®ƒå¢åŠ æŒ‡ä»¤æ¡æ•°å¹¶ä¸”é™ä½æ•ˆç‡ã€‚æˆ‘ä»¬æƒ³è¦é¿å…ç«‹å³æ•°æŒ‡ä»¤çš„å¤§å°æ¥ç®€åŒ–ç¡¬ä»¶å®ç°ï¼Œä¸€æ—¦32-bitçš„æŒ‡ä»¤å¤§å°è¢«é‡‡ç”¨ï¼Œæ”¯æŒ32ä¸ªæ•´æ•°å¯„å­˜å™¨å°±å¾ˆæ˜¾è€Œæ˜“è§äº†ã€‚ä¸€ä¸ªæ›´å¤§æ•°é‡çš„æ•´æ•°å¯„å­˜å™¨ä¹Ÿæœ‰åŠ©äºæé«˜é«˜æ€§èƒ½ä»£ç çš„æ€§èƒ½ï¼Œå¯å¹¿æ³›ä½¿ç”¨å¾ªç¯å±•å¼€ï¼ˆloop unrolling)ã€è½¯ä»¶æµæ°´çº¿(software pipelining)å’Œç¼“å­˜å¹³é“º(cache tiling)ã€‚â“ åŸºäºä¸Šé¢è¿™äº›åŸå› ï¼Œæˆ‘ä»¬ä¸ºåŸºç¡€ISAé€‰æ‹©äº†ä¸€ä¸ªå¸¸è§„å¤§å°ï¼ˆconventional size)â€”â€”32ä¸ªæ•´æ•°å¯„å­˜å™¨ã€‚åŠ¨æ€å¯„å­˜å™¨ä½¿ç”¨è¶‹å‘äºè¢«ä¸€äº›ç»å¸¸è®¿é—®çš„å¯„å­˜å™¨ä¸»å®°ï¼Œå¹¶ä¸”regfile(å¯„å­˜å™¨å †)çš„å®ç°å¯è¢«ä¼˜åŒ–ä»¥å‡å°‘é¢‘ç¹è®¿é—®å¯„å­˜å™¨çš„è®¿é—®èƒ½é‡(access energy)ã€‚ å¯é€‰çš„16ä½å‹ç¼©æŒ‡ä»¤æ ¼å¼ç»å¤§éƒ¨åˆ†åªä½¿ç”¨8ä¸ªå¯„å­˜å™¨ï¼Œå› æ­¤èƒ½æä¾›ç¨ å¯†çš„æŒ‡ä»¤ç¼–ç (dense instruction encoding),ä½†æ˜¯å¦‚æœæƒ³è¦çš„è¯ï¼Œé¢å¤–çš„æŒ‡ä»¤é›†æ‰©å±•èƒ½æ”¯æŒæ›´å¤§çš„å¯„å­˜å™¨ç©ºé—´(è¦ä¹ˆæ‰å¹³çš„è¦ä¹ˆåˆ†å±‚æ¬¡çš„)ã€‚ 3 Base Instruction Formats æœ‰4ç§æ ¸å¿ƒçš„æŒ‡ä»¤æ ¼å¼ï¼šR/I/S/Uã€‚æŒ‡ä»¤é•¿åº¦éƒ½æ˜¯32ä½ï¼Œå¹¶ä¸”å¿…é¡»åœ¨å†…å­˜ä¸­ä»¥4å­—èŠ‚ä¸ºè¾¹ç•Œå¯¹é½ã€‚æŒ‡ä»¤åœ°å€éå¯¹é½çš„å¼‚å¸¸ï¼Œå¸¸å¸¸æ˜¯ç”±äºåˆ†æ”¯çš„å‘ç”Ÿ(taken branch)æˆ–è€…éæ¡ä»¶è·³è½¬çš„ç›®æ ‡åœ°å€ä¸æ˜¯4å­—èŠ‚å¯¹é½ã€‚ å¯¹äºè§£ç ä¸€ä¸ªä¿ç•™æŒ‡ä»¤çš„è¡Œä¸ºæ˜¯æ²¡æœ‰è§„å®šçš„(unspecified) RISC-V ISAä¿æŒæºå¯„å­˜å™¨(rs1å’Œrs2)å’Œç›®æ ‡å¯„å­˜å™¨(rd)çš„ä½ç½®åœ¨æ‰€æœ‰æŒ‡ä»¤æ ¼å¼ä¸­ç›¸åŒä»¥ç®€åŒ–è§£ç ã€‚é™¤äº†ä½¿ç”¨åœ¨CSRæŒ‡ä»¤ä¸­çš„5bitçš„ç«‹å³æ•°ï¼Œç«‹å³æ•°æ€»æ˜¯sign-extendedï¼Œé€šå¸¸æ˜¯æ‰“åŒ…åˆ°æŒ‡ä»¤ä¸­æœ€å·¦è¾¹çš„å¯ç”¨ä½ï¼Œè¿™æ ·åˆ†é…ä»¥å‡å°‘ç¡¬ä»¶çš„å¤æ‚ç¨‹åº¦ã€‚ç‰¹åˆ«æ˜¯ï¼Œå¯¹äºæ‰€æœ‰ç«‹å³æ•°çš„ç¬¦å·ä½æ€»æ˜¯åœ¨æœ€é«˜ä½(ä¹Ÿå°±æ˜¯Ins[31])æ¥åŠ é€Ÿç¬¦å·æ‰©å±•ç”µè·¯ã€‚ imm[x]æŒ‡çš„æ˜¯å½“å‰ä½åœ¨æ‰©å±•æˆ32ä½ç«‹å³æ•°ä¸­çš„ä½ç½® å®é™…åº”ç”¨ä¸­ï¼Œå¤§éƒ¨åˆ†ç«‹å³æ•°è¦ä¹ˆå¾ˆå°ï¼Œè¦ä¹ˆéœ€è¦æ‰€æœ‰çš„ä½æ•°(XLEN bits)ã€‚æˆ‘ä»¬é€‰æ‹©éå¯¹ç§°ç«‹å³æ•°åˆ†å‰²ï¼šå¸¸è§„æŒ‡ä»¤ä¸­ç«‹å³æ•°å 12bits;ç‰¹æ®Šçš„ load-upper-immediate æŒ‡ä»¤ä¸­ç«‹å³æ•°å 20bitsã€‚è¿™æ ·åšæ˜¯ä¸ºäº†ç»™å¸¸è§„æŒ‡ä»¤æ›´å¤šçš„opcodeç©ºé—´ã€‚ 4 Immediate Encoding æŒ‡ä»¤æ ¼å¼è¿˜æœ‰ä¸¤ä¸ªå˜ç§(variants)ï¼šB/Jï¼Œå®ƒä»¬åŸºäºç«‹å³æ•°çš„å¤„ç†è¡ç”Ÿå‡ºæ¥ã€‚ Så’ŒBä»…æœ‰çš„åŒºåˆ«ï¼šåœ¨Bæ ¼å¼ä¸­12bitç«‹å³æ•°åŸŸä¹˜ä»¥2ç”¨äºç¼–ç åˆ†æ”¯åç§»ã€‚è€Œä¸æ˜¯åƒä¼ ç»Ÿåšæ³•é‚£æ ·ï¼Œå°†æŒ‡ä»¤ç¼–ç ä¸­çš„æ‰€æœ‰ç«‹å³æ•°ä½ç”¨ç¡¬ä»¶å·¦ç§»ä¸€ä½,ä¸­é—´çš„ä½æ•°(imm[10:1])å’Œç¬¦å·ä½ä¿ç•™åœ¨å›ºå®šä½ç½®ï¼Œè€ŒSæ ¼å¼ä¸­çš„æœ€ä½ä½(inst[7])åœ¨Bæ ¼å¼ä¸­ç¼–ç ä¸€ä¸ªé«˜é˜¶ä½ã€‚ Uå’ŒJçš„ä»…æœ‰åŒºåˆ«ï¼šUè¦å‘å·¦ç§»12ä½ï¼›è€ŒJåªç”¨ç§»åŠ¨1ä½ã€‚åœ¨Uå’ŒJæŒ‡ä»¤ç«‹å³æ•°ä¸­æŒ‡ä»¤çš„ä½ç½®å°½é‡è·Ÿå…¶ä»–æ ¼å¼çš„æŒ‡ä»¤æˆ–è€…å®ƒä»¬äº’ç›¸é‡å ã€‚ 5 Computational å¤§å¤šæ•°çš„æ•´æ•°ç®—æœ¯æŒ‡ä»¤(Integer computational instruction)å¯¹ä¿å­˜åœ¨æ•´æ•°å¯„å­˜å™¨ä¸­çš„XLENä½çš„å€¼è¿›è¡Œæ“ä½œã€‚æ•´æ•°è®¡ç®—æŒ‡ä»¤è¦ä¹ˆè¢«ç¼–ç ä¸ºä½¿ç”¨Iæ ¼å¼çš„å¯„å­˜å™¨-ç«‹å³æ•°æ“ä½œï¼›è¦ä¹ˆä½¿ç”¨Ræ ¼å¼çš„å¯„å­˜å™¨-å¯„å­˜å™¨æ“ä½œã€‚å¯¹äºè¿™ä¸¤ç§ç±»å‹æŒ‡ä»¤çš„ç›®çš„å¯„å­˜å™¨éƒ½æ˜¯rdã€‚æ²¡æœ‰æ•´å‹è®¡ç®—æŒ‡ä»¤ä¼šå¯¼è‡´ç®—æœ¯å¼‚å¸¸ åŸºæœ¬æŒ‡ä»¤é›†ä¸åŒ…æ‹¬å¯¹æ•´æ•°ç®—æœ¯è¿ç®—ä¸Šåšæº¢å‡ºæ£€æŸ¥(overflow checks)æ”¯æŒçš„ç‰¹æ®ŠæŒ‡ä»¤é›†ã€‚å› ä¸ºè®¸å¤šæº¢å‡ºæ£€æŸ¥èƒ½å¤Ÿæ›´ä¾¿å®œåœ°(cheaply)ä½¿ç”¨RISC-Våˆ†æ”¯æ¥å®ç° å¯¹æ— ç¬¦å·åŠ æ³•çš„æº¢å‡ºæ£€æŸ¥ä»…ä»…éœ€è¦åœ¨åŠ æ³•æŒ‡ä»¤ååŠ ä¸Šä¸€æ¡é¢å¤–çš„åˆ†æ”¯æŒ‡ä»¤ 12add t0,t1,t2blut t0, t1, overflow å¯¹äºæœ‰ç¬¦å·åŠ æ³•ï¼šå¦‚æœä¸€ä¸ªæ“ä½œæ•°çš„ç¬¦å·å·²çŸ¥ï¼Œæº¢å‡ºæ£€æŸ¥ä»…éœ€è¦åŠ æ³•ä¹‹åçš„ä¸€ä¸ªåˆ†æ”¯ï¼ˆè¦†ç›–äº†å¸¦æœ‰ç«‹å³æ•°æ“ä½œæ•°çš„å¸¸è§åŠ æ³•æƒ…å½¢ï¼‰ 12addi t0, t1, +immblt t0, t1, overflow å¯¹äºå¸¸è§„çš„æœ‰ç¬¦å·åŠ æ³•ï¼ŒåŠ æ³•ä¹‹åéœ€è¦ä¸‰æ¡é¢å¤–çš„æŒ‡ä»¤ã€‚åˆ©ç”¨å½“ä¸”ä»…å½“å¦ä¸€ä¸ªæ“ä½œæ•°ä¸ºè´Ÿæ—¶ï¼Œè¯¥å’Œåº”å°äºå…¶ä¸­ä¸€ä¸ªæ“ä½œæ•°çš„è§‚å¯Ÿã€‚ 1234add t0, t1, t2slti t3, t2, 0slt t4, t0, t1bne t3, t4, overflow åœ¨RV64Iä¸­ï¼Œ32ä½æœ‰ç¬¦å·çš„åŠ æ³•æº¢å‡ºå¯ä»¥é€šè¿‡æ¯”è¾ƒADDå’ŒADDWæ“ä½œçš„ç»“æœæ¥è¿›ä¸€æ­¥ä¼˜åŒ–ã€‚(ADDWè‚¯å®šä¸ä¼šæº¢å‡º) Register-Immediate ADDIï¼šå°†12ä½ç«‹å³æ•°ç¬¦å·æ‰©å±•åä¸rs1ä¸­çš„å€¼ç›¸åŠ ï¼Œç®—æœ¯æº¢å‡ºå¿½ç•¥ï¼Œç»“æœçš„ä½32ä½å­˜åˆ°rdå¯„å­˜å™¨ä¸­ã€‚ 123/* ä¸¤æ¡æŒ‡ä»¤ç­‰æ•ˆ */ADDI rd, rs1, 0MV rd , rs1(æ±‡ç¼–ä¼ªæŒ‡ä»¤ï¼šå°†rs1ä¸­çš„å€¼å¤åˆ¶ç»™rd) SLTI(set less than immediate): å½“å¯„å­˜å™¨rs1ä¸­çš„å€¼å°äºç«‹å³æ•°ï¼ˆä¿©è€…éƒ½è§†ä¸ºæœ‰ç¬¦å·æ•°)ï¼Œå°†å¯„å­˜å™¨rdç½®ä¸º1ï¼›å¦åˆ™ç½®0ã€‚SLTIU: åŠŸèƒ½ä¸€æ ·ï¼Œä½†æ˜¯æŠŠæ¯”è¾ƒçš„å¯¹è±¡è§†ä¸ºæ— ç¬¦å·æ•°ã€‚ 123/* ä¸¤æ¡æŒ‡ä»¤ç­‰æ•ˆ */SLTIU rd, rs1, 1(å½“rs1ç­‰äº0,rdä¸º1,å¦åˆ™ä¸º0)SEQZ rd, rs ANDI, ORI, XORI: ä¸‰ä¸ªé€»è¾‘è¿ç®—ç¬¦ï¼Œåˆ†åˆ«å¯¹rs1å’Œç«‹å³æ•°æ‰§è¡ŒæŒ‰ä½(bitwise)çš„ä¸ï¼Œæˆ–ï¼Œå¼‚æˆ–è¿ç®—ã€‚ 123/* ä¸¤æ¡æŒ‡ä»¤ç­‰æ•ˆ */XORI rd, rs1, -1(-1çš„è¡¥ç ä¸ºå…¨1)NOT rd, rs(å°†rså„ä½å–åèµ‹å€¼ç»™rd) ç§»ä½è¢«ç¼–ç ä¸€ç§ç‰¹æ®Šçš„Iç±»å‹æŒ‡ä»¤æ ¼å¼ã€‚ è¢«ç§»ä½çš„æ“ä½œæ•°ä¸ºrs1ï¼›ç§»ä½çš„ä½æ•°è¢«ç¼–ç åœ¨ç«‹å³æ•°åŸŸçš„ä½äº”ä½ä¸Šã€‚ ğŸ‘‰ç§»ç±»å‹è¢«ç¼–ç åœ¨ç¬¬30ä½ä¸Šï¼› SLLI(shift left logical)ï¼š0è¢«ç§»åŠ¨åˆ°ä½ä½ SRLI: 0è¢«ç§»åŠ¨åˆ°é«˜ä½ SRAI: (shift right arithmetic): åŸç¬¦å·ä½å¤åˆ¶åˆ°ç©ºå‡ºçš„é«˜ä½ LUI(load upper immediate): ç”¨äºæ„å»º32ä½å¸¸æ•°å¹¶ä½¿ç”¨Uæ ¼å¼æŒ‡ä»¤ã€‚æŠŠU-immediateçš„å€¼æ”¾åœ¨ç›®çš„å¯„å­˜å™¨çš„é«˜20ä½ï¼Œå…¶å®ƒä½ä½ç”¨0å¡«å……ã€‚ AUIPC(add upper immediate to pc)ï¼šç”¨äºæ„å»ºä¸pcç›¸å…³çš„åœ°å€ï¼Œå¹¶ä½¿ç”¨Uæ ¼å¼æŒ‡ä»¤ã€‚å½¢æˆ32ä½çš„åç§»(é«˜20ä½æ¥è‡ªç«‹å³æ•°ï¼Œä½12ä½ç”¨0å¡«å……)ï¼ŒæŠŠè¿™ä¸ªåç§»åŠ åˆ°AUIPCæŒ‡ä»¤çš„åœ°å€ä¸Šï¼Œç„¶åæŠŠç»“æœæ”¾åˆ°rdä¸­ã€‚ï¼ˆrd = pc-4+im) AUIPCæŒ‡ä»¤æ”¯æŒåŒæŒ‡ä»¤åºåˆ—(two-instruction sequences)è®¿é—®ç›¸å¯¹PCçš„ä»»æ„åç§»(for both control-flow transfers and data accesses) ä¸€ä¸ªAUIPCå’ŒJALRä¸­12ä½åç§»çš„ç»„åˆèƒ½å¤Ÿè½¬æ¢æ§åˆ¶ç»™ä»»æ„32ä½çš„PCç›¸å¯¹åœ°å€(PC-relative address)ï¼Œè€Œä¸€ä¸ªALIPCåŠ ä¸Šä¸€ä¸ªå¸¸è§„loadå’ŒstoreæŒ‡ä»¤ä¸­çš„12ä½ç«‹å³æ•°åç§»èƒ½ä¾›è®¿é—®ä»»æ„32ä½PCç›¸å¯¹åœ°å€çš„æ•°æ®åœ°å€(PC-relative data address) å½“å‰PCå€¼å¯ä»¥é€šè¿‡è®¾ç½®ç«‹å³æ•°ä¸º0è·å¾—ï¼Œå°½ç®¡JAL+4æŒ‡ä»¤ä¹Ÿèƒ½è·å¾—æœ¬åœ°PC(JALä¸‹ä¸€æŒ‡ä»¤)ï¼Œå®ƒå¯èƒ½åœ¨ç®€å•å¾®æ¶æ„ä¸­é€ æˆæµæ°´çº¿å´©æºƒï¼Œæˆ–è€…åœ¨æ›´å¤æ‚çš„å¾®æ¶æ„ä¸­æ±¡æŸ“BTB(â“) Register-Register RV32Iå®šä¹‰äº†å‡ ä¸ªRå‹ç®—æœ¯è¿ç®—ã€‚æ‰€æœ‰çš„è¿ç®—éƒ½è¯»å–rs1,rs2å¯„å­˜å™¨çš„å€¼ä½œä¸ºæºæ“ä½œæ•°ï¼ŒæŠŠç»“æœå†™å›rdå¯„å­˜å™¨ã€‚funct7å’Œfunct3åŸŸé€‰æ‹©åˆé€‚çš„è¿ç®—ã€‚ æ„ä¹‰åŒğŸ‘†ã€‚ NOP Instruction NOPæŒ‡ä»¤ï¼šä¸ä¼šæ”¹å˜ä»»ä½•æ¶æ„ä¸Šå¯è§çš„çŠ¶æ€ã€‚å‡ºæ¥æ¨è¿›PCï¼Œå¢åŠ ä»»ä½•é€‚ç”¨çš„æ€§èƒ½è®¡æ•°å™¨ã€‚NOPè¢«ç¼–ç ä¸º`ADDI x0, x0, 0 NOPså¯ä»¥è¢«ç”¨æ¥å¯¹é½ä»£ç æ®µä¸é‡è¦çš„å¾®æ¶æ„åœ°å€è¾¹ç•Œã€‚æˆ–è€…ä¸ºå†…è”ä»£ç ä¿®æ”¹(inline code modification)æµå‡ºç©ºé—´ã€‚å°½ç®¡æœ‰è®¸å¤šå¯èƒ½çš„æ–¹æ³•å»ç¼–ç NOP,æˆ‘ä»¬ä½¿ç”¨äº†è§„èŒƒçš„NOPç¼–ç æ¥å…è®¸å¾®æ¶æ„ä¼˜åŒ–ä»¥åŠæ›´æ˜“è¯»çš„åæ±‡ç¼–è¾“å‡ºã€‚å…¶å®ƒçš„NOPç¼–ç å¯ä»¥ç”¨ä½œæŒ‡ç¤ºæŒ‡ä»¤(HINT instruction) é€‰æ‹©ADDIä½œä¸ºNOPç¼–ç æ˜¯å› ä¸ºå®ƒåœ¨è·¨ä¸€ç³»åˆ—ç³»ç»Ÿæ‰§è¡Œæ—¶æœ€å¯èƒ½å ç”¨æœ€å°‘çš„èµ„æº;é™¤æ­¤ä¹‹å¤–ï¼Œè¯¥æŒ‡ä»¤ä»…è¯»å–ä¸€ä¸ªå¯„å­˜å™¨ã€‚å¹¶ä¸”ï¼Œä¸€ä¸ªADDIåŠŸèƒ½å•å…ƒåœ¨è¶…æ ‡é‡è®¾è®¡ä¸­æ›´å®¹æ˜“å¯ç”¨ï¼Œå› ä¸ºaddsæ˜¯æœ€å¸¸è§çš„è¿ç®— åœ°å€ç”Ÿæˆå•å…ƒå¯ä»¥ä½¿ç”¨ç›¸åŒçš„ç¡¬ä»¶å¤Ÿæ‰§è¡ŒADDIï¼Œè¯¥ç¡¬ä»¶è¢«ç”¨äºbase+offsetåœ°å€è®¡ç®—ï¼Œè€Œregister-register ADDï¼Œé€»è¾‘è¿ç®—æˆ–ç§»ä½è¿ç®—æ“ä½œéœ€è¦é¢å¤–çš„ç¡¬ä»¶ã€‚ 6 Control Transfer RV32Iæä¾›ä¸¤ç§æ§åˆ¶è½¬ä¹‰æŒ‡ä»¤ï¼šæ— æ¡ä»¶è·³è½¬ï¼Œæ¡ä»¶åˆ†æ”¯ RV32Iæ§åˆ¶è½¬ä¹‰æŒ‡ä»¤æ²¡æœ‰æ¶æ„ä¸Šå¯è§çš„å»¶è¿Ÿæ§½(delay slot) Unconditional Jumps JAL(jump and link)æŒ‡ä»¤ä½¿ç”¨J-typeæ ¼å¼ï¼ŒJ-immediateä»¥ä¸¤å­—èŠ‚çš„å€æ•°ç¼–ç ä¸€ä¸ªæœ‰ç¬¦å·åç§»ã€‚(in multiple of 2 bytesï¼›åˆ™è¯¥åç§»è¦ä¹˜ä»¥2)ã€‚åç§»ç¬¦å·æ‰©å±•ï¼Œç„¶ååŠ ä¸Šå½“å‰æŒ‡ä»¤çš„åœ°å€å½¢æˆè·³è½¬ç›®æ ‡åœ°å€(jump target address)ã€‚Jumpså› æ­¤èƒ½å¤Ÿè®¿é—®Â±1 MiBèŒƒå›´ã€‚JALå­˜å‚¨ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€(pc+4)åˆ°rdï¼› æ ‡å‡†è½¯ä»¶è°ƒç”¨çº¦å®šä½¿ç”¨x1ä½œä¸ºè¿”å›åœ°å€å¯„å­˜å™¨ï¼Œx5ä½œä¸ºå¤‡ç”¨é“¾æ¥å¯„å­˜å™¨ã€‚ JALR(jump and link register)ï¼šé—´æ¥è·³è½¬æŒ‡ä»¤ï¼šä½¿ç”¨I-typeï¼Œç›®æ ‡åœ°å€é€šè¿‡æŠŠç¬¦å·æ‰©å±•çš„12æ¯”ç‰¹ç«‹å³æ•°åŠ åˆ°rs1ä¸Šï¼Œç„¶åç½®ç»“æœçš„æœ€ä½ä½ä¸º0è·å¾—ï¼›ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€(pc+4)å†™åˆ°å¯„å­˜å™¨rdã€‚å¦‚æœç»“æœä¸éœ€è¦ï¼Œå¯ä»¥æŠŠx0å½“ä½œç›®çš„å¯„å­˜å™¨ã€‚ å¦‚æœç›®æ ‡åœ°å€æ²¡æœ‰å¯¹é½å››å­—èŠ‚è¾¹ç•Œï¼Œjarå’ŒjarlæŒ‡ä»¤å°†äº§ç”ŸæŒ‡ä»¤åœ°å€éå¯¹é½å¼‚å¸¸ã€‚ è¿”å›åœ°å€é¢„æµ‹æ ˆ(prediction stack)æ˜¯é«˜æ€§èƒ½å–å€¼å•å…ƒçš„ä¸€ä¸ªå¸¸è§ç‰¹ç‚¹ï¼Œè¦æ±‚å‡†ç¡®æ£€æµ‹ç”¨äºè¿‡ç¨‹è°ƒç”¨å’Œè¿”å›çš„æŒ‡ä»¤æ˜¯æœ‰æ•ˆçš„ã€‚ å¯¹äºRISC-V,å…³äºæŒ‡ä»¤ä½¿ç”¨çš„çº¿ç´¢é€šè¿‡å¯„å­˜å™¨å·çš„ä½¿ç”¨è¢«ç®€å•çš„ç¼–ç ã€‚ JALæŒ‡ä»¤åº”è¯¥æŠŠè¿”å›åœ°å€å‹è¿›è¿”å›åœ°å€æ ˆ(RAS)ä¸­ï¼Œå½“ä¸”ä»…å½“rd = x1/x5ï¼› JALRæŒ‡ä»¤åº”è¯¥push/pop a RAS link is true when the register is either x1 or x5 Conditional Branches æ‰€æœ‰åˆ†æ”¯æŒ‡ä»¤ä½¿ç”¨B-typeæ ¼å¼ã€‚ 12æ¯”ç‰¹çš„ç«‹å³æ•°ç”¨2å­—èŠ‚çš„å€æ•°ç¼–ç æœ‰ç¬¦å·åç§» ç«‹å³æ•°ç¬¦å·æ‰©å±•åä¸å½“å‰æŒ‡ä»¤åœ°å€ç›¸åŠ ï¼Œå¯ä»¥è®¿é—®çš„åœ°å€èŒƒå›´ï¼šÂ±4 KiB BEQ:branch equal;&nbsp;&nbsp;BNE: branch not equal;&nbsp;&nbsp;BLT: branch less than;&nbsp;&nbsp;BGE: branch greater than; åº”è¯¥å¯¹è½¯ä»¶è¿›è¡Œä¼˜åŒ–ï¼Œä½¿é¡ºåºä»£ç è·¯å¾„æˆä¸ºæœ€å¸¸è§çš„è·¯å¾„ï¼Œå¹¶å°†è¾ƒä¸ç»å¸¸ä½¿ç”¨çš„åˆ†æ”¯ä»£ç è·¯å¾„ç½®äºè¡Œå¤–ã€‚è½¯ä»¶è¿˜åº”è¯¥å‡è®¾ï¼Œè‡³å°‘åœ¨ç¬¬ä¸€æ¬¡é‡åˆ°åˆ†æ”¯æ—¶ï¼Œé¢„æµ‹å‘åè·³è½¬çš„åˆ†æ”¯å‘ç”Ÿï¼Œå‘å‰è·³è½¬çš„åˆ†æ”¯ä¸å‘ç”Ÿã€‚åŠ¨æ€é¢„æµ‹å™¨åº”è¯¥å¿«é€Ÿå­¦ä¹ ä»»ä½•å¯é¢„æµ‹çš„åˆ†æ”¯è¡Œä¸ºã€‚ ä¸åƒä¸€äº›å…¶å®ƒçš„æ¶æ„ï¼ŒRISC-Vä¸­å¯¹äºéæ¡ä»¶åˆ†æ”¯åº”è¯¥æ€»æ˜¯ä½¿ç”¨jump(JAL with rd=x0)æŒ‡ä»¤è€Œä¸æ˜¯æ¡ä»¶æ€»æ˜¯æ»¡è¶³çš„æœ‰æ¡ä»¶åˆ†æ”¯æŒ‡ä»¤ RISC-Vè·³è½¬ä¹Ÿæ˜¯ä¸pcç›¸å…³çš„ï¼Œå¹¶ä¸”æ¯”åˆ†æ”¯æ”¯æŒæ›´å¤§çš„åç½®èŒƒå›´ï¼Œè€Œä¸”ä¸ä¼šæ±¡æŸ“æ¡ä»¶åˆ†æ”¯é¢„æµ‹è¡¨ã€‚ 7 Load and Store(ğŸ˜³) RV32Iæ˜¯ä¸€ä¸ªè£…è½½å’Œå­˜å‚¨æ¶æ„ï¼šåªæœ‰loadå’ŒstoreæŒ‡ä»¤èƒ½å¤Ÿè®¿é—®å†…å­˜ï¼Œç®—æœ¯æŒ‡ä»¤åªèƒ½æ“ä½œCPUå¯„å­˜å™¨ã€‚ RV32Iæä¾›äº†32-bitçš„åœ°å€ç©ºé—´ï¼Œç”¨å­—èŠ‚ç¼–ç ã€‚ EEIå®šä¹‰äº†åœ°å€ç©ºé—´çš„é‚£éƒ¨åˆ†å¯ä»¥è¢«å“ªäº›æŒ‡ä»¤åˆæ³•è®¿é—®ã€‚(e.g.ï¼Œä¸€äº›åœ°å€å¯èƒ½åªèƒ½è¢«è¯»ï¼Œæˆ–ä»…æ”¯æŒæŒ‰å­—è®¿é—®) ç›®çš„å¯„å­˜å™¨ä¸ºx0çš„è£…è½½æŒ‡ä»¤å°†æŠ›å‡ºå¼‚å¸¸ï¼Œå³ä½¿è£…è½½çš„å€¼è¢«ä¸¢å¼ƒä¹Ÿä¼šé€ æˆå…¶å®ƒçš„å‰¯ä½œç”¨ã€‚ In RISC-Vï¼Œendianness is byte-address invariant å¦‚æœä¸€ä¸ªå­—èŠ‚ä»¥æŸç§é¡ºåº(at some endianness)å­˜å‚¨åˆ°å†…å­˜æŸä¸ªåœ°å€å¤„ï¼Œé‚£ä¹ˆä»¥å­—èŠ‚å¤§å°ä»é‚£ä¸ªåœ°å€ä»¥ä»»æ„çš„é¡ºåº(in any endianness)è£…è½½çš„ç»“æœæ˜¯å­˜å‚¨çš„å€¼ã€‚ å°ç«¯(little-endian): å¤šå­—èŠ‚å­˜å‚¨æ—¶æŠŠå¯„å­˜å™¨æœ€ä½ä¸ºå­—èŠ‚å†™åˆ°å†…å­˜å­—èŠ‚åœ°å€çš„æœ€ä½ä¸ºï¼Œéšåå¯„å­˜å™¨çš„å…¶å®ƒå­—èŠ‚ä»¥æƒé‡å‡åºå†™å…¥ã€‚ï¼ˆæƒé‡è¶Šå¤§çš„å­—èŠ‚å æ®çš„å†…å­˜åœ°å€è¶Šå¤§ï¼‰ è£…è½½å’Œå­˜å‚¨æŒ‡ä»¤ç”¨äºåœ¨å¯„å­˜å™¨å’Œå†…å­˜ä¸­è½¬æ¢æ•°æ®ã€‚ Loads: I-type Stores: S-type æœ‰æ•ˆåœ°å€ï¼šç«‹å³æ•°ç¬¦å·æ‰©å±•åŠ ä¸ŠåŸºå€å¯„å­˜å™¨rs1 ç›®çš„åœ°å€ï¼šâ… ã€for load:ä»å†…å­˜å–å€¼åˆ°rd;â…¡ã€for storeï¼šå¤åˆ¶rs2çš„å€¼åˆ°å†…å­˜ 8 Memory Ordering FENCEï¼šç”¨äºæ’åºè¢«å…¶å®ƒRISC-Vçº¿ç¨‹ï¼Œå¤–éƒ¨è®¾å¤‡æˆ–è€…åå¤„ç†å™¨å¯è§çš„è®¾å¤‡I/Oå’Œå­˜å‚¨å™¨è®¿é—®ã€‚ ä»»ä½•è®¾å¤‡è¾“å…¥(I)ï¼Œè®¾å¤‡è¾“å‡º(O)ï¼Œå­˜å‚¨å™¨è¯»å–(R),å­˜å‚¨å™¨å†™(W)çš„ç»„åˆèƒ½å¤Ÿè¢«æ’åºæˆä»»ä½•ç›¸åŒçš„ç»„åˆã€‚ é€šä¿—åœ°è¯´ï¼Œæ²¡æœ‰å…¶å®ƒçº¿ç¨‹æˆ–è€…å¤–éƒ¨è®¾å¤‡èƒ½å¤Ÿåœ¨fenceä¹‹å‰çš„æŒ‡ä»¤é›†è¿›è¡Œä»»ä½•æ“ä½œä¹‹å‰ï¼Œè§‚æµ‹åˆ°åœ¨fenceåè€…çš„æŒ‡ä»¤é›†åˆæ‰€åšçš„ä»»ä½•æ“ä½œã€‚å°±åƒä¸€ä¸ªå±éšœä¸€æ ·ï¼Œå‰é¢çš„æ“ä½œåªæœ‰å…ˆå®Œæˆï¼Œåé¢çš„æŒ‡ä»¤ç»“æœæ‰èƒ½è¢«å…¶å®ƒå¤„ç†å™¨è§‚å¯Ÿåˆ°ã€‚ memory-mapped I/Oè®¾å¤‡å¾ˆå…¸å‹åœ°è¢«æ²¡æœ‰cacheçš„loadså’Œstoreè®¿é—®ï¼Œå®ƒä»¬ä½¿ç”¨Iå’ŒOè€Œä¸æ˜¯Rå’ŒWã€‚ æŒ‡ä»¤é›†æ‰©å±•ä¹Ÿå¯ä»¥æè¿°æ–°çš„I/OæŒ‡ä»¤ï¼Œä½¿ç”¨fenceæŒ‡ä»¤ä¸­Iå’ŒOä½è¿›è¡Œæ’åº fence modeåŸŸåœ¨ins[31:28]ï¼›å½“fm=0000æ—¶æ’åºæ‰€æœ‰çš„å†…å­˜æ“ä½œã€‚ å¯é€‰çš„FENCE.TSOæŒ‡ä»¤å…¶fm=1000ï¼›predecessor=RW,å¹¶ä¸”successor=RWã€‚TSOå‘½ä»¤å®ƒçš„å‰é¢é›†åˆä¸­çš„æ‰€æœ‰åŠ è½½æ“ä½œå…ˆäºå®ƒçš„åç»§é›†åˆä¸­çš„æ‰€æœ‰å†…å­˜æ“ä½œï¼›å®ƒçš„å‰é¢é›†åˆä¸­çš„æ‰€æœ‰å­˜å‚¨æ“ä½œ(store operation)éƒ½è¦å…ˆäºå®ƒçš„åç»§é›†åˆä¸­çš„æ‰€æœ‰å­˜å‚¨æ“ä½œ 9 Call and Breakpoints SYSTEM instructionï¼šè¢«ç”¨äºè®¿é—®éœ€è¦ç‰¹æƒè®¿é—®çš„ç³»ç»ŸåŠŸèƒ½ï¼Œä½¿ç”¨I-typeã€‚ åˆ†ä¸ºä¸¤å¤§ç±»ï¼š è‡ªåŠ¨è¯»-ä¿®æ”¹-å†™(read-modify-write)æ§åˆ¶çŠ¶æ€å¯„å­˜å™¨(CSRs)ã€‚ æ½œåœ¨çš„ç‰¹æƒæŒ‡ä»¤(potentially privileged instructions) ç³»ç»ŸæŒ‡ä»¤è¢«å®šä¹‰æˆè¿è¡Œç¨ç®€å•çš„å®ç°æ€»æ˜¯æ•è·å¼‚å¸¸ç»™å•ä¸€çš„è½¯ä»¶å¼‚å¸¸å¤„ç†å™¨(software trap handle)ï¼›æ›´åŠ å¤æ‚çš„å®ç°å¯èƒ½éœ€è¦æ‰§è¡Œæ›´å¤šæ¡ç³»ç»ŸæŒ‡ä»¤ è¿™ä¸¤ä¸ªæŒ‡ä»¤ä¼šå‘é…å¥—æ‰§è¡Œç¯å¢ƒ(supporting execution environment)å¼•èµ·ä¸€ä¸ªç²¾ç¡®çš„è¯·æ±‚å¼‚å¸¸(requested trap)ã€‚ ECALL ECALLï¼šå‘è¿è¡Œç¯å¢ƒæå‡ºæœåŠ¡è¯·æ±‚(service request) EElå°†å®šä¹‰æœåŠ¡è¯·æ±‚çš„å‚æ•°å¦‚ä½•ä¼ é€’ï¼Œä½†é€šå¸¸è¿™äº›éƒ½æ˜¯åœ¨æ•´æ•°å¯„å­˜å™¨ä¸­æŒ‡å®šçš„ä½ç½® EBREAK EBREAKï¼šè¿”å›æ§åˆ¶æƒç»™è°ƒè¯•å™¨ç¯å¢ƒ(debugging environment) 10 Hint RV32Iä¸ºHINTæŒ‡ä»¤ä¿ç•™äº†å¤§çš„ç¼–ç ç©ºé—´ï¼Œé€šå¸¸æ˜¯ç”¨æ¥å’Œå¾®æ¶æ„æ²Ÿé€šæ€§èƒ½æç¤ºã€‚HINTsè¢«ç¼–ç ä¸ºæ•´æ•°è®¡ç®—æŒ‡ä»¤,å…¶ä¸­rd=x0ã€‚å› æ­¤ï¼ŒåƒnopæŒ‡ä»¤ä¸€æ ·ï¼ŒHINTsä¸ä¼šæ”¹å˜æ¶æ„å¯è§çš„çŠ¶æ€ï¼Œé™¤äº†å¢åŠ pcå’Œä»»ä½•é€‚ç”¨çš„æ€§èƒ½è®¡æ•°å™¨ã€‚","categories":[{"name":"RISC-V","slug":"RISC-V","permalink":"https://www.beenli.cn/categories/RISC-V/"},{"name":"spec","slug":"RISC-V/spec","permalink":"https://www.beenli.cn/categories/RISC-V/spec/"}],"tags":[]},{"title":"IEEE Standard(1)--Conventions","slug":"IEEE-Standard-for-Verilog-1-Conventions","date":"2020-09-28T09:44:18.000Z","updated":"2020-09-30T12:01:11.648Z","comments":true,"path":"posts/7b1b9603/","link":"","permalink":"https://www.beenli.cn/posts/7b1b9603/","excerpt":"","text":"1ã€Overview1.1 Conventionshall: ç”¨äºæ³•å®šçš„è¦æ±‚ï¼ˆmandatory requirementï¼‰ may: ç”¨äºå¯é€‰çš„ç‰¹æ€§ï¼ˆoptional featureï¼‰ 1.2 Syntactic description BNFæè¿°æ–¹æ³•(Backus-Naur Form)ï¼š åŸºæœ¬ç»“æ„ä¸ºï¼š ::= ::=ï¼šè¢«å®šä¹‰ä¸ºçš„æ„æ€ â€œ â€: åŒå¼•å·è¡¨ç¤ºå­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯ç»ˆç»“ç¬¦ï¼Œä¸èƒ½å†è¢«å®šä¹‰ã€‚ åœ¨åŒå¼•å·å¤–çš„å­—ä»£è¡¨ç€è¯­æ³•éƒ¨åˆ†ï¼›åŸºæœ¬ç±»å‹ ::= å­—ç¬¦ä¸² | æ•°å­— | å¸ƒå°”,å…¶ä¸­å­—ç¬¦ä¸²ã€æ•°å­—ã€å¸ƒå°”å…·ä½“æ˜¯ä»€ä¹ˆï¼Œç”±ä¸‹é¢çš„è§„åˆ™å®šä¹‰ï¼ˆé€’å½’ï¼‰ &lt;&gt;ï¼šå°–æ‹¬å·é‡Œçš„å†…å®¹è¡¨ç¤ºå¿…é€‰å†…å®¹ï¼› [...]: è¡¨ç¤ºå¯é€‰ã€‚ {...}:è¡¨ç¤ºé‡å¤ï¼›å®ä¾‹ï¼šAB ::= \"a\" {\"b\"}è¡¨ç¤ºï¼šABç”±ä¸€ä¸ªaåŠ ä¸Šä»»æ„æ•°é‡ï¼ˆåŒ…æ‹¬0ä¸ªï¼‰ä¸ªbç»„æˆ (...): è¡¨ç¤ºåˆ†ç»„ï¼Œç”¨æ¥æ§åˆ¶ä¼˜å…ˆçº§ï¼›AX ::= \"a\" (\"m\"|\"n\")è¡¨ç¤ºï¼šAXç”±ä¸€ä¸ªaåŠ ä¸Šmæˆ–è€…nç»„æˆ (*...*) : æ³¨é‡Šï¼Œè¯´æ˜æ€§æ–‡æœ¬ï¼Œä¸è¡¨ç¤ºä»»ä½•è¯­æ³•ã€‚ å°å†™å•è¯ï¼Œä¸€äº›åŒ…å«ä¸‹åˆ’çº¿çš„ï¼šè¯­æ³•ç›®å½•ï¼ˆsyntactic categoriesï¼‰ â€‹ module_declaration ç²—ä½“ï¼šä¿ç•™å­—ã€æ“ä½œç¬¦ã€æ ‡ç‚¹ç¬¦å· â€‹ module =&gt; ; ç«–æ¡|åˆ†å‰²å¯é€‰å•å…ƒã€‚å¦‚æœå®ƒä»¥ç²—ä½“å½¢å¼å‡ºç°ï¼Œå®ƒæ‰è¡¨ç¤ºè‡ªå·±ã€‚ â€‹ unary_operator ::= + | - | ! | ~ | &amp; | ~&amp; | |(æˆ–) | ~|(æˆ–é) | ^ | ~^ | ^~ï¼ˆéƒ½è¡¨ç¤ºåŒæˆ–) æ–¹æ‹¬å·[â€¦]åŒ…å«å¯é€‰é¡¹ã€‚ input_declaration ::= input [range] list_of_variables; èŠ±æ‹¬å·{}é™¤éä»¥ç²—ä½“å‡ºç°ï¼Œå®ƒæ‰è¡¨ç¤ºè‡ªå·±ï¼Œå¦åˆ™è¡¨ç¤ºé‡å¤ã€‚é‡å¤ä»å·¦åˆ°å³è¿›è¡Œï¼Œå’Œå·¦é€’å½’ç­‰æ•ˆã€‚ list_of_param_assignments ::= param_assignment { , param_assignment } list_of_param_assignments ::=param_assignment| list_of_param_assignment , param_assignment ä»»ä½•ç›®å½•çš„åå­—ä»¥æ–œä½“å¼€å¤´ï¼Œç­‰æ•ˆäºæ²¡æœ‰æ–œä½“éƒ¨åˆ†çš„ç›®å½•åã€‚æ–œä½“éƒ¨åˆ†åªæ˜¯ä¸ºäº†ä¼ è¾¾semantic informationã€‚ æ­£æ–‡ä¸­å½“ä¸€ä¸ªtermè¢«å®šä¹‰æ—¶ä½¿ç”¨æ–œä½“ï¼›åœ¨ä¾‹å­ï¼Œæ–‡ä»¶åï¼Œå¸¸é‡ç‰¹åˆ«æ—¶0ï¼Œ1ï¼Œxå’Œzçš„å€¼æ—¶ä½¿ç”¨constant-widthå­—ä½“ï¼ˆç­‰å®½å­—ä½“ï¼‰ 2ã€Lexical convention2.1ã€Lexical tokens Verilog HDL source file shall be a stream of lexical tokens. A lexical tokens shall consist of one or more characters.verilogæºæ–‡ä»¶åº”è¯¥æ˜¯ä¸€è¿ä¸²è¯­æ³•æ ‡è®°ï¼Œä¸€ä¸ªè¯­æ³•æ ‡è®°ç”±ä¸€ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ç»„æˆã€‚ æºæ–‡ä»¶ä¸­tokensçš„ä½ç½®æ˜¯éšæ„çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼šé™¤äº†tokenåˆ†éš”ç¬¦ï¼Œç©ºæ ¼å’Œæ¢è¡Œä¸åº”è¯¥æœ‰ç‰¹æ®Šæ„ä¹‰ï¼Œè½¬ä¹‰å­—ç¬¦é™¤å¤–ã€‚ æœ‰å¦‚ä¸‹å‡ ç§è¯­æ³•æ ‡è®° White space Comment Operator Number String Identifier Keyword 2.2ã€White spacewhite spaceåº”è¯¥åŒ…å«ï¼šç”¨äºç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢è¡Œç¬¦å’Œæ ¼å¼æè¦çš„å­—ç¬¦ã€‚è¿™äº›å­—ç¬¦åº”è¯¥è¢«å¿½ç•¥é™¤äº†å½“å®ƒä»¬ç”¨äºåˆ†å‰²å…¶ä»–è¯­æ³•æ ‡è®°(tokens)ã€‚ä½†æ˜¯blankså’Œtabsè¢«è®¤ä¸ºæ˜¯æœ‰æ„ä¹‰çš„å­—ç¬¦åœ¨å­—ç¬¦ä¸²ä¸­ã€‚ 2.3ã€Comments å•è¡Œæ³¨é‡Š // å—æ³¨é‡Šï¼š/* â€¦. */ 2.4ã€Operators æ“ä½œç¬¦å¯ä»¥æ˜¯å•ä¸ªï¼ŒåŒä¸ªæˆ–ä¸‰ä¸ªå­—ç¬¦çš„åºåˆ—ï¼Œå¹¶è¢«ç”¨åœ¨è¡¨è¾¾å¼ä¸­ã€‚Clause5å°†è®¨è®ºè¡¨è¾¾å¼ä¸­æ“ä½œç¬¦çš„ä½¿ç”¨ã€‚ å•ç›®è¿ç®—ç¬¦(Unary operators)ï¼šåœ¨æ“ä½œæ•°(operand)çš„å·¦è¾¹ åŒç›®è¿ç®—ç¬¦(Binary operators)ï¼šåœ¨ä¸¤ä¸ªæ“ä½œæ•°ä¸­é—´ ä¸‰æœ¨è¿ç®—ç¬¦(Triple operator or conditional operator): æœ‰ä¸¤ä¸ªæ“ä½œç¬¦å­—ç¬¦åˆ†å‰²ä¸‰ä¸ªæ“ä½œæ•°ï¼ˆa? x: y) 2.5ã€NumbersConstant numberså¯ä»¥è¢«æŒ‡å®šä¸ºinteger constantæˆ–è€…real constant 2.5.1ã€Integer constantæœ‰ä¸¤ç§è¡¨è¾¾æ–¹å¼ï¼š ç®€å•çš„åè¿›åˆ¶æ•°ï¼ša sequence of digits of 0 through 9ã€‚å¼€å¤´å¯ä»¥åŠ ä¸Š+æˆ–è€…-ï¼ˆè¢«è§†ä¸ºæœ‰ç¬¦å·çš„æ•´æ•°ï¼‰ æŒ‡å®šåŸºç ï¼ˆdï¼Œhï¼Œoï¼Œbï¼‰ï¼šå¯é€‰çš„ä½å®½+'(ASCII 0x27)+åŸºç +digits ä½å®½ï¼šéé›¶æ— ç¬¦å·åè¿›åˆ¶æ•° åŸºç ï¼šå¤§å°å†™ä¸æ•æ„Ÿï¼›å‰é¢å¯é€‰sæŒ‡ç¤ºæ˜¯å¦ä¸ºæœ‰ç¬¦å·æ•°ï¼ˆæ²¡æœ‰sæ—¶é»˜è®¤ä¸ºunsigned integers) 'ä¸åŸºç ä¸­é—´ä¸èƒ½æœ‰ç©ºæ ¼ã€‚â­ digits: åº”è¯¥ç´§è·Ÿç€åŸºç ï¼Œå‰é¢ä¹Ÿå¯ä»¥æœ‰ç©ºæ ¼ã€‚a-fä¸åŒºåˆ†å¤§å°å†™ sä¸å½±å“æŒ‡å®šçš„ä½æ¨¡å¼ï¼Œåªæ”¹å˜è§£é‡Šæ–¹å¼ã€‚â“ è´Ÿæ•°ç”¨è¡¥ç è¡¨ç¤º xä»£è¡¨unknown valueï¼›zä»£è¡¨high-impedance valueï¼ˆxåº”è¯¥è®¾ä¸º4bitå¯¹äºhçš„åŸºç ï¼Œ3bitå¯¹äºoçš„åŸºç ï¼›zåŒç†ï¼‰ å¦‚æœæ— ç¬¦å·æ•°ä½å®½å°äºæŒ‡å®šä½å®½ï¼Œé‚£ä¹ˆç”¨0å¡«å……ï¼›å¦‚æœæ— ç¬¦å·æ•°æœ€å·¦è¾¹çš„ä½æ˜¯xæˆ–z;é‚£ä¹ˆç”¨xæˆ–zå¡«å……ã€‚å¦‚æœæ— ç¬¦å·ä½å®½å¤§äºæŒ‡å®šï¼Œé‚£ä¹ˆåº”è¯¥ä»å·¦è¾¹æˆªæ–­åˆ°æŒ‡å®šä½å®½ã€‚ æ²¡æœ‰æŒ‡å®šä½å®½çš„æ•°å­—è‡³å°‘ä¸º32ä½ï¼›å¯¹äºé«˜ä½æ˜¯xæˆ–è€…zçš„æ²¡æœ‰ä½å®½æ— ç¬¦å·å¸¸æ•°åº”ä½æ‰©å±•åˆ°åŒ…å«è¯¥å¸¸æ•°çš„è¡¨è¾¾å¼çš„å¤§å°ã€‚â“ ?æ˜¯zçš„æ›¿ä»£å­—ç¬¦ã€‚åœ¨é«˜é˜»å€¼ä¸éœ€è¦æ³¨æ„æ—¶ï¼Œå¯ç”¨ï¼Ÿæ¥å¢åŠ å¯è¯»æ€§ã€‚ åœ¨åè¿›åˆ¶å¸¸æ•°ä¸­ï¼Œæ— ç¬¦å·æ•°ä¸èƒ½åŒ…å«ä»»ä½•x,z,?ï¼›é™¤éåªæœ‰ä¸€ä¸ªdigitï¼ŒæŒ‡ç¤ºå…¶ä¸­æ¯ä¸€ä½éƒ½æ˜¯xæˆ–è€…zã€‚ _ä¸‹åˆ’çº¿åœ¨æ•°å­—çš„ä»»ä½•ä½ç½®éƒ½æ˜¯åˆæ³•çš„ï¼Œé™¤äº†ç¬¬ä¸€ä¸ªå­—ç¬¦ã€‚ä¸‹åˆ’çº¿æ˜¯æ²¡æœ‰æ„ä¹‰çš„ ï¼Œåªæ˜¯ä¸ºäº†åˆ†å‰²é•¿çš„æ•°å­—æé«˜å¯è¯»æ€§ã€‚ æ— ç¬¦å·æ•°ï¼š 123456789101112/************* Example 1--Unsized constant numbers *****************/659 // is a decimal number 'h 837FF // is a hexadecimal number 'o7460 // is an octal number 4af // is illegal (hexadecimal format requires 'h)/************* Example 2--Sized constant numbers *****************/4'b1001 // is a 4-bit binary number 5 'D 3 // is a 5-bit decimal number 3'b01x // is a 3-bit number with the least significant bit unknown 12'hx // is a 12-bit unknown number 16'hz // is a 16-bit high-impedance number æœ‰ç¬¦å·æ•°çš„è¡¨ç¤ºæ„ä¹‰ï¼š 1234567/************* Example 3â€”Using sign with constant numbers *****************/8 'd -6 // this is illegal syntax -8 'd 6 // this defines the two's complement of 6, held in 8 bitsâ€”equivalent to -(8'd 6) 4 'shf // this denotes the 4-bit number '1111', to be interpreted as a 2's complement number, // or '-1'. This is equivalent to -4'h 1 -4 'sd15 // this is equivalent to -(-4'd 1), or '0001'16'sd? // the same as 16'sbz è‡ªåŠ¨å·¦å¡«å……ï¼š 123456789101112/************* Example 4â€”Automatic left padding **************************/reg [11:0] a, b, c, d;initial begina = 'h x; // yields xxxb = 'h 3x; // yields 03xc = 'h z3; // yields zz3d = 'h 0z3; // yields 0z3endreg [84:0] e, f, g; e = 'h5; // yields {82{1'b0},3'b101}f = 'hx; // yields {85{1'hx}}g = 'hz; // yields {85{1'hz}} ä½¿ç”¨ä¸‹åˆ’çº¿ï¼š 1234/************* Using underscore character in numbers *******************/27_195_000 16'b0011_0101_0001_1111 32 'h 12ab_f001 2.5.2ã€Real constants real constantsç”¨IEEE Std 754-1985ï¼ŒåŒç²¾åº¦æµ®ç‚¹æ•°è¡¨ç¤º æœ‰ä¸¤ç§è¡¨ç¤ºæ–¹æ³•ï¼š åè¿›åˆ¶è¡¨ç¤ºï¼š14.72 ç§‘å­¦è®¡æ•°æ³•ï¼š39e8ï¼ˆè¡¨ç¤º39ä¹˜ä»¥10çš„8æ¬¡æ–¹ï¼‰ æ³¨æ„ï¼šå¸¦æœ‰å°æ•°ç‚¹çš„å®æ•°è‡³å°‘åœ¨å°æ•°ç‚¹ä¸¤è¾¹å„æœ‰ä¸€ä½ã€‚ .12 &nbsp;9. &nbsp; 4.E3 &nbsp; .2e-7 éƒ½æ˜¯ä¸åˆæ³•çš„ 2.5.3ã€Convertionå®æ•°å‘æ•´æ•°è½¬åŒ–ï¼šå››èˆäº”å…¥åˆ°æœ€è¿‘çš„æ•´æ•°ï¼Œè€Œä¸æ˜¯æˆªæ–­ã€‚ å½“ä¸€ä¸ªå®æ•°è¢«èµ‹å€¼ç»™æ•´æ•°æ—¶ï¼šè¿›è¡Œéšå£«è½¬åŒ–(implicit conversion) å››èˆäº”å…¥è§„åˆ™ï¼šaway from zero -1.5 è½¬åŒ–ä¸º-2ï¼›1.5è½¬åŒ–ä¸º2 2.6ã€Strings å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªå­—ç¬¦åºåˆ—ï¼Œç”¨(â€œ â€œ)æ‹¬èµ·æ¥ï¼ŒåŒ…å«åœ¨ä¸€è¡Œä¸­ã€‚å­—ç¬¦ä¸²å¯ä»¥ç”¨ä½œè¡¨è¾¾å¼çš„æ“ä½œæ•°ï¼›èµ‹å€¼æ—¶è¢«å½“æˆæ— ç¬¦å·æ•´æ•°å¸¸æ•°ï¼Œä¸€ä¸ª8-bitçš„ASCIIå€¼å¯¹åº”ä¸€ä¸ªå­—ç¬¦ã€‚ 2.6.1ã€String variable declaration å­—ç¬¦ä¸²å˜é‡æ˜¯regç±»å‹ï¼Œå®½åº¦=å­—ç¬¦ä¸ªæ•°*8 12345/********* \"Hello world!\"ä¸€å…±12ä¸ªå­—ç¬¦ ********/reg [8*12:1] stringvar;initial begin stringvar = \"Hello world!\";end 2.6.2ã€String manipulation å­—ç¬¦ä¸²å¯ä»¥ç”¨Verilogçš„æ“ä½œç¬¦è¿›è¡Œæ“çºµã€‚è¢«æ“çºµçš„å€¼æ˜¯8bit ASCIIå€¼åºåˆ— 1234567891011121314module string_test;reg [8*14:1] stringvar;initial begin stringvar = \"Hello world\"; $display (\"%s is stored as %h\", stringvar,stringvar); stringvar = {stringvar,\"!!!\"}; $display (\"%s is stored as %h\", stringvar,stringvar);endendmodule/************** outputs ****************/Hello world is stored as 00000048656c6c6f20776f726c64Hello world!!! is stored as 48656c6c6f20776f726c64212121 å½“å˜é‡å ç”¨ç©ºé—´å¤§äºæ‰€åˆ†é…çš„ç©ºé—´æ—¶ï¼Œå€¼å‘å³è°ƒæ•´ï¼Œæœ€å·¦è¾¹ç”¨0å¡«å……ï¼Œä¸å¤„ç†éå­—ç¬¦ä¸²çš„å€¼ä¸€æ ·ã€‚ å½“å ç”¨ç©ºé—´å¤§äºåˆ†é…ç©ºé—´æ—¶ï¼Œå­—ç¬¦ä¸²è¿˜æ˜¯å‘å³è°ƒæ•´ï¼Œæœ€å·¦è¾¹çš„æˆªæ–­ã€‚ 2.6.3 Special characters in strings æœ‰äº›å­—ç¬¦åªæœ‰å‰é¢åŠ ä¸Šescape characterå®ƒä»¬æ‰èƒ½åœ¨å­—ç¬¦ä¸²é‡Œé¢ä½¿ç”¨ 2.7ã€Identifiersï¼Œkeywords,and system names æ ‡è¯†ç¬¦ç”¨äºç»™ä¸€ä¸ªå¯¹è±¡ç‹¬ä¸€æ— äºŒçš„åå­—ï¼Œä½¿å¾—å®ƒä»¬èƒ½å‘—å¼•ç”¨ã€‚ ç®€å•çš„æ ‡è¯†ç¬¦ï¼šå­—æ¯ï¼Œæ•°å­—ï¼Œ$,&nbsp;&nbsp;_ç»„æˆã€‚å¼€å¤´åªèƒ½æ˜¯å­—æ¯æˆ–è€…ä¸‹åˆ’çº¿ã€‚ï¼ˆ_bus, wan$li) å®ç°çš„æ—¶å€™æ ‡è¯†ç¬¦æœ‰æœ€å¤§é•¿åº¦ï¼Œå®ƒçš„é™åˆ¶åº”è¯¥è‡³å°‘ä¸º1024ä¸ªå­—ç¬¦ã€‚å¦‚æœä¸€ä¸ªæ ‡è¯†ç¬¦é•¿åº¦è¶…è¿‡è¿™ä¸ªï¼Œç³»ç»Ÿåº”è¯¥æŠ¥é”™ã€‚ 2.7.1 Escaped identifiers è½¬ä¹‰æ ‡è¯†ç¬¦ä»¥åæ–œæ \\å¼€å§‹ï¼Œä»¥white space(space, tab,newline)ç»“æŸã€‚å®ƒä»¬æä¾›äº†åœ¨æ ‡è¯†ç¬¦ä¸­åŒ…å«ä»»ä½•å¯æ‰“å°å­—ç¬¦çš„æ–¹æ³•ï¼ˆ33(!)-126(~)ï¼›$21_h$-$7E_h$)ã€‚ å‰å¯¼åæ–œæ å’Œç»“å°¾çš„ç©ºç™½å­—ç¬¦éƒ½ä¸ç®—æ ‡è¯†ç¬¦çš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤ï¼Œ\\cpu3è¢«è®¤ä¸ºå’Œcpu3ä¸€æ ·ã€‚ 123456\\busa+index\\-clock\\***error-condition***\\net1/\\net2\\{a,b}\\a*(b+c) 2.7.2 Keywords å…³é”®å­—æ˜¯å…ˆå‰å®šä¹‰å¥½çš„éè½¬ä¹‰æ ‡è¯†ç¬¦ï¼Œå®ƒä»¬è¢«ç”¨æ¥å®šä¹‰è¯­è¨€ç»“æ„ã€‚å…³é”®å­—å‰é¢åŠ ä¸Šè½¬ä¹‰å­—ç¬¦ä¸è¢«è§£é‡Šä¸ºå…³é”®å­— 2.7.3 System tasks and functionsâ“ ç¾å…ƒç¬¦å·(`)å¼•å¯¼ä¸€ç§è¯­è¨€ç»“æ„ï¼šå®ƒèƒ½å¼€å‘ç”¨æˆ·å®šä¹‰çš„ä»»åŠ¡å’Œå‡½æ•°ï¼›System constructsä¸æ˜¯è®¾è®¡åŸè¯­ï¼Œè€Œæ˜¯ä»¿çœŸåŠŸèƒ½ã€‚ç¾å…ƒ(`)å¼€å¤´çš„åå­—è¢«è§£é‡Šä¸ºç³»ç»Ÿä»»åŠ¡æˆ–è€…ç³»ç»Ÿå‡½æ•°ã€‚ 123/*********** for example **********/$display (\"display a message\");$finish ; 2.7.4 Compiler directives `ï¼ˆASICC value 0x60)å­—ç¬¦å¼•å¯¼ç”¨äºå®ç°ç¼–è¯‘å™¨æŒ‡ä»¤çš„è¯­è¨€ç»“æ„ï¼›ï¼Œä¸€ä¸ªæè¿°æ–‡ä»¶ä¸­çš„ç¼–è¯‘å™¨æŒ‡ä»¤å¯ä»¥æ§åˆ¶å¤šä¸ªæè¿°æ–‡ä»¶ä¸­çš„ç¼–è¯‘è¡Œä¸ºã€‚ `identifier ç¼–è¯‘å™¨æŒ‡ä»¤ç»“æ„åœ¨ä»¥ä¸‹ä¸¤ç§åœ°æ–¹å®šä¹‰ æ ‡å‡†æ ‡è¯†ç¬¦ç¼–è¯‘å™¨æŒ‡ä»¤ ç”±è½¯ä»¶å®ç°å®šä¹‰çš„é™„åŠ â€™æ ‡è¯†ç¬¦ç¼–è¯‘å™¨æŒ‡ä»¤ã€‚ ä»»ä½•æœ‰æ•ˆçš„æ ‡è¯†ç¬¦ï¼ŒåŒ…æ‹¬å·²ç»åœ¨é™¤æ­¤æ„é€ ä¹‹å¤–çš„ä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨çš„å…³é”®å­—ï¼Œéƒ½å¯ä»¥ç”¨ä½œç¼–è¯‘å™¨æŒ‡ä»¤å 12/*********** for example **********/`define wordsize 8 2.8ã€Attributes éšç€ä½¿ç”¨Verilog HDLä½œä¸ºæºä»£ç çš„ä»¿çœŸå™¨ä»¥å¤–çš„å·¥å…·çš„æ¿€å¢(proliferation); Verilogå¼•å…¥ä¸€ç§æœºåˆ¶ï¼šç”¨äºæŒ‡å®šå…³äºHDLæºä»£ç ä¸­å¯¹è±¡ã€è¯­å¥å’Œè¯­å¥ç»„çš„å±æ€§ï¼Œè¿™äº›å±æ€§å¯è¢«å„ç§å·¥å…·(åŒ…æ‹¬æ¨¡æ‹Ÿå™¨)ä½¿ç”¨ï¼Œä»¥æ§åˆ¶å·¥å…·çš„æ“ä½œæˆ–è¡Œä¸ºã€‚è¿™äº›å±æ€§è¢«ç§°ä½œattribute. æœ¬å°èŠ‚å°†ä»‹ç»: å¯ä»¥ç”¨äºæŒ‡å®šå±æ€§çš„è¯­æ³•æœºåˆ¶ã€‚ 12345attribute_instance ::= (* attr_spec { , attr_spec } *) attr_spec ::= attr_name [ = constant_expression ]attr_name ::= identifier attribute_instanceï¼š1ã€ä½œä¸ºå£°æ˜ï¼Œæ¨¡å—é¡¹ç›®ï¼Œè¯­å¥æˆ–è€…ç«¯å£è¿æ¥çš„å‰ç¼€ã€‚2ã€è¿ç®—ç¬¦æˆ–åœ¨ä¸€ä¸ªè¡¨è¾¾å¼ä¸­Verilogå‡½æ•°åçš„åç¼€ å¦‚æœæ²¡æœ‰ç»™å±æ€§æŒ‡æ´¾å€¼ï¼Œé‚£ä¹ˆå€¼é»˜è®¤ä¸º1ï¼›å¦‚æœå¯¹ç›¸åŒçš„language elementå®šä¹‰å¤šä¸ªç›¸åŒçš„å±æ€§åå­—ï¼Œé‚£ä¹ˆæœ€åä¸€ä¸ªå±æ€§å€¼å°†è¢«ä½¿ç”¨ï¼›å·¥å…·å¯ä»¥åœ¨è¿™ç§æƒ…å†µä¸‹ç»™ä¸ªwarningã€‚ nesting of attribute instances ä¸è¢«å…è®¸ï¼›ç”¨åŒ…å«å±æ€§å®ä¾‹çš„å¸¸é‡è¡¨è¾¾å¼(constant expression that contains an attribute instance)å»ç»™å±æ€§èµ‹å€¼æ˜¯ä¸åˆæ³•çš„ã€‚ 2.8.1 Examples èŒƒä¾‹1ï¼šç»™caseè¯­å¥è´´ä¸Šå±æ€§ 1234567891011121314151617(* full_case, parallel_case *)case (foo)&lt;rest_of_case_statement&gt;or(* full_case=1 *)(* parallel_case=1 *) // Multiple attribute instances also OKcase (foo)&lt;rest_of_case_statement&gt;or(* full_case, // no value assignedï¼›é»˜è®¤ä¸º1parallel_case=1 *)case (foo)&lt;rest_of_case_statement&gt; èŒƒä¾‹2ï¼šç»™æ¨¡å—å®šä¹‰åŠ å±æ€§ 12(* optimize_power *)module mod1 (&lt;port_list&gt;); èŒƒä¾‹3ï¼šç»™æ¨¡å—å®ä¾‹åŠ å±æ€§ 12(* optimize_power=0 *)mod1 synth1 (&lt;port_list&gt;); èŒƒä¾‹4ï¼šç»™regå£°æ˜åŠ å±æ€§ 1234(* fsm_state *) reg [7:0] state1;(* fsm_state=1 *) reg [3:0] state2, state3;reg [3:0] reg1; // this reg does NOT have fsm_state set(* fsm_state=0 *) reg [3:0] reg2; // nor does this one èŒƒä¾‹5ï¼šç»™æ“ä½œç¬¦åŠ å±æ€§ 12a = b ? (* no_glitch *) c : d;a = b + (* mode = \"cla\" *) c; 2.8.2 Syntax(çœç•¥)","categories":[{"name":"Digital IC","slug":"Digital-IC","permalink":"https://www.beenli.cn/categories/Digital-IC/"},{"name":"verilog","slug":"Digital-IC/verilog","permalink":"https://www.beenli.cn/categories/Digital-IC/verilog/"}],"tags":[{"name":"specification","slug":"specification","permalink":"https://www.beenli.cn/tags/specification/"}]},{"title":"æ•°æ®é€šè·¯(4)--Multiple Issue","slug":"æ•°æ®é€šè·¯-4-Multiple-Issue","date":"2020-09-27T11:04:08.000Z","updated":"2020-09-28T03:50:35.348Z","comments":true,"path":"posts/a36b1d36/","link":"","permalink":"https://www.beenli.cn/posts/a36b1d36/","excerpt":"","text":"Preface æŒ‡ä»¤é›†å¹¶è¡Œ(instruction-level parallelism)æœ‰ä¸¤ç§æ–¹å¼ â… ã€Pipelineâ€”â€”è¯¦è§æ•°æ®é€šè·¯(3)ï¼›æµæ°´çº¿è¶Šæ·±ï¼Œå¹¶è¡Œåº¦è¶Šé«˜ã€‚ â…¡ã€å¤šå‘å°„ï¼ˆmultiple issueï¼‰: æœ¬èŠ‚æ‰€è¦è®²è¿°çš„é‡ç‚¹ã€‚é€šè¿‡å¤åˆ¶è®¡ç®—æœºå†…éƒ¨éƒ¨ä»¶çš„æ•°é‡ï¼Œä½¿å¾—æ¯ä¸ªæµæ°´çº§å¯ä»¥å¯åŠ¨å¤šæ¡æŒ‡ä»¤ å¤šå‘å°„å¯ä»¥ä½¿æŒ‡ä»¤æ‰§è¡Œé€Ÿåº¦è¶…è¿‡æ—¶é’Ÿçš„é€Ÿåº¦ï¼Œå³CPIå°äº1ã€‚ å®ç°å¤šå‘å°„æœ‰ä¸¤ç§åŠæ³•ï¼š1ã€static multiple issueï¼›2ã€dynamic multiple issueã€‚ å¤šå‘å°„æµæ°´çº¿å¿…é¡»å¤„ç†ä»¥ä¸‹ä¸¤ä¸ªé—®é¢˜ï¼š æ‰“åŒ…æŒ‡ä»¤åˆ°å‘å°„æ§½(issue slots)ï¼šåœ¨å¤§å¤šæ•°é™æ€å¤šå‘å°„å®ç°ä¸Šï¼šåœ¨ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸå‘å°„å¤šå°‘æ¡æŒ‡ä»¤ï¼Œå“ªäº›æŒ‡ä»¤è¢«å‘å°„è¿™ä¸ªè¿‡ç¨‹è‡³å°‘å¾ˆå¤§ä¸€éƒ¨åˆ†ç”±ç¼–è¯‘å™¨æ¥å®Œæˆã€‚è€Œåœ¨åŠ¨æ€å‘å°„å¤„ç†å™¨ä¸­ï¼Œè¿™ä¸ªé—®é¢˜ä¸€èˆ¬ç”±å¤„ç†å™¨åœ¨è¿è¡Œæ—¶æ¥å¤„ç†ã€‚ï¼ˆå°½ç®¡ç¼–è¯‘å™¨å·²ç»ä¼˜åŒ–äº†æŒ‡ä»¤é¡ºåºæ¥å°½å¯èƒ½å¤šå‘å°„ï¼‰ å¤„ç†æ•°æ®å’Œæ§åˆ¶å†’é™©ï¼šåœ¨é™æ€å‘å°„å¤„ç†å™¨ä¸­ï¼Œç¼–è¯‘å™¨è§£å†³å¤§éƒ¨åˆ†æˆ–è€…æ‰€æœ‰çš„å¯èƒ½å†’é™©ã€‚ä¸æ­¤ç›¸åçš„ï¼ŒåŠ¨æ€å‘å°„å¤„ç†å™¨ç”¨ç¡¬ä»¶æŠ€æœ¯åœ¨è¿è¡Œæ—¶è‡³å°‘æ¶ˆé™¤æŸäº›ç±»åˆ«çš„å†’é™©ã€‚ å°½ç®¡ï¼Œæˆ‘ä»¬æŠŠå®ƒä»¬æè¿°æˆä¸åŒçš„æ–¹æ³•ï¼Œä½†äº‹å®ä¸Šï¼Œä¸€ä¸ªæ–¹æ³•ç»å¸¸å€ŸåŠ©å¦å¤–ä¸€ä¸ªæ–¹æ³•çš„æŠ€æœ¯ã€‚ Speculation(æ¨æµ‹)speculation: An approach whereby the compiler or processor guesses the outcome of an instruction to remove it as a dependence in executing other instructionsæå‰ç»™å‡ºç»“æœ(çŒœæµ‹)æ¥é¿å…åé¢çš„æŒ‡ä»¤å¯¹æ­£åœ¨è¿è¡ŒæŒ‡ä»¤çš„ä¾èµ– ä»¥ä¸‹æ˜¯å‡ ç§çŒœæµ‹çš„æƒ…å½¢ï¼š æˆ‘ä»¬çŒœæµ‹åˆ†æ”¯çš„ç»“æœï¼Œé‚£æ ·åˆ†æ”¯åé¢çš„æŒ‡ä»¤å¯ä»¥ææ—©æ‰§è¡Œã€‚ æˆ‘ä»¬çŒœæµ‹å­˜å­—å’Œå–å­—æŒ‡ä»¤è®¿é—®çš„ä¸æ˜¯åŒä¸€ä¸ªåœ°å€ï¼Œé‚£æ ·æˆ‘ä»¬åœ¨æ‰§è¡Œå­˜å­—æŒ‡ä»¤å‰å»æ‰§è¡Œå–å­—æŒ‡ä»¤ã€‚ ä½†æ˜¯ï¼ŒçŒœæµ‹å¯èƒ½å‡ºç°é”™è¯¯âŒã€‚æ‰€ä»¥ï¼šä»»ä½•æ¨æµ‹æŠ€æœ¯éƒ½å¿…é¡»åŒ…å«ä¸€ç§æœºåˆ¶ï¼š1ã€æ£€æŸ¥æ¨æµ‹æ˜¯å¦æ­£ç¡®ï¼›2ã€å›æ»šç”±äºæ¨æµ‹æå‰æ‰§è¡Œçš„æŒ‡ä»¤çš„å½±å“ã€‚ æ¨æµ‹é”™è¯¯æ—¶æ¢å¤æœºåˆ¶ï¼š for compile: æ’å…¥é¢å¤–çš„æŒ‡ä»¤æ£€æŸ¥æ¨æµ‹çš„æ­£ç¡®æ€§âœ”å¹¶æä¾›ä¸€ä¸ªfix-upä¾‹ç¨‹ä¾›æ¨æµ‹é”™è¯¯æ—¶ä½¿ç”¨ã€‚ for processor: ç”¨bufferç¼“å­˜æ¨æµ‹ç»“æœç›´åˆ°æ¨æµ‹çš„ç»“æœå¾—åˆ°ç¡®è®¤ã€‚å¦‚æœæ¨æµ‹æ­£ç¡®ï¼ŒæŠŠç¼“å­˜çš„èƒ½å®¹å†™åˆ°ç›¸åº”çš„å¯„å­˜å™¨ä¸­ï¼ŒæŒ‡ä»¤å®Œæˆã€‚å¦‚æœæ¨æµ‹ä¸æ­£ç¡®ï¼Œç¡¬ä»¶å†²åˆ·æ‰bufferï¼Œé‡æ–°æ‰§è¡Œæ­£ç¡®çš„æŒ‡ä»¤åºåˆ—ã€‚ æ¨æµ‹å¯èƒ½å¼•å…¥å¦å¤–çš„é—®é¢˜ï¼šå¯¹æŸäº›æŒ‡ä»¤çš„æ¨æµ‹ä¼šå¯¼è‡´åŸæœ¬ä¸å­˜åœ¨çš„å¼‚å¸¸å‘ç”Ÿã€‚æ¯”å¦‚ï¼Œæ¨æµ‹æ‰§è¡Œä¸€æ¡è£…è½½æŒ‡ä»¤ï¼Œåœ¨æ¨æµ‹é”™è¯¯çš„æƒ…å†µä¸‹ï¼Œè¯¥æŒ‡ä»¤æ‰€ä½¿ç”¨çš„åœ°å€æ˜¯éæ³•çš„ã€‚ Static multiple-issueStatic multiple-issue processers all use the compiler to assist with packaging instructions and handling hazards. issue packet(å‘å°„åŒ…)ï¼šåœ¨ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸå†…å¯ä»¥å‘å°„çš„æŒ‡ä»¤é›†åˆï¼Œå¯ä»¥ç”¨ä¸€æ¡å®Œæˆå¤šç§æ“ä½œçš„é•¿æŒ‡ä»¤æ¥ç±»æ¯” Very Long Instruction Word(è¶…é•¿æŒ‡ä»¤å­—)ï¼šä¸€ç§æŒ‡ä»¤é›†æ¶æ„ï¼Œèƒ½å¤Ÿå‘å°„å¤šæ¡æ“ä½œï¼Œè¿™äº›æ“ä½œåœ¨å•ä¸ªæŒ‡ä»¤ä¸­è¢«å®šä¹‰ä¸ºç‹¬ç«‹çš„ï¼Œå¹¶ä¸”ä¸€èˆ¬éƒ½æœ‰ç‹¬ç«‹çš„æ“ä½œç åŸŸã€‚ é™æ€å¤šå‘å°„å¤„ç†å™¨æœ‰ä¸¤ç§ï¼š ç¼–è¯‘å™¨é¿å…æ‰€æœ‰å†’é™©ï¼› ç¡¬ä»¶æ£€æµ‹æ•°æ®å†’é™©ï¼Œå¹¶åœ¨ä¸¤ä¸ªå‘å°„åŒ…é—´äº§ç”Ÿé˜»å¡ï¼Œè€Œç¼–è¯‘å™¨åªè´Ÿè´£é¿å…ä¸€ä¸ªæŒ‡ä»¤åŒ…é—´çš„ä¾èµ–ã€‚ ä¸ºäº†å¹¶è¡Œå‘å°„ALUå’Œæ•°æ®ä¼ è¾“æ“ä½œï¼Œéœ€è¦æœ‰é¢å¤–çš„ç¡¬ä»¶ï¼š å¯„å­˜å™¨å †è¦æœ‰é¢å¤–çš„ç«¯å£ä¾›è¿ä¸ªæ“ä½œè¯»å–æ“ä½œæ•°ï¼› è¦æœ‰é¢å¤–çš„ALUæ¥åŒæ—¶æ‰§è¡ŒEXé˜¶æ®µã€‚ å¤šå‘å°„å¸¦æ¥çš„é—®é¢˜ï¼šç”±äºé¢å¤–çš„æŒ‡ä»¤é‡å ï¼Œå†’é™©çš„å¯èƒ½æ€§åŠ å€ã€‚ è£…è½½æŒ‡ä»¤æœ‰ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸçš„ä½¿ç”¨å»¶è¿Ÿï¼ˆuse latency)ï¼›è¿™æ„å‘³ç€ä¸‹ä¸€ä¸ªå‘å°„åŒ…ä¸­æ‰€æœ‰æŒ‡ä»¤éƒ½ä¸èƒ½ä½¿ç”¨è£…è½½çš„ç»“æœã€‚ åŸæœ¬æ²¡æœ‰ä½¿ç”¨å»¶è¿Ÿçš„ALUæŒ‡ä»¤ï¼Œå…¶ç»“æœä¸èƒ½è¢«åœ¨åŒä¸€ä¸ªå‘å°„åŒ…çš„å…¶ä»–æŒ‡ä»¤ä½¿ç”¨ã€‚ å¾ªç¯å±•å¼€(loop unrolling)ï¼šä¸€ç§ä»è®¿é—®æ•°ç»„çš„å¾ªç¯ç¨‹åºä¸­è·å¾—æ›´å¤šæ€§èƒ½çš„æŠ€æœ¯ã€‚å…¶ä¸­å¾ªç¯ä½“ä¼šè¢«å¤åˆ¶å¤šä»½å¹¶ä¸”åœ¨ä¸åŒå¾ªç¯ä½“ä¸­çš„æŒ‡ä»¤ä¼šè°ƒåº¦åœ¨ä¸€èµ·ã€‚ 123456/***************** ä¾‹ç¨‹ï¼šæŠŠä¸€æ®µæ•°ç»„ä¸­çš„æ•°å…¨éƒ¨åŠ ä¸Šä¸€ä¸ªæ•°(x21) ********************/Loop: ld x31, 0(x20) // x31=array element add x31, x31, x21 // add scalar in x21 sd x31, 0(x20) // store result addi x20, x20, -8 // decrement pointer blt x22, x20, Loop // compare to loop limit,branch if x20 &gt; x22 ä¸è¿›è¡Œå¾ªç¯å±•å¼€çš„é™æ€å¤šå‘å°„è°ƒåº¦ï¼š å¾ªç¯å±•å¼€ç»“æœï¼š åœ¨å¾ªç¯å±•å¼€è¿‡ç¨‹ä¸­ï¼Œç¼–è¯‘å™¨å¼•å…¥äº†å‡ ä¸ªä¸´æ—¶ç¼–è¯‘å™¨ï¼ˆx28ã€x29ã€x30ï¼‰ã€‚è¿™ä¸ªè¿‡ç¨‹å«åšå¯„å­˜å™¨é‡å‘½å: ç›®çš„æ˜¯æ¶ˆé™¤ä¸€äº›è™šå‡ä¾èµ–ã€‚ å¦‚æœæˆ‘ä»¬åªä½¿ç”¨x31å¯„å­˜å™¨ï¼šæˆ‘ä»¬å°†åœ¨sd x31,8(x20)åé¢é‡å¤ld x31,0(x20), add x31, x31, x21ã€‚ä½†æ˜¯è¿™äº›åºåˆ—å°½ç®¡éƒ½ä½¿ç”¨x31ï¼Œå®ƒä»¬å®é™…ä¸Šæ˜¯ä¸ç›¸å…³çš„ã€‚ antidependence or name dependence(åç›¸å…³æˆ–åå­—ç›¸å…³)ï¼šä¸€ç»„æŒ‡ä»¤é›†å’Œä¸‹ä¸€ç»„æŒ‡ä»¤é›†ä¹‹é—´no data value flowï¼Œä»…ä»…æ˜¯å› ä¸ºé‡ç”¨å¯„å­˜å™¨åå¼•èµ·çš„ç›¸å…³ã€‚ Dynamic multiple-issueDynamic multiple-issue processors are also known as superscalar processors, or simply superscalars Basic conceptæœ€ç®€å•çš„è¶…æ ‡é‡å¤„ç†å™¨ï¼šæŒ‡ä»¤æŒ‰é¡ºåºå‘å°„ï¼Œå¤„ç†å™¨å†³å®šæ¯ä¸ªå‘¨æœŸå‘å°„0æ¡ï¼Œ1æ¡æˆ–å¤šæ¡æŒ‡ä»¤ã€‚ æ˜¾ç„¶ä¸ºäº†è·å¾—å¥½çš„æ€§èƒ½ï¼Œå¤„ç†å™¨ä»ç„¶éœ€è¦ç¼–è¯‘å™¨å¸®å¿™ç¼–æ’æŒ‡ä»¤é¡ºåºæ¥å‡å°‘ä¾èµ–ã€‚ ç®€å•è¶…æ ‡é‡å¤„ç†å™¨ä¸VLIWå¤„ç†å™¨(é™æ€å‘å°„)çš„åŒºåˆ«ï¼š for superscalar:ï¼š1ã€ä¸ç®¡æ˜¯å¦ç»è¿‡ç¼–è¯‘å™¨ç¼–æ’æŒ‡ä»¤é¡ºåºï¼Œéƒ½ç”±ç¡¬ä»¶æ¥ä¿è¯æ‰§è¡Œçš„æ­£ç¡®æ€§âœ”ã€‚2ã€ç¼–è¯‘è¿‡çš„ä»£ç å°†å§‹ç»ˆæ­£ç¡®çš„è¿è¡Œï¼Œæ— è®ºå‘å°„é€Ÿç‡è¿˜æ˜¯æµæ°´çº¿æ¶æ„ã€‚ for VLIWï¼šä¸åƒğŸ‘†é‚£æ ·ï¼Œå½“ç§»æ¤åˆ°ä¸åŒçš„å¤„ç†å™¨æ¨¡å‹å¾€å¾€éœ€è¦é‡æ–°ç¼–è¯‘ã€‚åœ¨å…¶ä»–çš„é™æ€å‘å°„å¤„ç†å™¨ä¸­ï¼Œä»£ç èƒ½å¤Ÿåœ¨ä¸åŒçš„å¤„ç†å™¨å®ç°ä¸Šæ­£ç¡®è¿è¡Œï¼Œä½†æ˜¯æ•ˆç‡å¾ˆå·®ä¹Ÿéœ€è¦é‡æ–°ç¼–è¯‘ã€‚ è®¸å¤šè¶…æ ‡é‡å¤„ç†å™¨æ‰©å±•äº†åŸºæœ¬çš„åŠ¨æ€å‘å°„ç­–ç•¥ï¼Œå°†dynamic pipeline scheduling(åŠ¨æ€æµæ°´çº¿è°ƒåº¦)åŒ…å«è¿›æ¥ã€‚ 12345/*************** ä¸€ä¸ªç®€å•çš„ä¾‹å­ **************/ld x31, 0(x21)add x1, x31, x2sub x23, x23, x3andi x5, x23, 20 è¯´æ˜ï¼šå³ä½¿subæŒ‡ä»¤å‡†å¤‡å¥½æ‰§è¡Œï¼Œå®ƒä¹Ÿå¿…é¡»ç­‰å¾…ldå’ŒaddæŒ‡ä»¤å…ˆç»“æŸæ‰è¡Œã€‚å¦‚æœå†…å­˜å¾ˆæ…¢ï¼ŒsubæŒ‡ä»¤å¯èƒ½ä¼šç­‰å¾…å¤šä¸ªå‘¨æœŸï¼ˆæ¯”å¦‚cacheæ²¡æœ‰å‘½ä¸­ï¼‰ dynamic pipeline scheduling Dynamic pipeline scheduling chooses which instructions to execute next, possibly reordering them to avoid stalls.åŠ¨æ€è°ƒåº¦å¯ä»¥è¿è¡Œæ—¶åŠ¨æ€è°ƒæ•´æŒ‡ä»¤é¡ºåº æµæ°´çº¿è¢«åˆ†ä¸ºä¸‰ä¸ªä¸»è¦éƒ¨åˆ†ï¼š an instruction fetch and issue unitï¼ˆå–æŒ‡å‘å°„å•å…ƒ) multiple functional unitsï¼ˆå¤šç§åŠŸèƒ½å•å…ƒï¼‰ commit unit(æäº¤å•å…ƒ) æ¯ä¸ªåŠŸèƒ½å•å…ƒæœ‰ä¸ªbuffer, ç§°ä¸ºä¿ç•™ç«™ï¼ˆreservation station)ï¼Œå…¶ä¸­ä¿å­˜ç€æ“ä½œæ•°å’Œæ“ä½œ(opcode â“)ã€‚ åŠŸèƒ½å•å…ƒè¿ç®—å®Œæˆçš„ç»“æœä¼ é€ç»™1ã€commit unitï¼›2ã€æ—è·¯ç»™æ‰€éœ€çš„ä¿ç•™ç«™ã€‚ æäº¤å•å…ƒä¹Ÿæœ‰bufferï¼Œç§°ä¸ºreorder buffer(é‡æ’åºç¼“å†²åŒº)ï¼šç¼“å­˜ç»“æœç›´åˆ°ç¡®å®šæ˜¯å®‰å…¨æ—¶æ‰å†™å…¥register fileæˆ–è€…memoryã€‚ ä¿ç•™ç«™ç¼“å­˜æ“ä½œæ•°â•æäº¤å•å…ƒç¼“å­˜ç»“æœï¼ï¼ã€‹å¯„å­˜å™¨é‡å‘½å å‘å°„æŒ‡ä»¤æ—¶ï¼Œå®ƒè¢«å¤åˆ¶åˆ°å¯¹åº”åŠŸèƒ½å•å…ƒçš„ä¿ç•™ç«™ä¸Šï¼Œå¦‚æœå®ƒçš„æ“ä½œæ•°åœ¨å¯„å­˜å™¨å †æˆ–è€…æäº¤å•å…ƒç¼“å†²åŒºä¸­æœ‰ï¼Œé‚£ä¹ˆæ“ä½œæ•°ç«‹é©¬å¤åˆ¶åˆ°ä¿ç•™ç«™ã€‚å¦‚æœæŒ‡ä»¤å·²ç»å‘å°„ï¼Œé‚£ä¹ˆå¯¹åº”æ“ä½œæ•°çš„å‰¯æœ¬ä¸å†éœ€è¦ï¼Œå¯ä»¥é‡å†™è¦†ç›–ã€‚ å¦‚æœä¸€ä¸ªæ“ä½œæ•°ä¸åœ¨register file or reorder bufferï¼Œä»–å¿…é¡»ç­‰å¾…æŸä¸ªåŠŸèƒ½å•å…ƒçš„ç»“æœã€‚ç¡¬ä»¶å¸®åŠ©è¿½è¸ªæ‰€éœ€çš„åŠŸèƒ½å•å…ƒï¼Œå½“å•å…ƒè®¡ç®—å‡ºç»“æœç›´æ¥å¤åˆ¶åˆ°ä¿ç•™ç«™è€Œæ—è·¯æ‰å¯„å­˜å™¨å †ã€‚ out-of-order execution(ä¹±åºæ‰§è¡Œ)ï¼šå¤„ç†å™¨åœ¨ä¸è¿èƒŒåŸæœ‰æ•°æ®æµé¡ºåºçš„å‰æä¸‹ä»¥æŸç§é¡ºåºæ‰§è¡Œå„æ¡æŒ‡ä»¤ï¼Œä½†æ˜¯æ‰§è¡ŒæŒ‡ä»¤çš„é¡ºåºå¯ä»¥ä¸å–æŒ‡ä¸åŒã€‚ in-order commit(é¡ºåºæäº¤)ï¼šæµæ°´çº¿æ‰§è¡Œçš„ç»“æœä»¥å–æŒ‡é¡ºåºå†™å›ç¨‹åºå‘˜å¯è§çš„å¯„å­˜å™¨çš„ä¸€ç§æäº¤æ–¹å¼ã€‚ï¼ˆå½“å¼‚å¸¸å‘ç”Ÿæ—¶ï¼Œå¤„ç†å™¨å¯ä»¥æ‰¾åˆ°æœ€åæ‰§è¡Œçš„é‚£æ¡æŒ‡ä»¤ï¼Œè€Œåªæœ‰è¿™æ¡å¯¼è‡´å¼‚å¸¸çš„æŒ‡ä»¤ä¹‹å‰çš„æŒ‡ä»¤æ‰èƒ½å¯¹å¯„å­˜å™¨çŠ¶æ€è¿›è¡Œæ”¹å˜ã€‚ æ¨æµ‹å’ŒåŠ¨æ€è°ƒåº¦ç»å¸¸ç»“åˆåœ¨ä¸€èµ·ï¼š é€šè¿‡å¯¹åˆ†æ”¯çš„é¢„æµ‹ï¼ŒåŠ¨æ€è°ƒåº¦å¯ä»¥åœ¨æ¨æµ‹æ–¹å‘ä¸Šè¿›è¡Œå–æŒ‡å’Œæ‰§è¡Œã€‚ç”±äºæŒ‡ä»¤æ˜¯é¡ºåºæäº¤ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åˆ†æ”¯æŒ‡ä»¤åŠæ‰€æœ‰æ¨æµ‹æ‰§è¡Œçš„æŒ‡ä»¤æäº¤å‰çŸ¥é“æ¨æµ‹æ˜¯å¦å‡†ç¡®ã€‚ é€šè¿‡å¯¹è£…è½½æŒ‡ä»¤ç›®çš„åœ°å€çš„é¢„æµ‹ï¼Œå¯¹å­˜å–æŒ‡ä»¤è¿›è¡Œé‡æ’åºå’Œåˆ©ç”¨æäº¤å•å…ƒé¿å…é”™è¯¯çš„æ¨æµ‹ã€‚","categories":[{"name":"CS","slug":"CS","permalink":"https://www.beenli.cn/categories/CS/"},{"name":"Computer Organization & Design","slug":"CS/Computer-Organization-Design","permalink":"https://www.beenli.cn/categories/CS/Computer-Organization-Design/"}],"tags":[{"name":"processor","slug":"processor","permalink":"https://www.beenli.cn/tags/processor/"}]},{"title":"æ•°æ®é€šè·¯(3)--Pipeline & hazards","slug":"æ•°æ®é€šè·¯-3-Pipeline-hazards","date":"2020-09-25T10:32:54.000Z","updated":"2020-09-27T11:48:50.997Z","comments":true,"path":"posts/d4768fc/","link":"","permalink":"https://www.beenli.cn/posts/d4768fc/","excerpt":"","text":"1ã€An Overview of Pipeline æµæ°´çº¿å°±åƒå·¥å‚çš„å·¥äººä¸€æ ·ï¼Œæ¯ä¸ªå·¥äººåªåšä¸€é“å·¥åºï¼ˆæ¯ä¸ªç¡¬ä»¶åªåšä¸€ä¸ªåŠŸèƒ½)ï¼ŒåŒä¸€æ—¶é—´å‡ é“å·¥åºåŒæ—¶åœ¨åš(åŒä¸€æ—¶é—´å¤šæ¡æŒ‡ä»¤åŒæ—¶æ‰§è¡Œï¼Œæ¯æ¡æŒ‡ä»¤åœ¨ä¸åŒçš„é˜¶æ®µ)ï¼Œæœ€åä¸€é“å·¥åºåšå®Œå³å®Œæˆäº†ä¸€ä»¶äº§å“(æ‰€ä»¥ååé‡éå¸¸å¤§)ã€‚ RISC-Vç»å…¸æµæ°´çº¿å¯ä»¥åˆ†ä¸ºäº”æ­¥ Fetch instruction from memoryï¼ˆIF) Read register and decode the instruction(ID) Execute the operation or calculate an address(EX) Access an operand in data memory (MEM) [if necessary] Write the result into a register(WB) [if necessary] é¢å‘æµæ°´çº¿çš„æŒ‡ä»¤é›†è®¾è®¡ RISC-V æŒ‡ä»¤ç­‰é•¿ï¼Œè¿™ä¸€é™åˆ¶ç®€åŒ–äº†ç¬¬ä¸€çº§å–æŒ‡ä¸ç¬¬äºŒçº§è¯‘ç ã€‚ ã€x86æŒ‡ä»¤é•¿åº¦ä¸ç­‰ï¼Œä»1å­—èŠ‚åˆ°15å­—èŠ‚ä¸ç­‰ã€‚æœ€è¿‘x86ä½“ç³»ç»“æ„ï¼šå…ˆè½¬åŒ–ä¸ºç®€å•çš„æ“ä½œã€‘ RISC-Våªæœ‰å‡ ç§æŒ‡ä»¤æ ¼å¼ï¼Œæ¯ä¸€ç§æŒ‡ä»¤æºå’Œç›®çš„å¯„å­˜å™¨å­—æ®µä½ç½®ä¸å˜ã€‚ ã€ä½¿å¾—ç¬¬äºŒçº§åœ¨ç¡®å®šæŒ‡ä»¤ç±»å‹çš„åŒæ—¶å¼€å§‹è¯»å¯„å­˜å™¨å †ã€‘ RISC-Vçš„memory operandsä»…ä»…å‡ºç°åœ¨å­˜å–æŒ‡ä»¤ä¸­(å¸¸è§„ALUæŒ‡ä»¤çš„æ“ä½œæ•°ç›´æ¥åœ¨ç¬¬äºŒçº§å¯„å­˜å™¨å †è¯»å‡º)ã€‚æ„å‘³ç€æˆ‘ä»¬å¯ä»¥åœ¨æ‰§è¡Œé˜¶æ®µè®¡ç®—å†…å­˜åœ°å€ï¼Œç„¶ååœ¨ä¸‹ä¸€ä¸ªé˜¶æ®µè®¿å­˜ã€‚ ã€å¦‚æœåƒx86é‚£æ ·å¯ä»¥æ“ä½œåœ¨å†…å­˜ä¸­çš„æ“ä½œæ•°ï¼Œé‚£ä¹ˆç¬¬ä¸‰ã€å››çº§å°†æ‰©å±•ä¸ºaddress stageï¼Œmemory stageï¼Œexecute stageã€‘ æµæ°´çº¿æ§åˆ¶ 2ã€Pipeline Hazards There are situation in pipelining when the next instruction cannot execute in the following clock cycle. These events are called hazards. 1ã€Structural HazardWhen a planned instruction cannot execute in the proper clock cycle because the hardware does not support the combination of instructions that are set to execute [ç”±äºç¡¬ä»¶èµ„æºä¸å¤Ÿå¯¼è‡´çš„å†’é™©] è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬æˆ‘ä»¬çš„IFå’ŒMEMåˆ†å¼€ï¼ˆæŒ‡ä»¤å¯„å­˜å™¨å’Œæ•°æ®å¯„å­˜å™¨ï¼‰ 2ã€Data HazardWhen a planned instruction cannot execute in the proper clock cycle because data that are needed to execute the instruction are not yet available [ç”±äºæ“ä½œæ•°æ²¡æœ‰å‡†å¤‡å¥½å¯¼è‡´çš„å†’é™©] ä¸‰ç§ç»å…¸è§£å†³åŠæ³• Reorder code(é‡æ–°å®‰æ’ä»£ç ) stall the pipeline(é˜»å¡ä¸€ä¸ªæˆ–å‡ ä¸ªå‘¨æœŸ) bypass or forwarding(æ—è·¯æˆ–è€…å‰æ¨ä¸Šä¸€æ¡æŒ‡ä»¤è¿ç®—çš„ç»“æœ) â‘ Reorder code1234567891011121314151617181920//code segment in Ca = b + e;c = b + f;//generated RISC-V code for above segmentld x1, 0(x31) // Load b 1ld x2, 8(x31) // Load e 2add x3, x1, x2 // b + e 3sd x3, 24(x31) // Store a 4ld x4, 16(x31) // Load f 5add x5, x1, x4 // b + f 6sd x5, 32(x31) // Store c 7/************** è¯´æ˜ *****************1ã€é€šè¿‡æ—è·¯å¯ä»¥å»é™¤3å¯¹1çš„ä¾èµ–(load æŒ‡ä»¤æœ€å°‘éœ€è¦ä¸¤ä¸ªå‘¨æœŸï¼ŒALUæŒ‡ä»¤åœ¨æ—è·¯æŠ€æœ¯ä¸‹å¯¹ä¸‹ä¸€æ¡æŒ‡ä»¤ä¸ä¼šæ„æˆæ•°æ®å†’é™©ï¼‰2ã€é€šè¿‡æ—è·¯ä¹Ÿå¯è§£å†³sdæŒ‡ä»¤å¯¹ä¸Šä¸€æ¡addæŒ‡ä»¤çš„ä¾èµ–3ã€éœ€è¦è§£å†³çš„: 3V2å’Œ6V5 *///************* è§£å†³åŠæ³• ***************æŠŠç¬¬5æ¡æŒ‡ä»¤æåˆ°ç¬¬äºŒæ¡æŒ‡ä»¤å’Œç¬¬ä¸‰æ¡ä¸­é—´ã€‚ â‘¡Bypassing andæŒ‡ä»¤éœ€è¦x2ï¼Œè€Œx2åªæœ‰ç­‰åˆ°ç¬¬ä¸€æ¡æŒ‡ä»¤å†™å›æ‰æœ‰æ•ˆ(å³ç¬¬äº”ä¸ªå‘¨æœŸå‰åŠæ®µ) åŒç†oræŒ‡ä»¤ â“å‡è®¾: å†™å¯„å­˜å™¨æ“ä½œå‘ç”Ÿæ—¶é’Ÿå‘¨æœŸçš„å‰åŠæ®µè€Œè¯»å¯„å­˜å™¨æ“ä½œå‘ç”Ÿåœ¨æ—¶é’Ÿå‘¨æœŸååŠæ®µ æ—è·¯çš„æ ¸å¿ƒï¼šå‰ä¸€æ¡æŒ‡ä»¤è®¡ç®—çš„ç»“æœä¸ç”¨ç­‰åˆ°ç¬¬äº”å‘¨æœŸå†™å›å¯„å­˜å™¨å †è€Œæå‰æ—è·¯åˆ°å…¶åæŒ‡ä»¤çš„ALUæ“ä½œæ•°è¾“å…¥ä¸Šã€‚ EXå†’é™©ï¼ˆEX/MEMæµæ°´çº¿å¯„å­˜å™¨æœ‰éœ€è¦çš„å€¼ï¼‰ 1234567if (EX/MEM.RegWriteand (EX/MEM.RegisterRd â‰  0)and (EX/MEM.RegisterRd = ID/EX.RegisterRs1)) ForwardA = 10if (EX/MEM.RegWriteand (EX/MEM.RegisterRd â‰  0)and (EX/MEM.RegisterRd = ID/EX.RegisterRs2)) ForwardB = 10 MEM hazard 123456789101112if (MEM/WB.RegWriteand (MEM/WB.RegisterRd â‰  0)and not(EX/MEM.RegWrite and (EX/MEM.RegisterRd â‰  0)and (EX/MEM.RegisterRd = ID/EX.RegisterRs1)) // å…ˆåˆ¤æ–­ä¸æ˜¯EXå†’é™©ï¼Œä¸ç„¶åº”è¯¥æ˜¯æ—è·¯ä¸Šä¸€æ¡æŒ‡ä»¤EX/MEMç»“æœæ—è·¯ä¸Šä¸Šæ¡MEM/WBand (MEM/WB.RegisterRd = ID/EX.RegisterRs1)) ForwardA = 01if (MEM/WB.RegWriteand (MEM/WB.RegisterRd â‰  0)and not(EX/MEM.RegWrite and (EX/MEM.RegisterRd â‰  0)and (EX/MEM.RegisterRd = ID/EX.RegisterRs2))and (MEM/WB.RegisterRd = ID/EX.RegisterRs2)) ForwardB = 01 æ—è·¯å•å…ƒäº§ç”Ÿæ§åˆ¶ä¿¡å·é€‰ç€ALUçš„è¾“å…¥operandã€‚ â‘¢Stallséœ€è¦é˜»å¡çš„æƒ…å½¢ï¼šå½“ä¸€æ¡æŒ‡ä»¤è¯•å›¾è¯»å–ä¸€ä¸ªç”±å‰ä¸€æ¡è£…è½½æŒ‡ä»¤è¯»å…¥çš„å¯„å­˜å™¨æ—¶ï¼Œå°±æ— æ³•ä½¿ç”¨æ—è·¯è§£å†³å†’é™©(å› ä¸ºlwæŒ‡ä»¤éœ€è¦åœ¨ç¬¬å››é˜¶æ®µæ‰èƒ½äº§ç”Ÿç»“æœ) å†’é™©æ£€æµ‹å•å…ƒ 1234if (ID/EX.MemRead and ((ID/EX.RegisterRd = IF/ID.RegisterRs1) or (ID/EX.RegisterRd = IF/ID.RegisterRs2)))stall the pipeline æ£€æµ‹å•å…ƒå·¥ä½œåœ¨IDé˜¶æ®µã€‚ é˜»å¡åé¢æŒ‡ä»¤çš„æ–¹æ³•ï¼šä¿æŒPCå¯„å­˜å™¨å’ŒIF/IDæµæ°´çº¿å¯„å­˜å™¨ä¸å˜ã€‚ æ’å…¥ä¸€æ¡ç©ºæŒ‡ä»¤ï¼ˆnop)ï¼šä¸€ç§ä¸è¿›è¡Œä»»ä½•æ“ä½œæˆ–ä¸æ”¹å˜ä»»ä½•çŠ¶æ€çš„æŒ‡ä»¤ã€‚ å®ç°æ–¹æ³•ï¼šæ§åˆ¶ä¿¡å·å…¨éƒ¨ç½®ä¸º0ï¼Œè¿™äº›æ§åˆ¶ä¿¡å·åœ¨æ¯ä¸ªæ—¶é’Ÿå‘¨æœŸéƒ½å‘å‰ä¼ é€’ï¼Œä½†ä¸ä¼šäº§ç”Ÿä¸è‰¯å½±å“ï¼Œå› ä¸ºæ§åˆ¶ä¸º0ï¼Œé‚£ä¹ˆæ‰€æœ‰å¯„å­˜å™¨å’Œå­˜å‚¨å™¨éƒ½ä¸è¿›è¡Œå†™æ“ä½œã€‚ 3ã€Control HazardAn instruction must be fetched at every clock cycle to sustain the pipeline, yet in our design the decision about whether to branch doesn't occur until the MEM pipeline stage.(åé¢çš„ä¼˜åŒ–ğŸ™†â€çœ‹åˆ°åœ¨IDçº§å°±å¯ä»¥ç¡®å®šåˆ†æ”¯) [ç”±äºé€‰æ‹©âœ”çš„æŒ‡ä»¤éœ€è¦å»¶è¿Ÿ] â‘ Branch å‡å®šåˆ†æ”¯ä¸å‘ç”Ÿï¼ˆå¦‚æœå‘ç”Ÿé¢„å–å’Œè¯‘ç çš„æŒ‡ä»¤è¦ä¸¢å¼ƒï¼‰ ç¼©çŸ­åˆ†æ”¯å»¶è¿Ÿï¼ˆææ—©ç¡®å®šåˆ†æ”¯ï¼Œå‡å°‘flushçš„æŒ‡ä»¤æ•°ï¼‰ è®¡ç®—åˆ†æ”¯ç›®æ ‡åœ°å€ï¼ˆIF/IDæµæ°´çº¿å¯„å­˜å™¨å·²ç»æœ‰äº†PCå’Œç«‹å³æ•°å­—æ®µçš„å€¼ï¼‰ åˆ¤æ–­åˆ†æ”¯æ¡ä»¶ï¼šéœ€è¦é¢å¤–çš„æ—è·¯å’Œå†’é™©æ£€æµ‹ç¡¬ä»¶ã€‚ã€å› ä¸ºåˆ†æ”¯æ¡ä»¶çš„åˆ¤æ–­å¯èƒ½ä¾èµ–äºè¿˜åœ¨æµæ°´çº¿ä¸­çš„ç»“æœã€‘ ä¸¤ä¸ªéš¾ç‚¹ï¼š â… ã€å‰é¢çš„ALUæ—è·¯å•å…ƒåœ¨EXçº§ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦ä¸€ä¸ªæ–°çš„æ—è·¯å•å…ƒå·¥ä½œåœ¨IDçº§ã€‚è¿˜éœ€è¦ä¸€ä¸ªequality test logicï¼ˆå¯¹ä¸¤ä¸ªå¯„å­˜å™¨çš„å€¼æŒ‰ä½å¼‚æˆ–æ¥ç€æˆ–æ“ä½œï¼‰ â…¡ã€å¯èƒ½æ•°æ®åœ¨IDçº§æ—è·¯ä¸è¿‡æ¥ã€‚ä¸Šä¸€æ¡æ˜¯ALUæŒ‡ä»¤ï¼Œé‚£ä¹ˆåªèƒ½stall a cycleï¼›å¦‚æœæ˜¯lwæŒ‡ä»¤ï¼Œé‚£ä¹ˆå¿…é¡»stall two cyclesã€‚ â…¢ã€æ§åˆ¶ä¿¡å·æ–°å¢ä¸€ä¸ªIF.flushä¿¡å·ï¼ŒæŠŠé¢„å–çš„é‚£æ¡æŒ‡ä»¤å˜æˆnopæŒ‡ä»¤ã€‚ åŠ¨æ€åˆ†æ”¯é¢„æµ‹(ç¼“å­˜ä¹‹å‰è¿è¡Œåˆ†æ”¯çš„ä¿¡æ¯è¿›è¡Œåˆ¤æ–­)fetching new instructions from the same places as the last time.) åˆ†æ”¯é¢„æµ‹ç¼“å­˜(branch prediction buffer)ä¹Ÿç§°ä¸ºåˆ†æ”¯å†å²è®°å½•è¡¨(branch history table):ä½¿ç”¨åˆ†æ”¯æŒ‡ä»¤åœ°å€åœ°ä½ç´¢å¼•çš„ä¸€å°å—å­˜å‚¨åŒºã€‚ è¿™ç±»ç¼“å­˜æˆ‘ä»¬å®é™…ä¸Šä¸çŸ¥é“é¢„æµ‹æ˜¯å¦æ­£ç¡®ï¼Œè€Œä¸”å®ƒè¿˜å¯èƒ½ç”±å…¶ä»–å…·æœ‰ç›¸åŒåœ°å€åœ°ä½çš„åˆ†æ”¯è®¾ç½®ã€‚ é¢„æµ‹é”™è¯¯âŒæ—¶ï¼Œé”™è¯¯çš„é¢„å–æŒ‡ä»¤åˆ é™¤ï¼Œé¢„æµ‹ä½å–åï¼Œå›åˆ°åŸæ¥çš„ä½ç½®ï¼ˆâ“å¾—æœ‰ç¼“å­˜ï¼‰ï¼Œç»§ç»­æŒ‰ç…§æ­£ç¡®çš„æ–¹å‘å–æŒ‡å¹¶æ‰§è¡Œã€‚ åˆ†æ”¯é¢„æµ‹ç¼“å­˜å¯ä»¥ç”¨å¾ˆå°ï¼Œç”¨æŒ‡ä»¤åœ°å€è®¿é—®çš„special buffer in IF pipe stageã€‚å¦‚æœé¢„æµ‹åˆ†æ”¯ï¼Œé‚£ä¹ˆä»åˆ†æ”¯targetå–æŒ‡ä»¤ã€‚ ä¸ºäº†æ”¹å–„éå¸¸æœ‰è§„å¾‹çš„åˆ†æ”¯çš„é¢„æµ‹æ­£ç¡®ç‡ï¼ˆæ¯”å¦‚å¾ªç¯ï¼Œ9æ¬¡åˆ†æ”¯åªæœ‰æœ€åä¸€æ¬¡å¾ªç¯é€€å‡ºä¸åˆ†æ”¯ï¼‰ï¼›å¯ä»¥ä½¿ç”¨ä¸¤ä½çš„é¢„æµ‹æœºåˆ¶ã€‚ ç›¸å…³é¢„æµ‹å™¨ï¼ˆcorrelation predictors)ï¼šä¸ä»…ä½¿ç”¨local branchçš„ä¿¡æ¯ï¼Œè¿˜ç»¼åˆglobal behavior of recently executed branches ã€‚å…¸å‹çš„ç›¸å…³é¢„æµ‹å™¨ä¸ºæ¯ä¸ªåˆ†æ”¯æä¾›ä¸¤ä¸ªä¸¤ä½çš„é¢„æµ‹å™¨ï¼Œæ ¹æ®ä¸Šä¸€æ¬¡åˆ†æ”¯æ˜¯å¦æ‰§è¡Œé€‰æ‹©å…¶ä¸­ä¸€ä¸ªé¢„æµ‹å™¨ï¼Œå› æ­¤å…¨å±€åˆ†æ”¯è¡Œä¸ºå¯ä»¥çœ‹æˆadding additional index bits for the prediction lookup. ç«äº‰é¢„æµ‹å™¨(tournament branch predictor)ï¼šä¸ºæ¯ä¸ªåˆ†æ”¯ä½¿ç”¨å¤šä¸ªé¢„æµ‹å™¨ï¼Œå¹¶è®°å½•å“ªä¸ªé¢„æµ‹å™¨é¢„æµ‹ç»“æœæœ€å¥½ã€‚å…¸å‹çš„ç«äº‰é¢„æµ‹å™¨ï¼šå¯¹æ¯ä¸ªåˆ†æ”¯ç´¢å¼•åŒ…å«ä¸¤ä¸ªé¢„æµ‹ç»“æœï¼Œä¸€ä¸ªåŸºäºæœ¬åœ°ä¿¡æ¯ï¼Œä¸€ä¸ªåŸºäºå…¨å±€åˆ†æ”¯è¡Œä¸ºã€‚ä¸€ä¸ªé€‰æ‹©å™¨é€‰æ‹©å“ªä¸ªä½œä¸ºé¢„æµ‹ç»“æœã€‚ æ¡ä»¶ç§»åŠ¨æŒ‡ä»¤(conditional move instruction)ï¼šä¸åŒäºåˆ†æ”¯æŒ‡ä»¤æ”¹å˜PCå€¼ï¼Œæ¡ä»¶ç§»åŠ¨æŒ‡ä»¤å°†æ ¹æ®æ¡ä»¶æ”¹å˜moveæŒ‡ä»¤çš„ç›®çš„å¯„å­˜å™¨ã€‚åœ¨ARMv8æŒ‡ä»¤é›†æ¶æ„ä¸­ï¼šCSEL X8, X11,X4,NE å¦‚æœæ¡ä»¶ç ä¸ä¸ºé›¶ï¼Œå¤åˆ¶x11åˆ°x8ï¼›å¦åˆ™å¤åˆ¶X4åˆ°X8; â‘¡ExceptionControl is the most challenging aspect of processor design: it is both the hardest part to get right and toughest part to make fastç„¶è€Œæ§åˆ¶ä¸­æœ€éš¾çš„å°±æ˜¯å®ç°å¼‚å¸¸æˆ–ä¸­æ–­â€”â€”é™¤åˆ†æ”¯å¤–æ”¹å˜æ­£å¸¸æŒ‡ä»¤æ‰§è¡Œæµ å½“å¼‚å¸¸å‘ç”Ÿæ—¶ï¼Œå¤„ç†å™¨å¿…é¡»åšçš„åŸºæœ¬äº‹æƒ…æ˜¯ï¼š åœ¨SEPC(supervisor exception cause register)ä¿å­˜å‡ºé”™æŒ‡ä»¤çš„åœ°å€ æŠŠæ§åˆ¶æƒäº¤ç»™æ“ä½œç³»ç»Ÿçš„ç‰¹å®šåœ°å€å¤„ å¯¹äºå¤„ç†å¼‚å¸¸çš„OS,å®ƒå¿…é¡»çŸ¥é“å¼‚å¸¸çš„åŸå› ï¼š è®¾ç½®ä¸€ä¸ªåŸå› å¯„å­˜å™¨ï¼ˆSupervisor Exception Cause Register or SCAUSE):å…¶ä¸­æœ‰ä¸ªåŸŸæŒ‡ç¤ºå¼‚å¸¸çš„åŸå›  ä½¿ç”¨å‘é‡ä¸­æ–­(vectored interrupts), æ§åˆ¶æƒè¢«è½¬ç§»åˆ°çš„åœ°å€æ˜¯ç”±å¼‚å¸¸åŸå› å†³å®šï¼Œè¯¥åœ°å€å¯èƒ½è¢«æ·»åŠ åˆ°æŒ‡å‘å‘é‡ä¸­æ–­å†…å­˜èŒƒå›´çš„base registerä¸­ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å¼‚å¸¸ä¸­æ–­å‘é‡åœ°å€æ¥è¡¨ç¤ºå¼‚å¸¸ç§ç±»ã€‚ å¼‚å¸¸åœ¨æµæ°´çº¿ä¸­çš„å®ç°(ä½¿ç”¨è‡ªå‰ç›¸åŒçš„æœºåˆ¶ï¼Œä¸è¿‡è¿™æ¬¡ç”±å¼‚å¸¸é‡ç½®æ§åˆ¶ä¿¡å·) IFçº§æŒ‡ä»¤çš„æ¸…é™¤ç”¨ä¹‹å‰çš„IF.flushä¿¡å· æ–°å¢ID.Flushä¿¡å·å’Œä¹‹å‰çš„å†’é™©æ£€æµ‹å•å…ƒäº§ç”Ÿçš„stallä¿¡å·è¿›è¡Œæˆ–è¿ç®—ï¼Œç„¶ååŠ åœ¨è‡ªå‰çš„å¤šé€‰å™¨ä¸Šï¼Œå®ç°IDçº§æŒ‡ä»¤æ¸…é™¤ æ–°å¢ä¸€ä¸ªEX.Flushä¿¡å·æ¸…é™¤EXçº§çš„æŒ‡ä»¤ ä¸ºäº†ä»å¼‚å¸¸å¤„ç†ç¨‹åºçš„åœ°å€å–æŒ‡ï¼Œåªè¦ç®€å•å®¶ä¸€ä¸ªé¢å¤–çš„è¾“å…¥åˆ°PCçš„å¤šé€‰å™¨ã€‚","categories":[{"name":"CS","slug":"CS","permalink":"https://www.beenli.cn/categories/CS/"},{"name":"Computer Organization & Design","slug":"CS/Computer-Organization-Design","permalink":"https://www.beenli.cn/categories/CS/Computer-Organization-Design/"}],"tags":[{"name":"processor","slug":"processor","permalink":"https://www.beenli.cn/tags/processor/"}]},{"title":"æ•°æ®é€šè·¯(2)--Control","slug":"æ•°æ®é€šè·¯-2-Control","date":"2020-08-20T12:54:40.000Z","updated":"2020-09-27T11:07:21.876Z","comments":true,"path":"posts/f0189490/","link":"","permalink":"https://www.beenli.cn/posts/f0189490/","excerpt":"","text":"1ã€ALUæ§åˆ¶ MIPS ALUåœ¨4ä½æ§åˆ¶ä¿¡å·ä¸Šå®šä¹‰äº†6ç§æœ‰æ•ˆçš„è¾“å…¥ç»„åˆ å­˜å‚¨å™¨è®¿é—®æŒ‡ä»¤ï¼šadd Rå‹æŒ‡ä»¤ï¼šæ ¹æ®æŒ‡ä»¤ä½6ä½çš„functå­—æ®µ1 ï¼ŒALUæ‰§è¡Œ5ç§æ“ä½œä¸­çš„ä¸€ç§(noræš‚æ—¶æ²¡ç”¨) branchæŒ‡ä»¤ï¼šsub(ä¸¤ä¸ªæ“ä½œæ•°ç›¸å‡åˆ¤æ–­æ˜¯å¦ä¸ºé›¶) å¤šçº§è¯‘ç ï¼šè¾“å…¥ï¼š6ä½functå­—æ®µå’Œ2ä½ALUOPå­—æ®µâ€”â€”â€”â€”&gt;è¾“å‡ºï¼š4ä½ALU control lines ä¸»æ§åˆ¶å•å…ƒç”ŸæˆALUOP çœŸå€¼è¡¨â€”â€”ä¼˜åŒ–åè½¬æ¢ä¸ºé—¨ç”µè·¯ï¼ˆå‘å¾…å®šï¼‰ 2ã€ä¸»æ§åˆ¶å•å…ƒ æŒ‡ä»¤æ ¼å¼ Rå‹æŒ‡ä»¤opcodeä¸º0ï¼›lwä¸º35ï¼›swä¸º43 ; branchä¸º4âƒ£ 7ä¸ªå¤šé€‰å™¨æ§åˆ¶ä¿¡å·çš„ä½œç”¨ ä¸»æ§å•å…ƒäº§ç”Ÿ7ä¸ªä¸€ä½æ§åˆ¶ä¿¡å·+2ä½ALUOP æ§åˆ¶ä¿¡å·çœŸå€¼è¡¨ op[5:0]å–è‡³Instruction[31:26] RegDst: Rä¸º1è¡¨ç¤ºç›®çš„å¯„å­˜å™¨ä¸ºrd; lwä¸ºrs; swå’Œbranchä¸ç”¨å†™å›å¯„å­˜å™¨å †æ‰€ä»¥æ²¡æœ‰ç›®çš„å¯„å­˜å™¨ã€‚ ALUSrc: Rå’Œbranchä¸º0è¡¨ç¤ºALUç¬¬äºŒä¸ªæ“ä½œæ•°æ¥è‡ªrt; lwå’Œswè¡¨ç¤ºç¬¬äºŒä¸ªæ“ä½œæ•°æ¥è‡ªä½16ä½çš„æ‰©å±•ã€‚ MemtoReg: swå’Œbranchä¸ºxè¡¨ç¤ºä¸ç”¨å†™å›ã€‚Rä¸º0è¡¨ç¤ºALUè®¡ç®—ç»“æœå†™å›ï¼›lwè¡¨ç¤ºæ•°æ®å¯„å­˜å™¨å–å‡ºæ¥çš„æ•°å†™å› Regwirte: Rå’Œlwè¦å†™å›æ‰€ä»¥ä¸º1ã€‚ MenRead: åªè¦lwè¦è¯»æ‰€ä»¥åªæœ‰lwä¸º1 MemWrite: åªæœ‰swè¦å†™ Branch: åªæœ‰branchæ‰è§¦å‘ ALUOP: Rä¸º10ï¼›å­˜å‚¨ä¸º00ï¼›branchä¸º01 è·³è½¬å®ç°ï¼ˆå³æ”¹å˜PCçš„å€¼ï¼‰ å…¶OPcodeä¸º2.ä½26ä½éƒ½æ˜¯offset_addressã€‚","categories":[{"name":"CS","slug":"CS","permalink":"https://www.beenli.cn/categories/CS/"},{"name":"Computer Organization & Design","slug":"CS/Computer-Organization-Design","permalink":"https://www.beenli.cn/categories/CS/Computer-Organization-Design/"}],"tags":[{"name":"processor","slug":"processor","permalink":"https://www.beenli.cn/tags/processor/"}]},{"title":"æ•°æ®é€šè·¯(1)--Basic Datapath","slug":"æ•°æ®é€šè·¯-1-Basic-Datapath","date":"2020-08-20T07:10:16.000Z","updated":"2020-09-27T11:08:18.082Z","comments":true,"path":"posts/74018a17/","link":"","permalink":"https://www.beenli.cn/posts/74018a17/","excerpt":"","text":"1ã€Preface è®¡ç®—æœºæ€§èƒ½ï¼šâ‘ æŒ‡ä»¤æ•°ç›®(ç¼–è¯‘å™¨å’ŒæŒ‡ä»¤é›†ï¼‰ï¼Œâ‘¡æ—¶é’Ÿå‘¨æœŸé•¿åº¦(ç»„åˆç”µè·¯æœ€å¤§å»¶æ—¶)ï¼Œâ‘¢æ¯æ¡æŒ‡ä»¤æ‰€éœ€è¦çš„æ—¶é’Ÿå‘¨æœŸæ•°(å¤„ç†å™¨æ¶æ„ï¼ŒæŒ‡ä»¤ç±»åˆ«ï¼Œå¤šå‘å°„è¶…æ ‡é‡æµæ°´) æœ¬ç¯‡åªæ˜¯ä¸€ä¸ªåŸºæœ¬çš„MIPSå®ç°ã€‚ å­˜å‚¨å™¨è®¿é—®æŒ‡ä»¤ï¼šå–å­—(lw) å’Œå­˜å­—(sw) ç®—æ•°é€»è¾‘æŒ‡ä»¤ï¼šåŠ æ³•(add)ã€å‡æ³•(sub)ã€ä¸è¿ç®—(and)ã€æˆ–è¿ç®—(or)å’Œå°äºåˆ™è®¾ç½®(slt) åˆ†æ”¯æŒ‡ä»¤ï¼šç›¸ç­‰åˆ™åˆ†æ”¯(beq)å’Œè·³è½¬(j) RæŒ‡ä»¤å¯¹åº”ç®—æ•°é€»è¾‘æŒ‡ä»¤ã€‚(rs, rtå¯¹åº”ä¸¤ä¸ªæºæ“ä½œæ•°ï¼Œrdå¯¹åº”ç›®çš„å¯„å­˜å™¨) 12add $t1, $t2, $t3 # $t1=$t2+$t3slt $to, $s0, $a1 # reg $t0 = 0 if $s0 &gt;= $a1 IæŒ‡ä»¤å¯¹åº”è®¿å­˜å’Œåˆ†æ”¯æŒ‡ä»¤ã€‚ 12345sw $t1, offset_value($t2) # æŠŠ$t1çš„å€¼å­˜åˆ°ä»¥$t2ä¸ºåŸºå€åŠ ä¸Š16ä½åœ°å€åç§»ä¸Šå»ã€‚ # rs=$t2, rt=$t1(ç›®æ ‡å¯„å­˜å™¨),[15:0]=offsetlw $t1, offset_value($t2) # æŠŠ$t2ä¸ºåŸºå€åŠ ä¸Š16ä½åœ°å€åç§»æ‰€åœ¨åœ°å€çš„å€¼å­˜åˆ°t1ã€‚beq $t3, $zero, loop1 # if($t3==$zero) go to loop1 # loop1æ˜¯å16ä½ã€‚rs=$t3,rt=$zero; JæŒ‡ä»¤å¯¹åº”æ— æ¡ä»¶è·³è½¬ 1j for2tst # jump tp for2tst 2ã€An Overview of the Implementation å®ç°æ¯æ¡æŒ‡ä»¤çš„å‰ä¸¤æ­¥æ˜¯ä¸€æ ·çš„ ç¨‹åºè®¡æ•°å™¨(PC)æŒ‡å‘æŒ‡ä»¤æ‰€åœ¨çš„å­˜å‚¨å•å…ƒï¼Œå¹¶ä»ä¸­å–å‡ºæŒ‡ä»¤ã€‚(PCæ˜¯åœ°å€) é€šè¿‡æŒ‡ä»¤å­—æ®µå†…å®¹ï¼Œé€‰æ‹©è¯»å–ä¸€ä¸ªæˆ–ä¸¤ä¸ªå¯„å­˜å™¨ã€‚å¯¹äºå–å­—æŒ‡ä»¤ï¼Œåªéœ€è¯»ä¸€ä¸ªå¯„å­˜å™¨å³rs,è€Œå…¶å®ƒå¤§å¤šæ•°æŒ‡ä»¤è¦æ±‚è¯»å–ä¸¤ä¸ªå¯„å­˜å™¨ï¼ˆrsï¼Œ rt)ã€‚ å‰é¢ä¸¤æ­¥å®Œæˆåï¼Œä¸ºå®ŒæˆæŒ‡ä»¤è€Œè¿›è¡Œçš„åç»­æ­¥éª¤åˆ™å–å†³äºå…·ä½“çš„æŒ‡ä»¤ç±»å‹ æ‰€æœ‰æŒ‡ä»¤ä¸­é™¤äº†jumpï¼Œåœ¨è¯»å–å¯„å­˜å™¨åéƒ½è¦ä½¿ç”¨ALUã€‚ è®¿å­˜æŒ‡ä»¤ï¼šaddress calculation ç®—æœ¯é€»è¾‘æŒ‡ä»¤ï¼šoperation execution åˆ†æ”¯æŒ‡ä»¤ï¼šcomparison ALUä¹‹ååˆå„ä¸ç›¸åŒ è®¿é—®Data Memory: storeæŒ‡ä»¤è¦å†™å…¥æ•°æ®åˆ°data memoryï¼›loadæŒ‡ä»¤è¦ä»memoryè¯»æ•°æ® å†™å›registers: RæŒ‡ä»¤éœ€è¦æŠŠALUè®¡ç®—çš„ç»“æœ; loadæŒ‡ä»¤è¦data memoryè¯»å‡ºçš„æ•°æ® æ”¹å˜PC: å¦‚æœåˆ†æ”¯æˆç«‹é‚£ä¹ˆæ”¹å˜PCå€¼ï¼Œå¦åˆ™è‡ªå¢4ã€‚ 3ã€Building a Datapath æ•°æ®é€šè·¯éƒ¨ä»¶ï¼šä¸€ä¸ªç”¨æ¥æ“ä½œæˆ–ä¿å­˜å¤„ç†å™¨ä¸­æ•°æ®çš„å•å…ƒã€‚åœ¨MPISå®ç°ä¸­ï¼Œæ•°æ®é€šè·¯éƒ¨ä»¶åŒ…æ‹¬æŒ‡ä»¤å­˜å‚¨å™¨ã€æ•°æ®å­˜å‚¨å™¨ã€å¯„å­˜å™¨å †ã€ALUã€åŠ æ³•å™¨. 3.1ã€basic components å–æŒ‡ä»¤ï¼Œæ›´æ–°æŒ‡ä»¤ æ ¹æ®å¯„å­˜å™¨å·å–æ“ä½œæ•°è¿›è¡ŒALUè¿ç®— å‘å†…å­˜è¯»æˆ–è€…å†™æ•°æ® 3.2ã€combination components branchæŒ‡ä»¤éœ€è¦[15:0]å·¦ç§»ä¸¤ä½å¹¶ç¬¦å·æ‰©å±•åˆ°32ä½ä¸PCç›¸åŠ ç»„æˆæ–°çš„PC 3.3ã€single data path å‡è®¾æˆ‘ä»¬åœ¨ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸå†…æ‰§è¡Œä»»æ„ä¸€æ¡æŒ‡ä»¤ã€‚é‚£æ„å‘³ç€æ¯æ¡æŒ‡ä»¤ä¸èƒ½ç”¨æŸä¸ªéƒ¨ä»¶ä¸¤æ¬¡æˆ–ä»¥ä¸Šã€‚æ‰€ä»¥ä»»ä½•éœ€è¦é‡å¤çš„éƒ¨ä»¶éƒ½å¿…é¡»è¢«å¤åˆ¶ã€‚ 1ã€éœ€è¦ä¸€ä¸ªæŒ‡ä»¤å­˜å‚¨å™¨å¤–ï¼Œè¿˜éœ€è¦ä¸€ä¸ªæ•°æ®å­˜å‚¨å™¨ 2ã€å°½ç®¡æœ‰çš„åŠŸèƒ½å•å…ƒéœ€è¦å¤åˆ¶ï¼Œä½†åœ¨æ‰§è¡Œä¸åŒæŒ‡ä»¤æ—¶ï¼Œå¾ˆå¤šåŠŸèƒ½å•å…ƒå¯ä»¥è¢«å…±äº«(å¤ç”¨) å¤ç”¨ALUå’Œå¯„å­˜å™¨å †","categories":[{"name":"CS","slug":"CS","permalink":"https://www.beenli.cn/categories/CS/"},{"name":"Computer Organization & Design","slug":"CS/Computer-Organization-Design","permalink":"https://www.beenli.cn/categories/CS/Computer-Organization-Design/"}],"tags":[{"name":"processor","slug":"processor","permalink":"https://www.beenli.cn/tags/processor/"}]},{"title":"å­˜å‚¨ç”µè·¯","slug":"å­˜å‚¨ç”µè·¯","date":"2020-08-05T10:28:10.000Z","updated":"2020-09-30T11:56:14.695Z","comments":true,"path":"posts/19fa4593/","link":"","permalink":"https://www.beenli.cn/posts/19fa4593/","excerpt":"","text":"ä¸€ã€æ¦‚è¿° åœ¨å¤æ‚çš„æ•°å­—ç”µè·¯ä¸­ï¼Œä¸ä»…éœ€è¦å¯¹å„ç§æ•°å­—ä¿¡å·è¿›è¡Œç®—æœ¯è¿ç®—å’Œé€»è¾‘è¿ç®—ï¼Œè€Œä¸”è¿˜éœ€è¦åœ¨è¿ç®—è¿‡ç¨‹ä¸­ä¸æ–­å°†è¿ç®—æ•°æ®å’Œè¿ç®—ç»“æœä¿å­˜èµ·æ¥ã€‚å› æ­¤ï¼Œå­˜å‚¨ç”µè·¯å°±æˆä¸ºè®¡ç®—æœºä»¥åŠæ‰€æœ‰å¤æ‚æ•°å­—ç³»ç»Ÿä¸å¯ç¼ºå°‘çš„ç»„æˆéƒ¨åˆ†ã€‚ åˆ†ç±»æ€»ç»“ äºŒã€SRé”å­˜å™¨SRé”å­˜å™¨(Set-Reset Latch) æ˜¯é™æ€å­˜å‚¨å•å…ƒä¸­æœ€åŸºæœ¬ï¼Œä¹Ÿæ˜¯ç”µè·¯ç»“æ„æœ€ç®€å•çš„ä¸€ç§ã€‚ æˆ–é—¨é”å­˜å™¨ å½“$R_D$æ˜¯1æˆ–è€…$S_D$æ˜¯1è€Œå¦å¤–ä¸€ä¸ªæ˜¯0æ—¶ï¼Œå¯ä»¥çœ‹åˆ°Sèµ·åˆ°set 1ï¼›è€ŒRèµ·åˆ°reset 0çš„ä½œç”¨ã€‚ å½“æœ‰ä¸€ä¸ªå›åˆ°0æ—¶(æ­¤æ—¶ä¸¤è¾“å…¥éƒ½ä¸º0)ï¼Œå¯ä»¥ä¿æŒåŸæ¥çš„çŠ¶æ€ä¸å˜ã€‚(å› ä¸ºè¾“å‡ºçš„1åé¦ˆåˆ°è¾“å…¥) âŒä¸å…è®¸è¾“å…¥åŒä¸º1ã€‚ï¼ˆæ­¤æ—¶è¾“å‡ºåŒä¸º0ä¸ºæ— æ•ˆçŠ¶æ€ï¼Œå¹¶ä¸”åŒæ—¶å˜ä¸º0æ—¶å­˜åœ¨ç«äº‰å†’é™©ï¼‰ ä¸é—¨é”å­˜å™¨(åŒç†)ğŸ™‚ ä¸‰ã€è§¦å‘å™¨ è§¦å‘å™¨ä¸é”å­˜å™¨ä¸åŒåœ¨äºï¼šå¢åŠ äº†ä¸€ä¸ªè§¦å‘ä¿¡å·è¾“å…¥ç«¯(æ—¶é’Ÿä¿¡å·CLK)ã€‚åªæœ‰å½“è§¦å‘ä¿¡å·åˆ°æ¥æ—¶ï¼Œå…¶åŠŸèƒ½ä¸é”å­˜å™¨ç›¸åŒã€‚ 1ã€ç”µå¹³è§¦å‘åªæœ‰è§¦å‘ä¿¡å·åœ¨æœ‰æ•ˆç”µå¹³çš„æ—¶å€™ï¼Œè¾“å…¥ä¿¡å·æ‰èƒ½ä½œç”¨ã€‚1 â‘ åŒæ­¥SRè§¦å‘å™¨ æ¡†å›¾Clå¤–é¢æ²¡æœ‰â­•ä»£è¡¨é«˜ç”µå¹³æœ‰æ•ˆ â‘¡å¼‚æ­¥å¤ä½ç½®ä½// å°†ç½®ä½ä¿¡å·$S_{D}^{â€˜}$æ¥å…¥G1, å¤ä½ä¿¡å·$R_{D}^{â€˜}$æ¥G2 â‘¢å•ç«¯è¾“å…¥(Då‹å·é”å­˜å™¨)// è§„é¿äº†çº¦æŸæ¡ä»¶SR=0 â‘£Transparent D-Latch// CMOSä¼ è¾“é—¨æ„æˆ å½“TG2æ‰“å¼€ï¼ŒTG1å…³é—­æ—¶ã€‚ä¸¤ä¸ªåç›¸å™¨ä¸²è”æŠŠæˆªæ­¢å‰ç¬é—´çš„ä¿¡å·(åç›¸å™¨G1è¾“å…¥ç”µå®¹)é”ä½ã€‚ 2ã€è¾¹æ²¿è§¦å‘æé«˜è§¦å‘å™¨å¯é æ€§ï¼Œå¢å¼ºæŠ—å¹²æ‰°èƒ½åŠ›ï¼Œå¸Œæœ›è§¦å‘å™¨æ¬¡æ€ä»…å–å†³äºCLKä¿¡å·è¾¹æ²¿åˆ°è¾¾æ—¶åˆ»è¾“å…¥ä¿¡å·çš„çŠ¶æ€ã€‚è€Œè¾¹æ²¿ä¹‹å‰æˆ–ä¹‹åè¾“å…¥çŠ¶æ€çš„å˜åŒ–å¯¹è§¦å‘å™¨çš„æ¬¡æ€æ²¡æœ‰å½±å“ã€‚ â‘ ä¸¤ä¸ªç”µå¹³è§¦å‘Dè§¦å‘å™¨ ä¸çœ‹ç½®ä½ä¿¡å·å°±æ˜¯ä¸¤ä¸ªTransparent D-Latch å½“ç¬¬ä¸€ä¸ªå·¥ä½œæ—¶ï¼Œç¬¬äºŒä¸ªä¿æŒã€‚é€æ˜Dé”å­˜å™¨ï¼šæ‰€ä»¥è¾“å‡ºèƒ½è·Ÿéšæ—¶é’Ÿè¾¹æ²¿ç¬é—´è¾“å…¥çš„å€¼ â‘¡ç»´æŒé˜»å¡ğŸ“Œâ‘¢é—¨ç”µè·¯ä¼ è¾“å»¶è¿ŸğŸ“Œ3ã€è„‰å†²è§¦å‘ ä¸ºäº†æé«˜å¯é æ€§ï¼šå¸Œæœ›æ¯ä¸ªCLKå‘¨æœŸé‡Œé¢è¾“å‡ºç«¯çŠ¶æ€åªèƒ½æ”¹å˜ä¸€æ¬¡ â‘ ä¸»ä»SRMaster-Slave SR Flip-Flop ï¿¢ï¼šå»¶æ—¶è¾“å‡º é«˜ç”µå¹³æœ‰æ•ˆï¼Œä¸‹é™æ²¿çŠ¶æ€æ‰ä¼šæ”¹å˜ clké«˜ç”µå¹³ä¸»è§¦å‘å™¨æœ‰æ•ˆï¼Œä»è§¦å‘å™¨ä¿æŒåŸæ¥çŠ¶æ€ã€‚ clkä»é«˜å˜åˆ°ä½æ—¶ï¼Œä¸»è§¦å‘å™¨è¢«å°é”ï¼Œä»è§¦å‘å™¨æŒ‰ç…§ä¸»è§¦å‘å™¨ç›¸åŒçš„çŠ¶æ€ç¿»è½¬ã€‚ å› æ­¤ï¼šä¸€ä¸ªå‘¨æœŸè¾“å‡ºåªå¯èƒ½ç¿»è½¬ä¸€æ¬¡ã€‚ â‘¡ä¸»ä»JK(è§„é¿SR=1) Q^* = S + \\overline RQ(for\\quad SR) JK: S=J \\overline Q\\quad R=KQ Q^*=J \\overline Q+(\\overline K+\\overline Q)Q=J \\overline Q + \\overline KQ\\quad(for\\quad JK) clkå˜ä½ç”µå¹³æ—¶æŠŠä¸»è§¦å‘å™¨çš„å€¼å¤åˆ¶ç»™äº†æ¬¡è§¦å‘å™¨ã€‚ï¼ˆæ‰€ä»¥ä¸Šè¾¹æ¨å¯¼æ—¶Qå³ä»£è¡¨ä¸­é—´è¾“å‡ºä¹Ÿä»£è¡¨åè¾¹è¾“å‡ºï¼‰ ä¸»è§¦å‘å™¨æœ‰æ•ˆæ—¶(é«˜ç”µå¹³)Qè¦ä¹ˆä¸º1è¦ä¹ˆä¸º0ï¼Œä¸å¯èƒ½åŒæ—¶ä¸º0æˆ–è€…ä¸º1ã€‚å› ä¸ºG3,G4éƒ½ä¸º1ã€‚å®ƒä»¬é€šè¿‡åç›¸å™¨äº’å’¬ã€‚ è€ƒå¯Ÿå½“J=1ï¼ŒR=1æ—¶ï¼ŒG7,G8è¾“å‡º$Q$å’Œ$\\overline Q$(ä¸æ˜¯å…¨0ï¼Œå°±ğŸ†—)ã€‚æ‰€ä»¥å½“Q=1ï¼Œè¾“å‡ºä¸º0ï¼Œå½“Q=0,è¾“å‡ºä¸º1,å³åå‘ã€‚ å››ã€è§¦å‘å™¨çš„åŠ¨æ€ç‰¹æ€§ğŸ“Œäº”ã€References1.å¤–å›½æ•™ææœ‰æ—¶æŠŠæ­¤ç”µè·¯å«ï¼ˆGated SR latch), æ—¶é’Ÿä¿¡å·å«åšâ€œä½¿èƒ½â€ä¿¡å·ï¼ˆenableï¼‰ â†©","categories":[{"name":"Digital IC","slug":"Digital-IC","permalink":"https://www.beenli.cn/categories/Digital-IC/"},{"name":"digital electronic technique","slug":"Digital-IC/digital-electronic-technique","permalink":"https://www.beenli.cn/categories/Digital-IC/digital-electronic-technique/"}],"tags":[{"name":"circuits","slug":"circuits","permalink":"https://www.beenli.cn/tags/circuits/"}]},{"title":"riscv-gnu-toolchain ä¸‹è½½ã€ç¼–è¯‘","slug":"riscv-gnu-toolchain-ä¸‹è½½ã€ç¼–è¯‘","date":"2020-08-01T01:23:29.000Z","updated":"2020-09-30T12:18:58.860Z","comments":true,"path":"posts/6c0abcd9/","link":"","permalink":"https://www.beenli.cn/posts/6c0abcd9/","excerpt":"","text":"1ã€å‰è¨€riscv-gnu-toolchain æ˜¯å­¦ä¹  risc-v çš„å‰æï¼Œä½†æ˜¯ç½‘ä¸Šå¯¹è¿™æ–¹é¢çš„ä»‹ç»å¾ˆå°‘ï¼Œå¹¶ä¸”å·¥å…·é“¾ç§ç±»ç¹å¤šï¼Œå¾ˆå¯èƒ½è®©æˆ‘ä»¬æ‘¸ä¸æ¸…å¤´è„‘ã€‚ 2ã€ä¸‹è½½ç¯‡ ç”±äºriscv-gnu-toolchainåŒ…å«æœ‰å¥½å¤šç¬¬ä¸‰æ–¹åº“ï¼Œæ•´ä¸ªé¡¹ç›®æ–‡ä»¶å¾ˆå¤§[å®˜æ–¹è¯´çš„æ˜¯6.65GB]ï¼ŒåŠ ä¸Šå›½å†…GitHubå ªæ¯”ğŸ¢é€Ÿï¼Œä½ å¤šåŠæ˜¯ä¸å¯èƒ½æŒ‰å®˜æ–¹æ•™ç¨‹ä¸‹ä¸‹æ¥ã€‚ é¡¹ç›®åç§° é¡¹ç›®æè¿° é¡¹ç›®ç”¨é€” qemu æ¨¡æ‹Ÿå™¨ï¼ˆç±»ä¼¼bochs,PearPC) riscv-binutils å¼€å‘å·¥å…·(compilerã€assembleã€linkerã€debuggerâ€¦) riscv-dejagnu æµ‹è¯•å…¶å®ƒç¨‹åºçš„æ¡†æ¶(framework) riscv-gcc GNU Compiler Collection riscv-gdb åŒriscv-binutils riscv-glibc GNU C Library(system-API,å…¶å®ƒçš„è¯­è¨€ä¹Ÿé€šè¿‡å®ƒè®¿é—®OS) riscv-newlib ä¸€å¥—å¼€å‘å·¥å…·ï¼ˆç”¨çš„åº“æœ‰åˆ«äºriscv-binutils) binutils å’Œ newlib ä¹‹é—´çš„åŒºåˆ«ï¼ˆå‘å¾…å¡«o_o â€¦.ï¼‰ PrerequisitesPC: x86 OS: Ubuntu 20.04.1 LTS VM: wmware15.5Pro ä¸‹è½½æºä»£ç ï¼ˆæ¨èä½¿ç”¨hub.fastgit.orgé•œåƒç«™ï¼Œæ¯”åŸç”Ÿç«™å¿«å‡ ç™¾å€ï¼‰ 123git clone https://hub.fastgit.org/riscv/riscv-gnu-toolchaincd riscv-gnu-toolchaingit submodule update --init --recursive å®‰è£…ä¾èµ–ï¼ˆå…¶å®ƒç³»ç»ŸæŸ¥çœ‹å®˜æ–¹readme) 1sudo apt-get install autoconf automake autotools-dev curl python3 libmpc-dev libmpfr-dev libgmp-dev gawk build-essential bison flex texinfo gperf libtool patchutils bc zlib1g-dev libexpat-dev ä¸‹è½½å¤±è´¥è§£å†³æ–¹æ¡ˆ git clone qemuä¸‹è½½é€Ÿåº¦å¤ªæ…¢å¯¼è‡´å¤±è´¥ï¼ˆå› ä¸ºqemuæ²¡æœ‰æŠŠé¡¹ç›®æ‰˜ç®¡åœ¨GitHubä¸Š) é“¾æ¥ï¼šhttps://pan.baidu.com/s/1xGrafiu4I0yPAnE0iuTYzwæå–ç ï¼š3iyy ä¸‹è½½æºç , è§£å‹åˆ°ç›¸åº”çš„ç›®å½•ä¸Šå³å¯ã€‚ å…¶å®ƒæ¨¡å—æ²¡æœ‰æ‹‰ä¸‹æ¥ã€‚ åœ¨æºé¡¹ç›®ä¸‹æŒ¨ä¸ªæ‰‹åŠ¨å…‹éš†ã€‚ 12cd ~/riscv/riscv-gnu-toolchaingit clone https://hub.fastgit.org/riscv/riscv-gcc.git 3ã€ç¼–è¯‘ç¯‡1ã€Newlib å»ºç«‹ä¸€ä¸ªå®‰è£…è·¯å¾„ï¼šmakdir /opt/riscv [æœ€å¥½å»ºç«‹ä¸€ä¸ªç¼–è¯‘æ–‡ä»¶å¤¹]ï¼šmakdir build &amp;&amp; cd build é…ç½®ç¯å¢ƒå˜é‡ï¼šexport PATH=$PATH:/opt/riscv/bin(å»ºè®®å†™åˆ°~/.bashrcä¸Šï¼Œæ°¸ä¹…æœ‰æ•ˆ 12./configure --prefix=/opt/riscvmake 2ã€Linux è·Ÿä¸Šé¢ç›¸åŒçš„æ­¥éª¤ï¼Œä¸è¿‡æœ€å¥½æ¢ä¸€ä¸ªå¹²å‡€çš„æ–‡ä»¶å¤¹ã€‚ é»˜è®¤æ˜¯å®‰è£…RV64GC(64-bit), å³ä½¿åœ¨32-bitçš„æ„å»ºç¯å¢ƒä¸­ã€‚ 12./configure --prefix=/opt/riscvmake linux Alternativelyï¼šï¼ˆæ„å»º32-bit RV32GC) 12./configure --prefix=/opt/riscv --with-arch=rv32gc --with-abi=ilp32dmake linux æ”¯æŒçš„æ¶æ„æœ‰ï¼šrv32iã€rv64i æ ‡å‡†æ‰©å±•ï¼š (a)tomics, (m)ultiplication and division, (f)loat, (d)ouble, or (g)eneral for MAFD æ”¯æŒçš„ABIs: ilp32 (32-bit soft-float), ilp32d (32-bit hard-float), ilp32f (32-bit with single-precision in registers and double in memory, niche use only), lp64 lp64f lp64d (same but with 64-bit long and pointers). 3ã€Linux multilib åŒæ—¶æ”¯æŒ32-bitå’Œ64-bitçš„Linuxã€‚ 12./configure --prefix=/opt/riscv --enable-multilibmake linux ç¼–è¯‘å‡ºæ¥çš„å·¥å…·å¸¦æœ‰å‰ç¼€ï¼šriscv64-unknown-linux-gnu-, ä½†æ˜¯èƒ½ç¼–è¯‘32ä½å’Œ64ä½ç¨‹åºã€‚ 4ã€ç¼–è¯‘ç»“æœ ç»è¿‡æ¼«é•¿çš„ç­‰å¾…ï¼Œæˆ‘ç»ˆäºç¼–è¯‘Linux 64bitç‰ˆæœ¬ã€‚ Referencesriscvå„ç§ç‰ˆæœ¬gccå·¥å…·é“¾ç¼–è¯‘ä¸å®‰è£…","categories":[{"name":"RISC-V","slug":"RISC-V","permalink":"https://www.beenli.cn/categories/RISC-V/"},{"name":"environment","slug":"RISC-V/environment","permalink":"https://www.beenli.cn/categories/RISC-V/environment/"}],"tags":[{"name":"toolkits","slug":"toolkits","permalink":"https://www.beenli.cn/tags/toolkits/"}]},{"title":"è¶…å‰è¿›ä½åŠ æ³•å™¨","slug":"è¶…å‰è¿›ä½åŠ æ³•å™¨","date":"2020-04-28T09:31:08.000Z","updated":"2020-09-30T12:02:22.737Z","comments":true,"path":"posts/1aa82b80/","link":"","permalink":"https://www.beenli.cn/posts/1aa82b80/","excerpt":"","text":"1ã€1bitå…¨åŠ å™¨ S = A\\oplus B \\oplus C_{in} C_{out} = AB + (A \\oplus B)C_{in} 2ã€4bitè¡Œæ³¢åŠ æ³•å™¨ å¯ä»¥çœ‹åˆ°è¦å¾—åˆ°æœ€åçš„è¿›ä½è¦ç»è¿‡9ä¸ªé—¨çš„å»¶æ—¶ã€‚ 3ã€4bitè¶…å‰è¿›ä½åŠ æ³•å™¨ è¿›ä½äº§ç”Ÿä¿¡å·:g_i = A_iB_i è¿›ä½ä¼ è¾“ä¿¡å·:p_i = A_i\\oplus B_i åˆ™ï¼šS_i = p_i \\oplus c_i C_{i+1} = p_ic_i + g_i\\quad(c_o = c_{in}) åˆ¤æ–­è¿›ä½çš„æ­¥éª¤: å¦‚æœ $g_i$=1 (å…¶ä»–ä¸ç”¨çœ‹è‚¯å®šä¼šè¿›ä½) å¦‚æœ $g_i$=0ï¼›çœ‹ä¼ è¾“ä¿¡å·$p_i$ã€‚ å¦‚æœ $p_i$=0; é‚£ä¸ç”¨çœ‹ï¼Œå·²ç»å¦å†³äº†è¿›ä½ å¦‚æœ $p_i$=1; é‚£ä¹ˆç”¨åŒæ ·çš„æ–¹æ³•çœ‹ä¸‹ä¸€ä½æ˜¯å¦æœ‰è¿›ä½ åˆ¤æ–­ç»“æœçš„æ­¥éª¤: åªéœ€æŠŠä¼ è¾“ä¿¡å·ä¸è¿›ä½ä¿¡å·å¼‚æˆ–ã€‚ åŒ–ç®€å¾—åˆ°ï¼š c_1 = g_0 + p_oc_0(3ä¸ªé—¨å»¶æ—¶) c_2 = g_1 + g_0p_1 + p_1p_0c_0(3ä¸ªé—¨å»¶æ—¶) c_3 = g_2 + p_2g_1 + p_2p_1g_0 + p_2p_1p_0c_0(3ä¸ªå»¶æ—¶) c_4 = g_3 + p_3g_2 + p_3p_2g_1 + p_3p_2p_1g_0 + p_3p_2p_1p_0c_0 ğŸ‘‡ä¸‹é¢æ˜¯ç»è¿‡ç»¼åˆå™¨ä¼˜åŒ–é—¨ä¸ªæ•°åçš„å›¾ã€‚å¯ä»¥æ˜æ˜¾çœ‹åˆ°è™½ç„¶é—¨ä¸ªæ•°å‡å°‘ä½†æ˜¯å»¶æ—¶å˜é•¿ã€‚ 4ã€è¶…å‰è¿›ä½åŠ æ³•å™¨çº§è” pp = p[0] \\& p[1] \\& p[2] \\& p[3](ä¼ è¾“ä¿¡å·) gg = c_4(è¿›ä½ä¿¡å·)ppï¼š ä»£è¡¨ç›¸åŠ ç»“æœä¸º1111çš„æ—¶å€™ã€‚é‚£ä¹ˆä½ä¸€çº§è¦æ˜¯æœ‰è¿›ä½ï¼Œä¼ åˆ°æˆ‘è¿™ä¸€çº§ï¼Œä¼šäº§ç”Ÿæƒ³ä¸Šä¸€çº§çš„è¿›ä½ã€‚ 123456789101112131415161718192021222324252627// Author: Wan Li// time: 2020-04-28// function: æŠŠ4ä¸ªè¶…å‰è¿›ä½ç»„æˆ16ä½çš„// ---------------------------------------------------/* `include \"adder4.v\" */module adder_16(a, b, c_in, sum, c_out); input[15:0] a, b; input c_in; output[15:0] sum; output c_out; wire[3:0] p, g, c; assign c[0] = c_in; add4_head add1(.a(a[3:0]), .b(b[3:0]), .ci(c[0]), .s(sum[3:0]), .pp(p[0]), .gg(g[0])); assign c[1] = g[0] | (p[0] &amp; c[0]); add4_head add2(.a(a[7:4]), .b(b[7:4]), .ci(c[1]), .s(sum[7:4]), .pp(p[1]), .gg(g[1])); assign c[2] = g[1] | (p[1] &amp; c[1]); add4_head add3(.a(a[11:8]), .b(b[11:8]), .ci(c[2]), .s(sum[11:8]), .pp(p[2]), .gg(g[2])); assign c[3] = g[2] | (p[2] &amp; c[2]); add4_head add4(.a(a[15:12]), .b(b[15:12]), .ci(c[3]), .s(sum[15:12]), .pp(p[3]), .gg(g[3])); assign c_out = g[3] | (p[3] &amp; c[3]);endmodule","categories":[{"name":"Digital IC","slug":"Digital-IC","permalink":"https://www.beenli.cn/categories/Digital-IC/"},{"name":"verilog","slug":"Digital-IC/verilog","permalink":"https://www.beenli.cn/categories/Digital-IC/verilog/"}],"tags":[{"name":"circuits","slug":"circuits","permalink":"https://www.beenli.cn/tags/circuits/"}]},{"title":"Git for novice","slug":"Git-for-novice","date":"2020-04-27T10:09:18.000Z","updated":"2020-12-28T09:11:38.348Z","comments":true,"path":"posts/f05478c5/","link":"","permalink":"https://www.beenli.cn/posts/f05478c5/","excerpt":"","text":"1ã€Git and GitHubGithub å¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªåŸºäºGitçš„ç³»ç»Ÿï¼Œå®ƒæä¾›äº†ä»“åº“çš„å¯è§†åŒ–ã€‚æ˜¯ä¸€ä¸ªè¿œç¨‹æ‰˜ç®¡ä»“åº“ã€‚å¦‚æœæ˜¯publicï¼Œå…¶ä»–äººå¯ä»¥éšæ„æŸ¥çœ‹ï¼Œä¿®æ”¹ã€‚å¦‚æœæ˜¯privateåªæœ‰ä½ è‡ªå·±å¯ä»¥æŸ¥çœ‹äº†ã€‚å¦‚æœä¸ºäº†å®‰å…¨ï¼Œå¯ä»¥å›¢é˜Ÿè‡ªå·±æ­å»ºä¸€ä¸ªgitæœåŠ¡å™¨ã€‚ Gitå¤§å®¶éƒ½å·²ç»å¾ˆç†Ÿæ‚‰äº†ï¼Œåˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ(Distributed version control system) 2ã€Why do we use git å¯ä»¥æ›´å¥½åœ°åœ¨GitHubä¸Šå¼€å‘ï¼Œåˆ†äº«å•Šã€‚ å¤šäººååŒå¼€å‘ã€‚ ç‰ˆæœ¬æ§åˆ¶ï¼Œå¯ä»¥ä»»æ„å›æ»šåˆ°ä¹‹å‰æŸä¸ªç‰ˆæœ¬ã€‚ 3ã€How do we use git åœºæ™¯1 åœ¨GitHubä¸Šçœ‹åˆ°ä¸€ä¸ªä¸é”™çš„é¡¹ç›®ï¼Œæƒ³è¦ç ”ç©¶ï¼Œå­¦ä¹ ä¸ºç›®çš„ã€‚ å…ˆforkä¸€ä»½åˆ°è‡ªå·±çš„GitHubä¸Šã€‚ cloneåˆ°æœ¬åœ° -o æŒ‡å®šè¿œç¨‹ä»“åº“çš„åå­—ï¼Œå¦åˆ™é»˜è®¤ä¸ºorigin 12git clone [-b &lt;æŒ‡å®šåˆ†æ”¯å&gt;]&lt;è¿œç¨‹ä»“åº“åœ°å€&gt; [-o booyah] é»˜è®¤æ˜¯å…‹éš†æ‰€æœ‰åˆ†æ”¯ã€‚ è¿›è¡Œè‡ªå·±çš„å¼€å‘ã€‚ä¿®æ”¹æ–‡ä»¶å æ­¤æ—¶git statuså¯ä»¥çœ‹åˆ°ï¼šä¿®æ”¹è¿‡çš„æ–‡ä»¶çº¢è‰²æ ‡å¤„ã€‚Untracked files 1git add ./[filename] // æŠŠä¿®æ”¹è¿‡çš„æ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒºã€‚ æ­¤æ—¶æ–‡ä»¶å˜æˆç»¿è‰²ã€‚å³å·²ç»æ·»åŠ åˆ°äº†æš‚å­˜åŒºã€‚ æäº¤ 1git commit -m \"æ·»åŠ æ–‡ä»¶çš„è¯´æ˜\" // æäº¤ æäº¤å®Œæˆäº†ï¼Œå·¥ä½œç›®å½•åº”è¯¥æ˜¾ç¤ºæ˜¯ç©ºçš„ã€‚ æ¨é€åˆ°è¿œç¨‹ä»“åº“ 1git push origin [branch name] // æ¨é€åˆ°æŒ‡å®šä»“åº“çš„æŒ‡å®šåˆ†æ”¯ä¸Šã€‚ åœºæ™¯2 è‡ªå·±æ–°å»ºä¸€ä¸ªä»“åº“ã€‚åšé¡¹ç›®å¼€å‘ã€‚ åˆå§‹åŒ–ä¸€ä¸ªæœ¬åœ°ä»“åº“ 1git init xxx // æ–°å»ºä¸€ä¸ªåä¸ºxxxçš„ä»“åº“ è¿›å…¥ä»“åº“ï¼Œç„¶åå°±å¯ä»¥å¼€å‘äº†ã€‚ 1cd xxx // æ­¤ç›®å½•å°±æ˜¯å·¥ç¨‹æ ¹ç›®å½•ã€‚ å¦‚æœè¦ä¸Šä¼ åˆ°GitHubä¸Šã€‚å³è¿œç«¯gitæœåŠ¡å™¨ é¦–å…ˆåœ¨GitHubä¸Šæ–°å»ºä¸€ä¸ªä»“åº“ã€‚ æœ¬åœ°ä»“åº“ä¸è¿œç¨‹ä»“åº“å»ºç«‹è”ç³»ã€‚ 1git remote add origin &lt;server&gt; // ä¸GitHubä»“åº“å»ºç«‹è”ç³». origin å¯ä»¥æ¢æˆä»»æ„åå­—ã€‚ å¯ä»¥çœ‹åˆ°æˆ‘é€šè¿‡origin pullä¸ä¸Šå»ã€‚å› ä¸ºæˆ‘è¿æ¥çš„æ˜¯remote_nameã€‚ pushåˆ°è¿œç¨‹æœåŠ¡å™¨ä¸Š 1git push origin master // æ¨é€åˆ°è¿œç¨‹æœåŠ¡å™¨ä¸Š å¦‚æœæ˜¯å…‹éš†è¿œç¨‹ä»“åº“çš„è¯ï¼Œé‚£ä¹ˆå¯ä»¥è·³è¿‡remoteï¼ˆå› ä¸ºæœ¬åœ°masterå·²ç»å’Œè¿œç¨‹masterè”ç³»ä¸Šäº†)ã€‚ç›´æ¥æ¨é€åˆ°è¿œç¨‹æœåŠ¡å™¨ã€‚ 4ã€common commands11ã€branchï¼ˆåˆ†æ”¯)1ã€æ–°å»ºåˆ†æ”¯12git checkout -b xxx // æ–°å»ºåˆ†æ”¯å¹¶åˆ‡æ¢åˆ°xxxgit branch xxx // åªæ˜¯æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œä»ç•™åœ¨æœ¬åœ°ã€‚ï¼ˆæ–°å»ºçš„åˆ†æ”¯å¤åˆ»ç›®åˆ†æ”¯) git branch [-b branchName commitId] ä»æŒ‡å®šåˆ†æ”¯å’Œcommitå·ä¸Šå¼€å§‹æ–°çš„åˆ†æ”¯ 2ã€åˆ†æ”¯åˆ‡æ¢12git branch [-a] //æŸ¥çœ‹åˆ†æ”¯git checkout xxx //åˆ‡æ¢åˆ°xxxåˆ†æ”¯ git branch å‚æ•°-a: æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯ï¼ŒåŒ…æ‹¬è¿œç«¯çš„åˆ†æ”¯ã€‚ -v æŸ¥çœ‹åˆ†æ”¯æŒ‡å‘çš„commitã€‚ â€”remoteæŸ¥çœ‹è¿œç¨‹åˆ†æ”¯ 3ã€åˆå¹¶åˆ†æ”¯ å…ˆæŠŠä½ æ¬¡è¦åˆ†æ”¯æäº¤å®Œå…¨ã€‚ åˆ‡æ¢åˆ°ä½ è¦åˆå¹¶å…¶ä»–åˆ†æ”¯çš„ä¸»åˆ†æ”¯ä¸Š åˆå¹¶ 1git merge test // åœ¨ä¸»åˆ†æ”¯ä¸Šåˆå¹¶teståˆ†æ”¯ å¯ä»¥çœ‹åˆ°å·²ç»åˆå¹¶äº†test1åˆ†æ”¯ã€‚ç°åœ¨å®ƒä»¬æŒ‡å‘åŒä¸€ä¸ªcommitã€‚ å¦‚æœé‡åˆ°å†²çªï¼Œæ‰‹åŠ¨åˆ¤æ–­å“ªä¸€ä¸ªä¿®æ”¹ç•™ä¸‹ã€‚ 4ã€åˆ é™¤åˆ†æ”¯123456git branch -d [branch name]git push origin --delete [branch name] // åˆ é™¤è¿œç¨‹åˆ†æ”¯$ git push origin --delete testingTo github.com:BeenLi/learn_git.git - [deleted] testing 5ã€è¿œç¨‹åˆ†æ”¯1234567891011$ git ls-remote // æŸ¥çœ‹è¿œç¨‹åˆ†æ”¯$ git branch -r -v // æŸ¥çœ‹è¿œç¨‹åˆ†æ”¯From git@github.com:BeenLi/learn_git.git6fc7758ee27a73196a81391efd803dc19541eb88 HEAD6fc7758ee27a73196a81391efd803dc19541eb88 refs/heads/master807b956e7a57eef2f148dc7cb5b14ae3992955e6 refs/heads/testing807b956e7a57eef2f148dc7cb5b14ae3992955e6 refs/pull/1/head998239f25772ea809310d9f92c9e96a67c158b82 refs/pull/1/merge$ git remote show // æŸ¥çœ‹è¿œç¨‹ä»“åº“åå­—remote_name â€œoriginâ€ æ˜¯å½“ä½ è¿è¡Œ git clone æ—¶é»˜è®¤çš„è¿œç¨‹ä»“åº“åå­— 6ã€è·Ÿè¸ªåˆ†æ”¯1234567git checkout -b [branch] [remotename]/[branch]git checkout --track origin/serverfix // å¿«æ·å‘½ä»¤å½“å…‹éš†ä¸€ä¸ªä»“åº“æ—¶ï¼Œå®ƒé€šå¸¸ä¼šè‡ªåŠ¨åœ°åˆ›å»ºä¸€ä¸ªè·Ÿè¸ª origin/master çš„ master æœ¬åœ°åˆ†æ”¯git branch --set-upstream-to origin/remoteBranchName localBranchName ä¿®æ”¹è¿œç¨‹åˆ†æ”¯git branch --unset-upstream // æ’¤é”€è·Ÿè¸ªè¿œç¨‹åˆ†æ”¯ å¯ä»¥çœ‹åˆ° è®¾ç½®äº†åˆ†æ”¯test3 è·Ÿè¸ª è¿œç«¯çš„masteråˆ†æ”¯ã€‚ç°åœ¨åˆ†æ”¯ä¸masteråˆ†æ”¯ç›¸åŒã€‚ ç°åœ¨ï¼Œæœ¬åœ°åˆ†æ”¯ test ä¼šè‡ªåŠ¨ä» remote_name/master æ‹‰å–ã€‚ 123456789$ git branch -vv master 2b2be16 ä¿®æ”¹æ–‡ä»¶ï¼Œåˆ¶é€ åˆå¹¶å†²çª test1 2b2be16 ä¿®æ”¹æ–‡ä»¶ï¼Œåˆ¶é€ åˆå¹¶å†²çª test2 420f721 ç¬¬äºŒæ¬¡æœ¬åœ°æäº¤ testing e051a6f [remote_name/testing: ahead 1] æµ‹è¯•è¿½è¸ªåˆ†æ”¯æƒ…å†µ* test3 4fdb7bd [remote_name/master] æµ‹è¯•æœ¬åœ°æäº¤å¯ä»¥çœ‹åˆ°test3 æ˜¯masterçš„è·Ÿè¸ªåˆ†æ”¯ã€‚testingåˆ†æ”¯é¢†å…ˆ1ã€‚è¡¨ç¤ºæœ‰æœ¬åœ°æœ‰ä¸€ä¸ªcommitæ²¡æœ‰pushåˆ°æœåŠ¡å™¨ä¸Šã€‚ 7ã€åˆ†æ”¯æ‹‰å–12git pull == git fetch + git mergegit fetch ä¸ä¼šä¿®æ”¹å½“å‰å·¥ä½œåŒºçš„æ–‡ä»¶ã€‚å®ƒåªä¼šè·å–æ•°æ®ç„¶åè®©ä½ è‡ªå·±åˆå¹¶ã€‚ 8ã€ä¸Šä¼ åˆ†æ”¯12git push origin localbranch:remotebranchå¦‚æœæ·»åŠ äº†è¿œç¨‹åˆ†æ”¯å°±ç›´æ¥pushäº†ã€‚ 2ã€reset (æ’¤é”€)å‚è€ƒğŸ”— 1ã€reset â€”hardreset â€”hardï¼šé‡ç½®stageåŒºå’Œå·¥ä½œç›®å½•(ä¼šåœ¨é‡ç½® HEAD å’Œbranchçš„åŒæ—¶ï¼Œé‡ç½®stageåŒºå’Œå·¥ä½œç›®å½•é‡Œçš„å†…å®¹) å³å›åˆ°ä¸Šä¸€æ¬¡commitçš„ä½ç½®ã€‚ï¼Œå…¨éƒ¨æ¸…ç©ºã€‚ 2ã€reset â€”softreset â€”softï¼šä¿ç•™å·¥ä½œç›®å½•å’Œæš‚å­˜åŒºä¸­çš„å†…å®¹ï¼Œå¹¶æŠŠé‡ç½® HEAD æ‰€å¸¦æ¥çš„æ–°çš„å·®å¼‚æ”¾è¿›æš‚å­˜åŒº å³ä½ ä¹‹å‰commitçš„æ–‡ä»¶ï¼Œé€€å›åˆ°stageã€‚éœ€è¦é‡æ–°æäº¤ã€‚ 3ã€reset [â€”mixed]reset: ä¿ç•™å·¥ä½œç›®å½•ï¼Œå¹¶æ¸…ç©ºæš‚å­˜åŒº ä¹Ÿå°±æ˜¯ä½ è¦é‡æ–°addï¼Œç„¶åcommitã€‚ Reference[1] åˆ†æ”¯ç”¨æ³• [2] resetç”¨æ³• [3] ç®€æ˜æ•™ç¨‹ [4] åŠ¨æ€è¿‡ç¨‹","categories":[{"name":"Software","slug":"Software","permalink":"https://www.beenli.cn/categories/Software/"},{"name":"Git","slug":"Software/Git","permalink":"https://www.beenli.cn/categories/Software/Git/"}],"tags":[{"name":"git","slug":"git","permalink":"https://www.beenli.cn/tags/git/"}]},{"title":"æ•°æ®ç»“æ„â€”â€”æ ‘","slug":"æ•°æ®ç»“æ„â€”â€”æ ‘","date":"2020-04-09T05:43:31.000Z","updated":"2020-08-22T07:22:18.619Z","comments":true,"path":"posts/f796a091/","link":"","permalink":"https://www.beenli.cn/posts/f796a091/","excerpt":"","text":"1ã€æ ‘çš„ç›¸å…³æœ¯è¯­ åº¦ï¼šä¸€ä¸ªç»“ç‚¹çš„å­ç»“ç‚¹æ•°ç›®ã€‚æ ‘çš„åº¦æŒ‡åº¦æ•°æœ€å¤§çš„é‚£ä¸ªç»“ç‚¹çš„åº¦ TD = max_{i=1...n}D(i)\\quad D(i)è¡¨ç¤ºç¬¬iä¸ªç»“ç‚¹çš„åº¦ å¶ç»“ç‚¹ï¼Œåˆ†æ”¯ç»“ç‚¹ åº¦ä¸º0çš„ç»“ç‚¹â€”â€”å¶ç»“ç‚¹ï¼›åº¦å¤§äº0çš„ç»“ç‚¹â€”â€”åˆ†æ”¯ç»“ç‚¹ ç»“ç‚¹çš„å±‚æ•° (1) root(T)â€”â€”å±‚æ•°ä¸º0 (2)å…¶ä½™ç»“ç‚¹å±‚æ•°ä¸ºå‰é©±ç»“ç‚¹å±‚æ•° + 1 è·¯å¾„ V_mâ€”â€”>V_{m+1}â€”â€”>...â€”â€”>V_{m+k} \\quad1","categories":[{"name":"CS","slug":"CS","permalink":"https://www.beenli.cn/categories/CS/"},{"name":"Data Structure","slug":"CS/Data-Structure","permalink":"https://www.beenli.cn/categories/CS/Data-Structure/"}],"tags":[{"name":"C","slug":"C","permalink":"https://www.beenli.cn/tags/C/"}]},{"title":"Tasks and Functions","slug":"Tasks-and-Functions","date":"2020-04-08T14:20:43.000Z","updated":"2020-09-30T12:00:56.368Z","comments":true,"path":"posts/71407778/","link":"","permalink":"https://www.beenli.cn/posts/71407778/","excerpt":"","text":"Tasks and Functions1ã€What are they good for Tasks and functions provide the ability to execute common procedures from several different places in a description. They also provide a means of breaking up large procedures into smaller ones to make it easier to read and debug the source descriptions. ä»std 1364-2005çš„è¿™æ®µæè¿°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ€»ç»“å‡ºä»¥ä¸‹ç”¨å¤„: å‡å°‘é‡å¤å·¥ä½œï¼Œä»£ç å¤ç”¨ã€‚ æŠŠå¤§çš„è¿‡ç¨‹æ‹†è§£æˆå‡ ä¸ªå°çš„ä»»åŠ¡å’Œå‡½æ•°ï¼Œæ›´åŠ æ˜“è¯»å’Œæ‰¾bug 2ã€Distinctions between tasks and functions A function shall execute in one simulation time unit; a task can contain time-controlling statements. å‡½æ•°åº”è¯¥ç¬é—´è¿”å›ç»“æœï¼Œä¸èƒ½æœ‰å»¶æ—¶ï¼›è€Œä»»åŠ¡å¯ä»¥å¸¦æœ‰å»¶æ—¶æ§åˆ¶è¯­å¥ã€‚ A function cannot enable a task; a task can enable other tasks and functions. å‡½æ•°ä¸èƒ½è°ƒç”¨ä»»åŠ¡ï¼›ä½†æ˜¯ä»»åŠ¡å¯ä»¥è°ƒç”¨å…¶ä»–ä»»åŠ¡æˆ–è€…å‡½æ•°ã€‚ A function shall have at least one input type argument and shall not have an output or inout type argument; a task can have zero or more arguments of any type. å‡½æ•°åº”è¯¥è‡³å°‘æœ‰ä¸€ä¸ªè¾“å…¥å‚æ•°å¹¶ä¸”ä¸èƒ½æœ‰è¾“å‡ºæˆ–è€…è¾“å…¥è¾“å‡ºå‚æ•°ã€‚ ä»»åŠ¡å¯ä»¥æœ‰é›¶ä¸ªæˆ–è€…ä»»æ„ä¸ªä»»ä½•ç§ç±»çš„å‚æ•°ã€‚ A function shall return a single value; a task shall not return a value. å‡½æ•°åº”è¯¥è¿”å›ä¸€ä¸ªå•ä¸€çš„å€¼ï¼›ä»»åŠ¡ä¸èƒ½è¿”å›å€¼(åªèƒ½é€šè¿‡æŠŠå¤„ç†æ”¾åœ¨å‚æ•°ä¸Šå¸¦å›) The purpose of a function is to respond to an input value by returning a single value. A task can support multiple goals and can calculate multiple result values. However, only the output or inout type arguments pass result values back from the invocation of a task. A function is used as an operand in an expression; the value of that operand is the value returned by the function. å‡½æ•°çš„ç›®çš„ï¼šå¯¹äºè¾“å…¥ç»™å‡ºä¸€ä¸ªè¿”å›ç»“æœ ä»»åŠ¡æ”¯æŒå¤šä¸ªç»“æœï¼Œä½†æ˜¯åªæœ‰è¾“å‡ºæˆ–è€…è¾“å…¥è¾“å‡ºå‚æ•°èƒ½å¤Ÿä¼ é€’è¿™ç§ç»“æœ å‡½æ•°å¯ä»¥åœ¨è¡¨è¾¾å¼ä¸­ç”¨ä½œä¸€ä¸ªæ“ä½œæ•°ã€‚ï¼ˆå…¶å€¼å°±æ˜¯å‡½æ•°è¿”å›çš„ç»“æœã€‚æ˜¯ä¸æ˜¯å¾ˆåƒC) ä¾‹å¦‚ï¼š 123switch_bytes(old_word, new_word); //taskä¼šæŠŠè¿ç®—ç»“æœæ”¾åœ¨new_wordä¸Šnew_word = switch_bytes(old_word); //functionä¼šç›´æ¥æŠŠç»“æœè¿”å›ã€‚ | æ¯”è¾ƒç‚¹ | tasks | functions || â€”â€”â€”â€”â€”â€”â€” | â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”- | â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” || è¾“å…¥è¾“å‡º | ä»»æ„å¤šè¾“å…¥è¾“å‡º(input,output,inout) | è‡³å°‘ä¸€ä¸ªè¾“å…¥ä¸èƒ½æœ‰è¾“å‡º || è§¦å‘äº‹ä»¶æ§åˆ¶ | å¯ä»¥åŒ…å«å»¶æ—¶æ§åˆ¶è¯­å¥(#), åªèƒ½é¢å‘ä»¿çœŸï¼Œä¸èƒ½ç»¼åˆ | ä¸èƒ½å‡ºç°always, # ç­‰è¯­å¥ï¼Œå‡½æ•°åº”è¯¥åœ¨ä¸€ä¸ªæ—¶é—´å•å…ƒå†…è¿”å›å€¼ || è¿”å›å€¼ | é€šè¿‡è¾“å‡ºç«¯å£ä¼ é€’ | é€šè¿‡å‡½æ•°åè¿”å›(only one) || ä¸­æ®µ | å¯ä»¥ç”±disableä¸­æ–­ | ä¸èƒ½ || è¯­å¥ | | || è°ƒç”¨å…¶ä»– | å¯ä»¥è°ƒç”¨taskå’Œfunction | åªèƒ½è°ƒç”¨functionï¼Œä¸èƒ½è°ƒç”¨task || å…¶ä»–è¯´æ˜ | taskè°ƒç”¨å¯ä»¥ä½œä¸ºå®Œæ•´çš„è¯­å¥å‡ºç° | functionè°ƒç”¨åªèƒ½ä½œä¸ºèµ‹å€¼è¯­å¥å³è¾¹çš„operand | 3ã€ Tasks and task enabling A task shall be enabled from a statement that defines the argument values to be passed to the task and the variables that receive the results. Control shall be passed back to the enabling process after the task has completed. Thus, if a task has timing controls inside it, then the time of enabling a task can be different from the time at which the control is returned. A task can enable other tasks, which in turn can enable still other tasksâ€”with no limit on the number of tasks enabled. Regardless of how many tasks have been enabled,control shall not return until all enabled tasks have completed. è°ƒç”¨taskåº”è¯¥ç»™å‡ºä¼ è¿›å‚æ•°çš„å€¼ï¼Œå’Œæ¥å—ç»“æœçš„å˜é‡ã€‚ taskå¦‚æœæœ‰å»¶æ—¶æ§åˆ¶ï¼Œé‚£ä¹ˆtaskè¢«è°ƒç”¨æ—¶åˆ»å’Œæ§åˆ¶è¿”å›æ—¶åˆ»å¯ä»¥ä¸åŒã€‚ taskå†…å¯ä»¥å†è°ƒç”¨taskï¼Œç›´åˆ°æ‰€æœ‰çš„taskå®Œæˆæ‰ä¼šè¿”å›æ§åˆ¶åˆ°é¡¶å±‚è°ƒç”¨å¤„ã€‚ 3.1ã€task declaration syntaxes1234567891011task_declaration ::= (From A.2.7) task [ automatic ] task_identifier ; { task_item_declaration } statement_or_null endtask task_declaration ::= (From A.2.7) task [ automatic ] task_identifier ( [ task_port_list ] ) ; { block_item_declaration } statement_or_null endtask Tasks without the optional keyword automatic are static tasks, with all declared items being statically allocated. These items shall be shared across all uses of the task executing concurrently. All items declared inside automatic tasks are allocated dynamically for each invocation Automatic task items cannot be accessed by hierarchical references. Automatic tasks can be invoked through use of their hierarchical name.ï¼ˆautomaticçš„å‘åé¢å†å¡«) 3.2ã€Task enabling and argument passing12task_enable ::= (From A.6.9) hierarchical_task_identifier [ ( expression { , expression } ) ] ; If the argument is declared as an output or an inout, then the expression shall be restricted to an expression that is valid on the left-hand side of a procedural assignment.(è¾“å‡ºå‚æ•°ï¼šèƒ½ä½äºè¿‡ç¨‹èµ‹å€¼è¯­å¥å·¦è¾¹çš„æœ‰æ•ˆè¡¨è¾¾å¼ã€‚ä¸èƒ½æ˜¯wire) reg, integer, real, realtime, and time variables Memory references Concatenations of reg, integer, and time variables Concatenations of memory references Bit-selects and part-selects of reg, integer, and time variables All arguments to the task shall be passed by value rather than by reference ä»»åŠ¡å‚æ•°çš„æ˜¯å€¼ä¼ é€’ä¸æ˜¯å¼•ç”¨(æŒ‡é’ˆ) If an argument in the task is declared as an input, then the corresponding expression can be any expression.The order of evaluation of the expressions in the argument list is undefined. å¦‚æœå‚æ•°è¢«å®šä¹‰ä¸ºinputï¼Œé‚£ä¹ˆè°ƒç”¨è¯­å¥ä¸ä¹‹ç›¸åº”ä½ç½®çš„è¡¨è¾¾å¼æ²¡æœ‰é™åˆ¶ï¼Œè¡¨è¾¾å¼æ±‚å€¼è¿‡ç¨‹æ˜¯æ²¡æœ‰è¢«å®šä¹‰çš„ã€‚ï¼ˆæ±‚å€¼é¡ºåºæ²¡æœ‰å…ˆåï¼‰ 123456789101112task my_task; input a, b; inout c; output d, e; begin . . . // statements that perform the work of the task . . . c = foo1; // the assignments that initialize result regs d = foo2; e = foo3; endendtask 123456789task my_task ( input a, b, inout c, output d, e); begin . . . // statements that perform the work of the task . . . c = foo1; // the assignments that initialize result regs d = foo2; e = foo3; endendtask ä¸€ç§æ˜¯å‚æ•°åˆ—è¡¨åœ¨å‡½æ•°ååå®šä¹‰ã€‚ä¸€ç§æ˜¯åœ¨taské‡Œé¢å®šä¹‰ã€‚ my_task (v, w, x, y, z); //è°ƒç”¨è¯­å¥ The task-enabling arguments ( v , w , x , y , and z ) correspond to the arguments ( a , b , c , d , and e ) defined by the task. å½“å‡½æ•°è°ƒç”¨æ—¶: a = v; b = w; c = x; When the task completes, the following assignments to return the computed values to thecalling process are performed:(å½“å‡½æ•°ç»“æŸåï¼Œä¸‹é¢çš„èµ‹å€¼è¿”å›å¯¹åº”çš„ç»“æœ) x = c; y = d; z = e; task enable statementä¸­å‚æ•°ä½ç½®è¦å’Œtask definition å¯¹åº”ã€‚ä¸ç®¡ä½ æ˜¯å“ªç§æ–¹æ³•å®šä¹‰task 3.3ã€Task memory usage and concurrent ğŸ¤•ï¼ˆå¯ä»¥è·³è¿‡ï¼‰A task may be enabled more than once concurrently. All variables of an automatic task shall be replicated on each concurrent task invocation to store state specific to that invocation.All variables of a static task shall be static in that there shall be a single variable corresponding to each declared local variable in a module instance, regardless of the number of concurrent activations of the task. However, static tasks in different instances of a module shall have separate storage from each other. 4ã€Disabling of named blocks and tasksThe disable statement provides the ability to terminate the activity associated with concurrently active procedures, while maintaining the structured nature of Verilog HDL procedural descriptions.ï¼ˆdisable è¯­å¥å¯ä»¥ç»ˆæ­¢æ­£åœ¨è¿è¡Œçš„è¿‡ç¨‹ï¼‰ 12345begin : block_name rega = regb; disable block_name; regc = rega; // this assignment will never executeend 1234567begin : block_name ... if (a == 0) disable block_name; ...end // end of named block// continue with code following named block 12345678910task proc_a; begin ... ... if (a == 0) disable proc_a; // return if true(æ§åˆ¶æƒäº¤å›è°ƒç”¨è¯­å¥) ... ... endendtask 1234567891011121314begin : break for (i = 0; i &lt; n; i = i+1) begin : continue @ clk if (a == 0) // \"continue\" loop disable continue; //(ç›¸å½“äºcé‡Œé¢çš„break) statements statements @ clk if (a == b) // \"break\" from loop disable break; // (ç›¸å½“äºcé‡Œé¢çš„break) statements statements endend 12345678fork begin : event_expr @ ev1; repeat (3) @ trig; # d action (areg, breg); //(åªæœ‰å½“ev1å‡ºç°ï¼Œtrigå‡ºç°3æ¬¡æ‰è§¦å‘) end @ reset disable event_expr; //(åŒä¸Šé¢å¹¶è¡Œè¿›è¡Œ)join 1234567always begin : monostable # 250 q = 0;endalways @ retrig begin //ï¼ˆåªè¦retrigå˜åŒ–é—´éš”å°äº250ï¼Œé‚£ä¹ˆqå°±ä¸€ç›´ä¸º1) disable monostable; q = 1;end 5ã€Functions and function calling 5.1ã€Function declarations123456789101112function_declaration ::= (From A.2.6) function [ automatic ] [ function_range_or_type ] function_identifier ; function_item_declaration { function_item_declaration } function_statement endfunction | function [ automatic ] [ function_range_or_type ] function_identifier ( function_port_list ) ; { block_item_declaration } function_statement endfunction 12345678function [7:0] getbyte; // (å¦‚æœæ²¡æœ‰ç»™[range]é‚£ä¹ˆé»˜è®¤ä¸ºscalar) input [15:0] address; begin // code to extract low-order byte from addressed word . . . getbyte = result _expression; endendfunction 1234567function [7:0] getbyte ( input [15:0] address); begin // code to extract low-order byte from addressed word . . . getbyte = result _expression; endendfunction 5.2ã€Returning a value from a functionThe function definition shall implicitly declare a variable, internal to the function, with the same name as the function. This variable either defaults to a 1-bit reg or is the same type as the type specified in the function declaration. The function definition initializes the return value from the function by assigning the function result to the internal variable with the same name as the function. å‡½æ•°å®šä¹‰å°±éšå«äº†ä¸€ä¸ªå˜é‡ï¼ˆå³å‡½æ•°åï¼‰ å‡½æ•°é€šè¿‡ç»™è¿™ä¸ªéšå«å˜é‡èµ‹å€¼è¿”å›å€¼ã€‚ 5.3ã€Calling a function12function_call ::= (From A.8.2) hierarchical_function_identifier{ attribute_instance } ( expression { , expression } ) 1word = control ? {getbyte(msbyte), getbyte(lsbyte)}:0;(æŠŠä¸¤æ¬¡å‡½æ•°è°ƒç”¨çš„ç»“æœæ‹¼æ¥èµ·æ¥) 5.4ã€Function rules A function shall not have any nonblocking assignments or procedural continuous assignments. å‡½æ•°ä¸èƒ½æœ‰éé˜»å¡èµ‹å€¼æˆ–è€…è¿‡ç¨‹è¿ç»­èµ‹å€¼ï¼ˆåœ¨ä¸€ä¸ªæ—¶é—´å•ä½å†…å®Œæˆï¼‰ A function shall not have any event triggers. å‡½æ•°ä¸èƒ½æœ‰ä»»ä½•æ—¶é—´è§¦å‘ 123456789101112131415161718module tryfact;// define the functionfunction automatic integer factorial;input [31:0] operand;integer i;if (operand &gt;= 2) factorial = factorial (operand - 1) * operand;else factorial = 1;endfunction// test the functioninteger result;integer n;initial beginfor (n = 0; n &lt;= 7; n = n+1) beginresult = factorial(n);$display (\"%0d factorial=%0d\", n, result); 5.5ã€ Use of constant functionsğŸ¤•ï¼ˆå¯ä»¥è·³è¿‡ï¼‰Constant function calls are used to support the building of complex calculations of values at elaboration time å¸¸é‡å‡½æ•°è°ƒç”¨ç”¨äºæ”¯æŒåœ¨ç²¾åŒ–é˜¶æ®µæ„å»ºå¤æ‚çš„å€¼è®¡ç®— ğŸ™‚o_o â€¦.å¾…å¡«å‘ã€‚ Renference[IEEE Std 1364â„¢-2005ä¸‹è½½ğŸ”—]ï¼šé“¾æ¥ï¼šhttps://pan.baidu.com/s/1ryz4IAuQzNPnGifUJ8oAGwæå–ç ï¼š2qvb","categories":[{"name":"Digital IC","slug":"Digital-IC","permalink":"https://www.beenli.cn/categories/Digital-IC/"},{"name":"verilog","slug":"Digital-IC/verilog","permalink":"https://www.beenli.cn/categories/Digital-IC/verilog/"}],"tags":[{"name":"specification","slug":"specification","permalink":"https://www.beenli.cn/tags/specification/"}]},{"title":"git hooksè‡ªåŠ¨éƒ¨ç½²hexo","slug":"git-hookè‡ªåŠ¨éƒ¨ç½²hexo","date":"2020-04-08T01:17:29.000Z","updated":"2020-08-05T09:57:43.216Z","comments":true,"path":"posts/fb29ac9a/","link":"","permalink":"https://www.beenli.cn/posts/fb29ac9a/","excerpt":"","text":"git hooks è‡ªåŠ¨éƒ¨ç½²hexo1ã€åŸç†å¤§è‡´å¦‚ä¸‹ 2ã€å®æ–½è¿‡ç¨‹ åœ¨æœåŠ¡å™¨ä¸Šæ­å»ºä¸€ä¸ªgitæœåŠ¡å™¨1 adduser git(åˆ›å»ºä¸€ä¸ªç”¨æˆ·) å¯ä»¥ç»™åˆ›å»ºçš„ç”¨æˆ·è®¾ç½®å¯†é’¥passwd git èµ‹äºˆgitç”¨æˆ·sudoæƒé™ 12chmod 740 /etc/sudoers vim /etc/sudoer 1234567891011121314 `ç»™gitç”¨æˆ·æ·»åŠ å‘½ä»¤æƒé™å¦‚ä¸‹` ä¿å­˜åé€€å‡ºï¼Œä¿®æ”¹å›æ–‡ä»¶æƒé™`chmod 440 /etc/sudoers` ![mark](http://image.beenli.cn/img/20200408/cSLiyuqjcxOU.jpg?imageslim)2. åˆå§‹åŒ–gitä»“åº“ ```bash su git //åˆ‡æ¢è‡³gitç”¨æˆ· mkdir blog.git //åˆ›å»ºä»“åº“æ–‡ä»¶å¤¹ cd blog.git //è¿›å…¥æ–‡ä»¶å¤¹ git init --bare //ä½¿ç”¨--bareå‚æ•°åˆå§‹åŒ–ä¸ºè£¸ä»“åº“ï¼Œè¿™æ ·åˆ›å»ºçš„ä»“åº“ä¸åŒ…å«å·¥ä½œåŒº åˆ›å»ºç½‘ç«™ç›®å½• 123sudo mkdir /var/www/blog //åˆ›å»ºç½‘ç«™æ ¹ç›®å½•sudo chown -R git.git /var/www/blog //æŠŠblogç›®å½•ä»¥åŠå­ç›®å½•å±ç»„æ”¹ä¸ºgit(è¿™ä¸€æ­¥å¾ˆé‡è¦ï¼Œå¦è€…åç»­æäº¤æ²¡æœ‰æƒé™) é…ç½®å¯†é’¥[è¯¦æƒ…è§:sshåè®®](https://www.beenli.cn/posts/782a8ece/ 123mkdir .ssh //åˆ›å»º.sshç›®å½•(é»˜è®¤ä½ åœ¨gitç”¨æˆ·çš„~ç›®å½•ä¸‹)cd .sshtouch authorized_keys //æŠŠä½ æœ¬åœ°ç”Ÿæˆçš„å…¬é’¥æ‹·è´åˆ°æ­¤æ–‡ä»¶å¤¹ç§ é…ç½®hooks(git ç”¨æˆ·ä¸‹)2 123cd ~/blog.git/hooks //åˆ‡æ¢åˆ°hooksç›®å½•touch post-receive //åˆ›å»ºpost-receiveæ–‡ä»¶chmod +x post-receive //èµ‹äºˆå…¶å¯æ‰§è¡Œæƒé™ The post-receive hook runs after the entire process is completed and can be used to update other services or notify users. It takes the same stdin data as the pre-receive hook. Examples include emailing a list, notifying a continuous integration server, or updating a ticket-tracking system â€“ you can even parse the commit messages to see if any tickets need to be opened, modified, or closed. This script canâ€™t stop the push process, but the client doesnâ€™t disconnect until it has completed, so be careful if you try to do anything that may take a long time. å¤åˆ¶è¯¥æ®µä»£ç åˆ°åˆšåˆšåˆ›å»ºçš„post-receiveæ–‡ä»¶ 1234567891011#!/bin/bashecho \"post-receive hook is running...\"GIT_REPO=/home/git/blog.gitTMP_GIT_CLONE=/tmp/blogPUBLIC_WWW=/var/www/blogrm -rf ${TMP_GIT_CLONE}git clone $GIT_REPO $TMP_GIT_CLONErm -rf ${PUBLIC_WWW}/*cp -rf ${TMP_GIT_CLONE}/* ${PUBLIC_WWW} åœ¨æ‰§è¡Œcpï¼ˆå¤åˆ¶)å‘½ä»¤çš„æ—¶å€™ï¼Œ.git ä½œä¸ºéšè—ç›®å½•ä¸ä¼šè¢«æ‹·è´åˆ° Web æ ¹ç›®å½•ä¸‹ï¼Œä¹Ÿå°±é¿å…äº†å°†æ•´ä¸ªä»“åº“å†å²æš´éœ²åœ¨ Web æœåŠ¡ä¸­ã€‚ æœ€åé…ç½®hexoçš„_config.yml 1234deploy: type: git repository: git@VPS IP:/~/blog.git # é»˜è®¤22ç«¯å£ branch: master Reference [1] Hexo åšå®¢éƒ¨ç½²åˆ° VPS [2] git hooks","categories":[{"name":"Software","slug":"Software","permalink":"https://www.beenli.cn/categories/Software/"},{"name":"Git","slug":"Software/Git","permalink":"https://www.beenli.cn/categories/Software/Git/"}],"tags":[{"name":"git","slug":"git","permalink":"https://www.beenli.cn/tags/git/"},{"name":"Hexo","slug":"Hexo","permalink":"https://www.beenli.cn/tags/Hexo/"}]},{"title":"SSH","slug":"SSH","date":"2020-04-07T16:25:51.000Z","updated":"2020-12-28T09:34:11.768Z","comments":true,"path":"posts/782a8ece/","link":"","permalink":"https://www.beenli.cn/posts/782a8ece/","excerpt":"","text":"SSH Protocol Secure Shell (SSH) is a cryptographic network protocol for operating network services securely over an unsecured network.[1] Typical applications include remote command-line, login, and remote command execution, but any network service can be secured with SSH. æ‘˜è‡ªç»´åŸºç™¾ç§‘ã€‚ä¸»è¦ä¸ºè¿œç¨‹ç™»å½•å»ºç«‹å®‰å…¨çš„é€šé“ã€‚ 1ã€ç®€è¦çš„å·¥ä½œåŸç†sshæœ‰ä¸¤ç§å·¥ä½œæ–¹å¼ åŸºäºå£ä»¤éªŒè¯ åªè¦çŸ¥é“å¸å·å’Œå£ä»¤ï¼Œå°±å¯ä»¥ç™»å½•åˆ°è¿œç¨‹ä¸»æœºã€‚æ‰€æœ‰ä¼ è¾“çš„æ•°æ®éƒ½ä¼šè¢«åŠ å¯†ï¼Œä½†ç¼ºç‚¹æ˜¯ï¼šä¸èƒ½ä¿è¯ä½ æ­£åœ¨è¿æ¥çš„æœåŠ¡å™¨å°±æ˜¯ä½ æƒ³è¿æ¥çš„æœåŠ¡å™¨ã€‚ä»¥ä¸‹æ˜¯ç™»å½•éªŒè¯æµç¨‹ï¼š åŸºäºå¯†é’¥éªŒè¯ 2ã€æ“ä½œè¿‡ç¨‹(æœ¬åœ°win10+æœåŠ¡å™¨centos) æœ¬åœ°ç”Ÿæˆå¯†é’¥å¯¹ 12\"Git Bash Hear\"ssh-keygen -t rsa å¯ä»¥è®¾ç½®å¯†ç ï¼Œä¹Ÿå¯ä»¥ä¸ºç©ºï¼ˆæ—¢ç„¶ä¸ºäº†å…å¯†é‚£å°±è®¾ç½®ä¸ºç©ºå§ï¼Œä¸ç„¶æ²¡æ„ä¹‰äº†ï¼‰ æ–‡ä»¶è·¯å¾„å¯é€‰ã€‚é»˜è®¤æ”¾åœ¨~/.ssh/ ä¸Šä¼ å…¬é’¥åˆ°æœåŠ¡å™¨ä¸Š1 æœ‰ä¸¤ç§åŠæ³•ï¼š è‡ªè¡ŒæŠŠåˆšåˆšä¸Šä¼ çš„å…¬é’¥ä¸Šä¼ åˆ°æœåŠ¡å™¨æŒ‡å®šç”¨æˆ·.ssh/ç›®å½•ä¸‹çš„authorized_keysä¸‹ã€‚ï¼ˆè®¤è¯å¯†é’¥å¯ä»¥æœ‰å¾ˆå¤šæŠŠï¼Œå¤šä¸ªlocalhostå¯ä»¥å„è‡ªä¸Šä¼ è‡ªå·±çš„ğŸ”’åˆ°æœåŠ¡å™¨ä¸Šã€‚ä¹Ÿå¯ä»¥æ‰€æœ‰äººå…¬ç”¨ä¸€æŠŠé”ã€‚ï¼‰ ssh-copy-id -i [./y.pub] username@ip (-iæŒ‡å®šè·¯å¾„ï¼Œé»˜è®¤æ˜¯åœ¨.sshä¸‹) è¿™ä¸€æ­¥ä¹Ÿæ˜¯è¦è®¤è¯å¯†ç çš„ã€‚ä¸ç„¶ä»€ä¹ˆäººéƒ½å¯ä»¥ä¸Šé”å°±ä¹±å¥—ã€‚ å…å¯†ç™»å½•æœåŠ¡å™¨ 1ssh -i[dir] username@ip (-iæŒ‡å®šå¯†é’¥æ‰€åœ¨ï¼Œé»˜è®¤åœ¨.ssh/ä¸‹) å¦‚æœä¹‹å‰äº§ç”Ÿå¯†é’¥å¯¹æ—¶è®¾ç½®äº†å¯†ç ï¼Œè¿™é‡Œè¿˜æ˜¯è¦è¾“å…¥ä¸€éå“ªä¸ªå¯†ç çš„ã€‚å¦‚æœä¸ºç©ºå°±å¯ä»¥ç›´æ¥å…å¯†è¿›å…¥äº† è„šæœ¬æ–‡ä»¶åŠ é€Ÿç™»å½•2 éšä¾¿é€‰æ‹©ä¸ªæ–‡ä»¶å¤¹ï¼Œå†™ä¸€ä¸ªconfigæ–‡ä»¶ Host vps # ä¸€ä¸ªä¾¿äºä½ åŒºåˆ«è¿™æ˜¯å“ªå°æœºå™¨çš„åå­— HostName 47.95.247.18 User git # ç™»å½•ä¸»æœºçš„ç”¨æˆ·åç§° Port 22 IdentityFile ~/.ssh/id_rsa # å¯†é’¥æ‰€åœ¨çš„æ–‡ä»¶ä½ç½® ssh -F [config file] vps(æŒ‡å®šé…ç½®æ–‡ä»¶ä½ç½®)å°±å¯ä»¥ç›´æ¥ç™»å½•ä½ è®¾ç½®çš„é‚£å°ä¸»æœº å¯èƒ½é‡åˆ°çš„é—®é¢˜3 Authentication refused: bad ownership or modes for directory /root/.ssh ls -l /root/.ssh å‘ç°æ”¹ç›®å½•çš„æ‰€æœ‰è€…ä¸æ˜¯rootã€‚åªç”¨æ”¹æˆrootå³å¯ chown -R root.root /root/.ssh Reference [1] SSH ä¸‰æ­¥è§£å†³å…å¯†ç™»å½• [2] sshé…ç½®configå¿«é€Ÿç™»å½• [3] è§£å†³æƒé™é—®é¢˜","categories":[{"name":"CS","slug":"CS","permalink":"https://www.beenli.cn/categories/CS/"},{"name":"Computer Network","slug":"CS/Computer-Network","permalink":"https://www.beenli.cn/categories/CS/Computer-Network/"}],"tags":[{"name":"protocols","slug":"protocols","permalink":"https://www.beenli.cn/tags/protocols/"}]},{"title":"æ“ä½œç³»ç»Ÿ-ç†Ÿæ‚‰å®éªŒç¯å¢ƒ(1)","slug":"æ“ä½œç³»ç»Ÿ-ç†Ÿæ‚‰å®éªŒç¯å¢ƒ-1","date":"2020-04-07T05:07:15.000Z","updated":"2020-09-30T12:09:20.331Z","comments":true,"path":"posts/9cf5ff72/","link":"","permalink":"https://www.beenli.cn/posts/9cf5ff72/","excerpt":"","text":"ç†Ÿæ‚‰å®éªŒç¯å¢ƒ1ã€x86æ¨¡æ‹Ÿå™¨Bochs1Bochs is a highly portable open source IA-32 (x86) PC emulator written in C++, that runs on most popular platforms. It includes emulation of the Intel x86 CPU, common I/O devices, and a custom BIOS. Bochs can be compiled to emulate many different x86 CPUs, from early 386 to the most recent x86-64 Intel and AMD processors which may even not reached the market yet. å¯ä»¥çœ‹åˆ°Bochå¯ä»¥æ¨¡æ‹Ÿintel x86 CPU åœ¨å®ƒæ¨¡æ‹Ÿå‡ºçš„ç¯å¢ƒä¸­å¯ä»¥è¿è¡Œ Linuxã€DOS å’Œå„ç§ç‰ˆæœ¬çš„ Windows ç­‰å¤šç§æ“ä½œç³»ç»Ÿ 2ã€æ“ä½œç³»ç»ŸUbuntuå› ä¸ºæœ‰äº›å®éªŒå†…å®¹æ¶‰åŠåˆ°åœ¨è‡ªå·±æ”¹è¿›çš„ Linux 0.11ä¸‹ï¼Œè¿è¡Œè‡ªå·±ç¼–çš„åº”ç”¨ç¨‹åºã€‚è¢«æ”¹è¿›çš„åŠŸèƒ½éƒ½æ˜¯é«˜ ç‰ˆæœ¬ Linux å†…æ ¸å·²ç»å…·æœ‰çš„ï¼Œåœ¨å…¶ä¸Šç¡®è®¤è‡ªå·±ç¼–å†™çš„åº”ç”¨ç¨‹åºæ— è¯¯åï¼Œå†ç”¨ä¹‹æµ‹è¯•è‡ªå·±æ”¹è¿›çš„ Linux 0.11ï¼Œå¯ä»¥æ›´æœ‰ä¿¡å¿ƒäº›ã€‚ 3ã€å®éªŒå‹ç¼©åŒ…hit-oslabæ–‡ä»¶ç»“æ„: 123456789101112131415161718192021222324252627282930...â””â”€â”€ bocks| â”œâ”€â”€ BIOS-bochs-latest| â”œâ”€â”€ bochs-dbg| â”œâ”€â”€ bochs-gdb| â”œâ”€â”€ bochsrc.bxrc| â”œâ”€â”€ bochsrc-gdb.bxrc| â””â”€â”€ vgabios.bin|â””â”€â”€ hdc| â””â”€â”€ umountedâ””â”€â”€ Linux-0.11| â””â”€â”€ boot| â”œâ”€â”€ kernel| â”œâ”€â”€ fs| â”œâ”€â”€ lib| â”œâ”€â”€ init | â”œâ”€â”€ mm| â”œâ”€â”€ tools | â”œâ”€â”€ include| â”œâ”€â”€ tags| â””â”€â”€ Makefileâ”œâ”€â”€ dbg-asmâ”œâ”€â”€ dbg-câ”œâ”€â”€ gdbâ”œâ”€â”€ gdb-cmd.txtâ”œâ”€â”€ runâ”œâ”€â”€ rungdbâ””â”€â”€ mount-hdc Imageæ–‡ä»¶ æˆ‘ä»¬åœ¨å®¿ä¸»æ“ä½œç³»ç»Ÿä¹Ÿå°±æ˜¯ubuntuä¸Šå¯¹Linux 0.11è¿›è¡Œå¼€å‘ï¼Œä¿®æ”¹å’Œç¼–è¯‘ã€‚ ä¹‹ååœ¨Linux-0.11ç›®å½•ä¼šç”Ÿæˆä¸€ä¸ªImageçš„æ–‡ä»¶ã€‚ï¼ˆç¼–è¯‘åçš„ç›®æ ‡æ–‡ä»¶ï¼‰ è¯¥æ–‡ä»¶åŒ…å«å¼•å¯¼å’Œæ‰€ä»¥å†…æ ¸çš„äºŒè¿›åˆ¶ä»£ç ã€‚ oslab é‡‡ç”¨ bochs æ¨¡æ‹Ÿå™¨åŠ è½½è¿™ä¸ª Image æ–‡ä»¶ï¼Œæ¨¡æ‹Ÿæ‰§è¡Œ Linux 0.11ï¼Œè¿™æ ·çœå´äº†é‡æ–°å¯åŠ¨è®¡ç®—æœºçš„éº»çƒ¦ã€‚ bochsç›®å½• bochsç›®å½•æ˜¯ä¸bochsç›¸å…³çš„æ‰§è¡Œæ–‡ä»¶ã€æ•°æ®æ–‡ä»¶å’Œé…ç½®æ–‡ä»¶ run è„šæœ¬ run æ˜¯ è¿è¡Œbochsçš„è„šæœ¬å‘½ä»¤ è¿è¡Œåbochsä¼šè‡ªåŠ¨åœ¨ä»–çš„ è™šæ‹Ÿè½¯é©±â€”â€”linux-0.11/Image è™šæ‹Ÿç¡¬ç›˜â€”â€”hdc-0.11.img åœ¨ 0.11 ä¸‹è®¿é—®æ–‡ä»¶ç³»ç»Ÿï¼Œè®¿é—®çš„å°±æ˜¯ hdc-0.11.img æ–‡ä»¶å†…è™šæ‹Ÿçš„æ–‡ä»¶ç³»ç»Ÿã€‚ é€€å‡ºbochsä¹‹å‰ç°å­˜ç›˜ï¼Œè¿è¡Œsyncå‘½ä»¤ hdc-0.11.img æ–‡ä»¶ æ–‡ä»¶çš„æ ¼å¼æ˜¯ Minix æ–‡ä»¶ç³»ç»Ÿçš„é•œåƒã€‚Linux æ‰€æœ‰ç‰ˆæœ¬éƒ½æ”¯æŒè¿™ç§æ ¼å¼çš„æ–‡ä»¶ç³»ç»Ÿ æ‰€ä»¥å¯ä»¥åœ¨å®¿ä¸»ç³»ç»Ÿä¸ŠæŒ‚è½½è¯¥æ–‡ä»¶ç³»ç»Ÿã€‚è¾¾åˆ°å®¿ä¸»ç³»ç»Ÿå’ŒLinux 0.11ä¹‹é—´æ–‡ä»¶äº¤æ¢çš„æ•ˆæœ å…¶ä¸­åŒ…å«çš„æ–‡ä»¶æœ‰ï¼š Bash shellï¼› ä¸€äº›åŸºæœ¬çš„ Linux å‘½ä»¤ã€å·¥å…·ï¼Œæ¯”å¦‚ cpã€rmã€mvã€tarï¼› vi ç¼–è¾‘å™¨ï¼› gcc 1.4 ç¼–è¯‘å™¨ï¼Œå¯ç”¨æ¥ç¼–è¯‘æ ‡å‡† C ç¨‹åºï¼› as86 å’Œ ld86ï¼› Linux 0.11 çš„æºä»£ç ï¼Œå¯åœ¨ 0.11 ä¸‹ç¼–è¯‘ï¼Œç„¶åè¦†ç›–ç°æœ‰çš„äºŒè¿›åˆ¶å†…æ ¸ã€‚ ç¼–è¯‘ make all(make å‘½ä»¤ä¼šè‡ªåŠ¨è·³è¿‡æœªè¢«ä¿®æ”¹çš„æ–‡ä»¶ ) å¦‚æœé‡æ–°ç¼–è¯‘æ²¡æœ‰æ•ˆæœå¯ä»¥è¯•è¯•åˆ é™¤ä¸­é—´æ–‡ä»¶: make clean &amp;&amp; make all è¿è¡Œ ./run 4ã€è°ƒè¯• æ±‡ç¼–çº§è°ƒè¯• ./dbg-asm Cè¯­è¨€è°ƒè¯• ./dbg-c ./rungdb(æ–°å¼€ä¸€ä¸ªçª—å£) æ³¨æ„ï¼šå¯åŠ¨çš„é¡ºåºä¸èƒ½äº¤æ¢ï¼Œå¦åˆ™ gdb æ— æ³•è¿æ¥ã€‚ 5ã€æ–‡ä»¶äº¤æ¢1234567891011# å¯åŠ¨æŒ‚è½½è„šæœ¬$ cd ~/oslab$ sudo ./mount-hdc# è¿›å…¥æ–‡ä»¶ç³»ç»Ÿ$ cd ./mount-hdc/# è¯»å†™å®Œæ¯•ï¼Œå¸è½½æ–‡ä»¶ç³»ç»Ÿ$ cd ~/oslab$ sudo umount hdcReference [1] å“ˆå°”æ»¨å·¥ä¸šå¤§å­¦.æ“ä½œç³»ç»Ÿ","categories":[{"name":"CS","slug":"CS","permalink":"https://www.beenli.cn/categories/CS/"},{"name":"OS","slug":"CS/OS","permalink":"https://www.beenli.cn/categories/CS/OS/"}],"tags":[{"name":"online course","slug":"online-course","permalink":"https://www.beenli.cn/tags/online-course/"}]},{"title":"Linuxå¸¸ç”¨å‘½ä»¤","slug":"Linuxå¸¸ç”¨å‘½ä»¤","date":"2020-04-07T04:03:20.000Z","updated":"2020-09-30T12:06:54.423Z","comments":true,"path":"posts/d0edc1ed/","link":"","permalink":"https://www.beenli.cn/posts/d0edc1ed/","excerpt":"","text":"Linuxå¸¸ç”¨å‘½ä»¤ å»ºç«‹è½¯é“¾æ¥ln 1ln -s [æºæ–‡ä»¶] [é“¾æ¥æ–‡ä»¶] (åˆ›å»ºè½¯é“¾æ¥) ä¾‹å¦‚ï¼šåœ¨~/oslab/ä¸‹æœ‰ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶gdbä½ åªèƒ½ç”¨./gdbå»æ‰§è¡Œå®ƒã€‚ä½†æ˜¯ä½ å¯ä»¥æŠŠå®ƒé“¾æ¥åˆ°$PATHä¸‹ï¼Œè¿™æ ·ä½ å¯ä»¥åœ¨ä»»æ„è·¯å¾„éƒ½å¯ä»¥æ‰§è¡Œ 1ln -s ~/oslab/gdb /usr/local/bin/gdb ln -snf ~/oslab/xxx /usr/local/bin/gdb(ä¿®æ”¹) ç§»åŠ¨æ–‡ä»¶mv 1mv [source] [target] ä¾‹å¦‚ï¼š â€‹ mv ~/oslab/oslab/* ~/oslab/ (æŠŠ~/oslab/oslab/ä¸‹çš„æ–‡ä»¶å…¨éƒ¨ å¤åˆ¶åˆ°~/oslab/) mv a.txt b.tax æŠŠæ–‡ä»¶åa.txtæ”¹ä¸ºb.txt è®¾ç½®æƒé™chmodï¼›chown r è¯»å–æƒé™ï¼Œæ•°å­—ä»£å·ä¸º4;w å†™å…¥æƒé™ï¼Œæ•°å­—ä»£å·ä¸º2ï¼›x æ‰§è¡Œæˆ–åˆ‡æ¢æƒé™ï¼Œæ•°å­—ä»£å·ä¸º1ï¼›- ä¸å…·ä»»ä½•æƒé™ï¼Œæ•°å­—ä»£å·ä¸º0ï¼› 7 rwx 6 rw- 5 r-x 4 râ€” 3 -wx 2 -w- 1 â€”x 0 â€”- 123456chmod u+x,g+w f0 //ä¸ºæ–‡ä»¶f0è®¾ç½®è‡ªå·±å¯ä»¥æ‰§è¡Œï¼Œç»„å‘˜å¯ä»¥å†™å…¥çš„æƒé™chmod u=rwx,g=rw,o=r f0 //ä¸ºæ–‡ä»¶f0è®¾ç½®è‡ªå·±å¯ä»¥è¯»å†™æ‰§è¡Œï¼ŒåŒç»„å¯ä»¥è¯»å†™ã€‚å…¶ä»–äººå¯ä»¥è¯»chmod 764 f0 // æ•ˆæœåŒä¸Šchmod a+x f0 // æ‰€æœ‰äººéƒ½å¯ä»¥æ‰§è¡Œchown -R liu /usr/meng //å°†ç›®å½•/usr/mengåŠå…¶ä¸‹é¢çš„æ‰€æœ‰æ–‡ä»¶ã€å­ç›®å½•çš„æ–‡ä»¶å±ä¸»æ”¹æˆ liuï¼š","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.beenli.cn/categories/Linux/"}],"tags":[{"name":"toolkits","slug":"toolkits","permalink":"https://www.beenli.cn/tags/toolkits/"}]},{"title":"VIM Plug-in","slug":"VIM-Plugs","date":"2020-04-06T09:11:58.000Z","updated":"2020-09-30T12:05:04.847Z","comments":true,"path":"posts/b71407e8/","link":"","permalink":"https://www.beenli.cn/posts/b71407e8/","excerpt":"","text":"VIM-Plugs1ã€vim-plug: æ’ä»¶ç®¡ç†å™¨123456call plug#begin('D:/App/vim/vim81/vimfiles/plugs')//æ’ä»¶å®‰è£…ç›®å½•(å¯ä»¥éšæ„å®š)\" Shorthand notation for pluginPlug 'foo/bar' //æ’ä»¶ä¸‹è½½åœ°å€ï¼ŒGitHubå¯ä»¥ç®€å†™call plug#end() // å‡½æ•°ç»“æŸæ ‡å¿— command :PlugInstall // å®‰è£…æ’ä»¶ :PlugClean // æ¸…ç†invalidæ’ä»¶ :PlugUpgrade // å‡çº§æ’ä»¶ :PlugDiff // æŸ¥çœ‹ç°æœ‰æ’ä»¶ä¸ä¸‹è½½åœ°å€å¤„æ’ä»¶ä¸åŒï¼Œå³æ£€æµ‹æ›´æ–°ç»†èŠ‚ :PlugStatus // æŸ¥çœ‹æ’ä»¶åŠ è½½æƒ…å†µ :PlugSnapshot // ç”Ÿæˆç”¨äºæ¢å¤å½“å‰æ’ä»¶å¿«ç…§çš„è„šæœ¬ feature 123456Plug 'zhuzhzh/verilog_emacsauto.vim', {'for': ['verilog', 'systemverilog'] }// å½“ä¸”ä»…å½“æ‰“å¼€çš„æ–‡ä»¶ä¸ºVerilogæˆ–è€…systemVerilogæ—¶åŠ è½½æ­¤æ’ä»¶Plug 'scrooloose/nerdtree', { 'on': 'NERDTreeToggle' }//å½“ä¸”ä»…å½“è§¦å‘toggleå‘½ä»¤æ—¶åŠ è½½æ­¤æ’ä»¶2ã€lightline:å½©è‰²çŠ¶æ€æ  3ã€vim-colors-solarized:æ¯”è¾ƒèˆ’æœçš„é…è‰²æ–¹æ¡ˆ æ­¤æ’ä»¶å«æœ‰ä¸¤ç§è‰²è°ƒï¼šdarkï¼›light call togglebg#map(â€œâ€œ) // å¯ä»¥è®¾ç½®å¿«æ·é”®è‡ªè¡Œåˆ‡æ¢ 4ã€youcompletemeï¼šè‡ªåŠ¨è¡¥å…¨ 5ã€vim-snippets+SirVer/ultisnips : ä»£ç ç‰‡å¡«å……ç¬¬ä¸€ä¸ªæ’ä»¶æä¾›å¥½å¤šè¯­è¨€çš„ä»£ç ç‰‡æ–‡ä»¶ã€‚ç¬¬äºŒæ’ä»¶æä¾›çš„å¡«å……å¼•æ“ã€‚ snippetæœ‰ä¸¤ç§æ ¼å¼ï¼š snippets/*: snippets using snipMate format UltiSnips/*: snippets using UltiSnips format 1234567891011121314å¯ä»¥è‡ªå·±ç¼–å†™snippetsæ–‡ä»¶ {n}ä»£è¡¨è¦å¡«å†™çš„ç©ºç™½å¤„ã€‚/* placeholder*/snippet test // Author: Wan Li // time: `strftime(\"%Y-%m-%d\")` // function: ${1:/*å†™ä¸‹æµ‹è¯•çš„åŠŸèƒ½*/} // --------------------------------------------------- \\`timescale 1ns/1ns \\`include \"${2:/*åŒ…å«çš„æ¨¡å—æ–‡ä»¶*/}\" é…ç½®_vimrcæ–‡ä»¶let g:UltiSnipsExpandTrigger=\"&lt;c-j&gt;\" //ctrl + j è§¦å‘let g:UltiSnipsJumpForwardTrigger=\"&lt;c-b&gt;\" //ctrl + b è·³åˆ°ä¸‹ä¸€ä¸ªéœ€è¦å¡«å†™çš„ç©ºå¤„let g:UltiSnipsJumpBackwardTrigger=\"&lt;c-z&gt;\" //ctrl + z è·³åˆ°ä¸Šä¸€ä¸ªéœ€è¦å¡«å†™çš„ç©ºå‡º6ã€nerdtree: å¯è§†åŒ–ç›®å½•æ ‘ 7ã€tabbar: æ•´é½çš„æ ‡ç­¾çª—å£ 8ã€tpope/vim-commentary: å¿«é€Ÿæ³¨é‡Š gcc ï¼šæ³¨é‡Š/å–æ¶ˆæ³¨é‡Šä¸€è¡Œ gc{motion} gc : æ³¨é‡Šselectionå— 7ï¼Œ17 Commentary 9ã€vim-gutentagsï¼šå€ŸåŠ©universal ctags è‡ªåŠ¨äº§ç”Ÿæ ‡ç­¾æ–‡ä»¶ğŸŒ®æœ‰äº†è¿™ä¸ªæ ‡ç­¾æ–‡ä»¶ï¼Œä½ åˆå¯ä»¥&lt;C+]&gt;è·³è½¬ 10ã€vim-easy-alignï¼šè‡ªåŠ¨å¯¹é½æŒ‰å®˜æ–¹é…ç½®æ¥è®¾ç½®å¿«æ·é”®/gaè§¦å‘ â€œ Start interactive EasyAlign in visual mode (e.g. vipga) xmap ga (EasyAlign) â€œ Start interactive EasyAlign for a motion/text object (e.g. gaip) nmap ga (EasyAlign) 1 Around the 1st occurrences of delimiters 2 Around the 2nd occurrences of delimiters â€¦ * Around all occurrences of delimiters ** Left-right alternating alignment around all delimiters - Around the last occurrences of delimiters (-1) -2 Around the second to last occurrences of delimiters Key Description/Use cases `` General alignment around whitespaces = Operators containing equals sign (=, ==, !=, +=, &amp;&amp;=, â€¦) : Suitable for formatting JSON or YAML . Multi-line method chaining , Multi-line method arguments &amp; LaTeX tables (matches &amp; and \\\\) # Ruby/Python comments \" Vim comments `` Table markdown","categories":[{"name":"Software","slug":"Software","permalink":"https://www.beenli.cn/categories/Software/"},{"name":"VIM","slug":"Software/VIM","permalink":"https://www.beenli.cn/categories/Software/VIM/"}],"tags":[{"name":"toolkits","slug":"toolkits","permalink":"https://www.beenli.cn/tags/toolkits/"}]},{"title":"Gate-and-switch-level modeling","slug":"Gate-and-switch-level-modeling","date":"2020-04-05T01:54:38.000Z","updated":"2020-09-30T12:02:50.978Z","comments":true,"path":"posts/aff089ac/","link":"","permalink":"https://www.beenli.cn/posts/aff089ac/","excerpt":"","text":"Gate-and-switch-level modeling1ã€verilog-std-1364-20051 There are 14 logic gates and 12 switches predefined in the Verilog HDL to provide the gate- and switch-level modeling facility. Modeling with logic gates and switches has the following advantages: â€” Gates provide a much closer one-to-one mapping between the actual circuit and the model. â€” There is no continuous assignment equivalent to the bidirectional transfer gate. Verilog1364-2005æ ‡å‡†è§„å®šäº†26ä¸ªåŸºæœ¬åŸä»¶ï¼Œå…¶ä¸­14ä¸ªé—¨çº§åŸä»¶ï¼Œ12ä¸ªå¼€å…³çº§åŸä»¶ã€‚ å¯¹äºè¿™äº›åŸä»¶ä¸éœ€è¦å®šä¹‰ç›´æ¥è°ƒç”¨ã€‚ 2ã€é—¨çº§å»ºæ¨¡2 å¤šè¾“å…¥é—¨ï¼š 123456n_input_gate_instance ::= [ name_of_gate_instance ] ( output_terminal , input_terminal { , input_terminal } ) and A1(out1, in1, in2);or O1(outa, inb, inc, ind);xor X1(outx, inx, iny, inz, inw); å¤šè¾“å‡ºé—¨è°ƒç”¨: 12345n_output_gate_instance ::= [ name_of_gate_instance ] ( output_terminal { , output_terminal } , input_terminal ) buf BUF_1(bufout1, bufout2, bufout3, bufin);not NOT_1(out1, out2, in); ä¸‰æ€é—¨è°ƒç”¨: 1234enable_gate_instance ::= [ name_of_gate_instance ] ( output_terminal , input_terminal , enable_terminal )bufif1 BF1(data_bus, data, enable); äºŒä¸ªç”µé˜» The instance declaration of a pullup or a pulldown source shall begin with one of the following keywords: pullup , pulldown 12345pull_gate_instance ::= [ name_of_gate_instance ] ( output_terminal ) pullup (strong1) p1 (neta), p2 (netb);In this example, the p1 instance drives neta and the p2 instance drives netb with strong strength. æ³¨æ„: é—¨çº§åŸä»¶çš„ç«¯å£åˆ—è¡¨éƒ½å›ºå®šå¥½äº†ï¼Œå¯ä»¥ä¸ç”¨å®šä¹‰ä¸­é—´è¿æ¥ä¿¡å·ç±»å‹(wire) ç¤ºä¾‹ï¼š1234567891011// é—¨çº§å»ºæ¨¡å®ç°æœ€å°é¡¹è¡¨è¾¾å¼// F(a, b, c) = m1 + m2 + m3 + m6 + m7 = (!a)c + bmodule zuixiaoxiang(out, a, b, c); input a, b, c; output out; wire s1, s2; not U1(s1, a); and U2(s2, s1, c); or U3(out, s2, b);endmodule 3ã€å¼€å…³çº§å»ºæ¨¡ MOS switches cmos pmos nmos rcmos rnmos rpmos rmos : ä»£è¡¨æ™¶ä½“ç®¡å¯¼é€šæ—¶æºæ¼æœ‰è¾ƒé«˜çš„é˜»æŠ—(impedance) 123456The following example declares a pmos switch:pmos p1 (out, data, control);The output is out , the data input is data , and the control input is control.The instance name is p1 . Bidirectional pass switches(åŒå‘å¼€å…³) tran tranif1 tranif0 rtran rtranif1 rtranif0 The bidirectional pass switches shall not delay signals propagating through them. When tranif0, tranif1,rtranif0, or rtranif1 devices are turned off, they shall block signals; and when they are turned on, they shall pass signals. The tran and rtran devices cannot be turned off, and they shall always pass signals.(åŒå‘å¼€å…³æ²¡æœ‰ä¼ æ’­å»¶æ—¶) 12345The following example declares an instance of tranif1:tranif1 t1 (inout1,inout2,control);The bidirectional terminals are inout1 and inout2 . The control input is control . The instance name is t1 .ç¤ºä¾‹ï¼š 123456789101112131415// 2è¾“å…¥ä¸é—¨// time:2020-04-05module and2_1(out, a, b); input a,b; output out; wire s1, s2; supply0 Gnd; supply1 Vdd; pmos U1(s1, Vdd, a); pmos U2(s1, Vdd, b); nmos U3(s1, s2, a); nmos U4(s2, Gnd, b); pmos U5(out, Vdd, s1); nmos U6(out, Gnd, s1);endmodule quarter II ç»¼åˆä¸äº†ï¼Œæ²¡åŠæ³•ç›´æ¥çœ‹viewerã€‚åªèƒ½æŠŠä¹¦ä¸Šçš„å›¾æ‰’æ¥äº†ã€‚ ç»ˆäºæ‰¾åˆ°äº†ä¸€æ¬¾RTLçº§ï¼Œgateçº§ï¼Œå¼€å…³çº§debuggerå’Œviewerçš„è½¯ä»¶trainsistor-level debugger and viewer ä½†æ˜¯ç›®å‰ä¸‹è½½ä¸äº†ï¼Œå¾—æ‰¾å®¢æœè”ç³»ã€‚ä¸çŸ¥æœ‰äººæœ‰ç”¨è¿‡è¿™æ¬¾è½¯ä»¶æ²¡æœ‰ã€‚æœ‰çš„è¯è¯·ä½ ä¸€å®šå‘Šè¯‰æˆ‘ã€‚ Renference [1] verilog-std-1364-2005 [2] è”¡è§‰å¹³.2015.Verilog HDL æ•°å­—é›†æˆç”µè·¯é«˜çº§ç¨‹åºè®¾è®¡ 31P","categories":[{"name":"Digital IC","slug":"Digital-IC","permalink":"https://www.beenli.cn/categories/Digital-IC/"},{"name":"verilog","slug":"Digital-IC/verilog","permalink":"https://www.beenli.cn/categories/Digital-IC/verilog/"}],"tags":[{"name":"specification","slug":"specification","permalink":"https://www.beenli.cn/tags/specification/"}]},{"title":"å›¾åºŠ+è¯„è®º","slug":"å›¾åºŠ-è¯„è®º","date":"2020-04-04T10:11:31.000Z","updated":"2020-12-03T04:41:50.632Z","comments":true,"path":"posts/7928fb24/","link":"","permalink":"https://www.beenli.cn/posts/7928fb24/","excerpt":"","text":"1ã€ä»€ä¹ˆæ˜¯å›¾åºŠ å›¾åºŠä¸€èˆ¬æ˜¯æŒ‡å‚¨å­˜å›¾ç‰‡çš„æœåŠ¡å™¨ï¼›å°±è·Ÿç™¾åº¦ç½‘ç›˜å·®ä¸å¤šã€‚åªä¸è¿‡å®ƒæ˜¯ä¸“é—¨å­˜å‚¨å›¾ç‰‡çš„ã€‚ æœ‰çš„ä¹Ÿå¯ä»¥å­˜å‚¨æ–‡ä»¶ã€‚æœ‰å¾ˆå¤šå…è´¹çš„å›¾åºŠã€‚ä¼šèµ é€10Gå­˜å‚¨ç©ºé—´ 2ã€ä¸ºä»€ä¹ˆè¦ç”¨å›¾åºŠ ç”¨å›¾åºŠå¾ˆæ–¹ä¾¿ã€‚æœåŠ¡å™¨ä¼šç”Ÿæˆä¸€ä¸ªå¤–é“¾ã€‚åœ¨äº’è”ç½‘ä»»ä½•åœ°æ–¹éƒ½èƒ½è®¿é—®åˆ° ç”¨å›¾åºŠè®¿é—®é€Ÿåº¦å¾ˆå¿«ã€‚æœåŠ¡å•†ä¼šä½¿ç”¨cdnåŠ é€Ÿ ç”¨å›¾åºŠå¯ä»¥èŠ‚çœæœ¬åœ°ç©ºé—´ã€‚ 3ã€ä¸ƒç‰›äº‘å›¾åºŠçš„ä½¿ç”¨ æ³¨å†Œä¸€ä¸ªè´¦å·ï¼ˆéœ€è¦èº«ä»½è®¤è¯ï¼‰ åˆ›å»ºä¸€ä¸ªå­˜å‚¨ç©ºé—´ æ³¨æ„ç©ºé—´åç§°æ˜¯å”¯ä¸€ã€‚ è®¿é—®æ§åˆ¶ï¼šé€‰æ‹©ç§æœ‰ï¼šåˆ«äººæ— æ³•è®¿é—®ã€‚å¦‚æœæ˜¯å†™åšå®¢æˆ–è€…å…¬ä¼—å·è¿˜æ˜¯é€‰æ‹©å…¬å¼€å§ï¼ è¿™æ ·å¤–é“¾åˆ«äººæ˜¯å¯ä»¥çœ‹å¾—åˆ°çš„ã€‚ ç»‘å®šå¤‡æ¡ˆçš„åŸŸå ![mark](http://image.beenli.cn/img/20200404/YHkGJVGQk87W.jpg?imageslim) â€‹ å¯ä»¥çœ‹åˆ°ï¼šå¦‚æœä¸ç»‘å®šè‡ªå·±çš„åŸŸåï¼›ç³»ç»Ÿ30å¤©åå›æ”¶å›ã€‚é‚£ä¹ˆä½ ä¹‹å‰çš„å¤–é“¾éƒ½å¤±æ•ˆäº† â€‹ æ‰€ä»¥æœ€å¥½ç»‘å®šè‡ªå·±çš„åŸŸåæ‰ä¸Šçº¿ã€‚ å¦‚æœä½ åªæƒ³è¯•è¯•ï¼Œé‚£ä¹ˆåˆ°è¿™é‡Œä½ å°±å¯ä»¥ç»“æŸäº†ã€‚å¼€å§‹ä½“éªŒå›¾åºŠã€‚ ä¸Šä¼ å®Œæ–‡ä»¶ï¼Œç„¶åè¿”å›ã€‚ä½ å°±å¯ä»¥ç‚¹å‡»æ“ä½œâ€”-&gt;æ›´å¤šâ€”â€”-&gt;å¤åˆ¶å¤–é“¾ è¿™æ—¶å€™ä½ å°±å¯ä»¥ç›´æ¥ä»æµè§ˆå™¨è¾“å…¥è¿™ä¸ªå¤–é“¾è®¿é—®åˆ°ä½ åˆšåˆšä¸Šä¼ çš„æ–‡ä»¶ã€‚ è¿™é‡Œæ¨èä¸€ä¸ªWindowså¹³å°å›¾åºŠç¥å™¨ï¼›å¤§æ¦‚é•¿è¿™æ ·ã€‚ç™»é™†ä¸Šä½ ä¹‹å‰æ³¨å†Œçš„ä¸ƒç‰›äº‘è´¦å·å°±å¯ä»¥ä½¿ç”¨äº†ã€‚ ç”¨å›¾åºŠä¸Šä¼ å›¾ç‰‡é‡åˆ°çš„å‘ï¼š ç”±äºä¸ƒç‰›äº‘é»˜è®¤ç”Ÿæˆçš„å¤–é“¾çš„æ˜¯httpçš„ï¼Œæœ‰äº›æµè§ˆå™¨ä¼šé˜»å¡è¿™ç§ä¸å®‰å…¨èµ„æºã€‚ æˆ‘åªå¥½å»ä¿®æ”¹åè®®ã€‚ è¿™æ—¶é‡åˆ°ç¬¬äºŒä¸ªå‘ã€‚è¦ä½¿ç”¨httpsåè®®ï¼Œä½ ç»‘å®šçš„åŸŸåå¿…é¡»æœ‰è¯ä¹¦ã€‚ æˆ‘åœ¨ç½‘ä¸Šåˆ°å¤„æ‰¾ï¼Œä¹°çš„è¯ä¹¦å¤ªè´µï¼Œåˆ’ä¸æ¥ã€‚å…è´¹çš„è¯ä¹¦æˆæƒåˆå¤ªæ…¢ã€‚ æœ€åç»ˆäºæ‰¾åˆ°äº†ä¸€æ¬¾å…è´¹è¯ä¹¦sslå‘æ”¾æœºæ„ã€‚freessl å…¶é—´è¦ä¸‹è½½ä¸€ä¸ªè½¯ä»¶ï¼ˆkeymanager)æœ€åç”Ÿæˆè¯ä¹¦çš„è¿‡ç¨‹å¾ˆå¿«å‡ åˆ†é’Ÿå°±æå®šã€‚ 4ã€Valineè¯„è®ºç³»ç»Ÿ hexoçš„å¾ˆå¤šä¸»é¢˜éƒ½å†…åµŒäº†è¿™ä¸ªç³»ç»Ÿï¼Œä½ åªéœ€è¦å»cleancloudæ³¨å†Œä¸ªè´¦å·è·å–idå’Œkeyå¡«å…¥é…ç½®æ–‡ä»¶é‡Œé¢å°±èƒ½ç”¨ å¦‚æœä½ æƒ³è¦é‚®ä»¶é€šçŸ¥æˆ–è€…åå°è¯„è®ºç®¡ç†å¯ä»¥ç”¨è¿™ä¸ªæ’ä»¶Valine-Admin é¡¹ç›®éƒ¨ç½²çš„ä¸€å®šè¦æ³¨æ„smtp_passæ˜¯æˆæƒç æˆ–è€…QQç‹¬ç«‹å¯†ç ï¼Œä¸æ˜¯ç™»é™†å¯†ç ã€‚ éƒ¨ç½²å®Œæˆæ•ˆæœå¦‚ä¸‹ã€‚","categories":[{"name":"Software","slug":"Software","permalink":"https://www.beenli.cn/categories/Software/"}],"tags":[{"name":"toolkits","slug":"toolkits","permalink":"https://www.beenli.cn/tags/toolkits/"},{"name":"Hexo","slug":"Hexo","permalink":"https://www.beenli.cn/tags/Hexo/"}]},{"title":"testbench(1)","slug":"testbench-1","date":"2020-04-04T02:38:11.000Z","updated":"2020-09-30T12:01:40.761Z","comments":true,"path":"posts/26241a85/","link":"","permalink":"https://www.beenli.cn/posts/26241a85/","excerpt":"","text":"Testbench(1)1ã€testbenchçš„ç»“æ„ testbenchæ²¡æœ‰è¾“å…¥è¾“å‡ºæ¥å£ æµ‹è¯•æ¨¡å—åªè´Ÿè´£å¯¹å¾…æµ‹è¯•ç³»ç»Ÿæ¥å£æä¾›æ¿€åŠ±ä¿¡å·;å¹¶ç›‘æ§è¾“å‡º testbenchä»£ç ä¸éœ€è¦å¯ç»¼åˆï¼Œå³ä¸è¢«å®ç°æˆç”µè·¯ äº§ç”Ÿé€‚å½“çš„æ¿€åŠ±å¹¶è¾¾åˆ°è¦†ç›–ç‡è¦æ±‚ 2ã€æµ‹è¯•æ¿€åŠ±çš„æè¿°æ–¹å¼ ä¿¡å·çš„åˆå§‹åŒ– 12345ç¬¬ä¸€ç§: initial åˆå§‹åŒ–initial a = 0;ç¬¬äºŒç§: å®šä¹‰ä¿¡å·æ—¶åˆå§‹åŒ–reg[3:0] cnt = 4'b1010; å»¶è¿Ÿæ§åˆ¶ å»¶è¿Ÿè¯­å¥ å¤–éƒ¨æ—¶é—´æ§åˆ¶ 12345678initial #5 a = b;(ç­‰å¾…5tickåè®¡ç®—å³ç«¯çš„å€¼å¹¶èµ‹å€¼ç»™å·¦è¾¹ğŸ‘ˆ)ç­‰ä»·äº:initialbegin #5; a=b;end å†…éƒ¨æ—¶é—´æ§åˆ¶ 123456789initial a = #5 b;(å…ˆè®¡ç®—å³ç«¯çš„å€¼ï¼Œç­‰å¾…5tickåå†æŠŠå€¼èµ‹ç»™å·¦è¾¹ğŸ‘ˆ)ç­‰ä»·äºinitialbegin temp = b; #5; a = temp;end éªŒè¯ç¨‹åºå¦‚ä¸‹ï¼š å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ï¼š â€‹ ç¬¬ä¸€ç§å»¶æ—¶è¯­å¥ï¼Œåœ¨0-5tickä¹‹é—´åªè¦bå˜åŒ–äº†,é‚£ä¹ˆç¬¬äº”tick æ—¶åˆ»aè¢«èµ‹äºˆçš„å€¼å°±æ˜¯bç¬¬äº”æ—¶åˆ»çš„å€¼ã€‚ â€‹ è€Œç¬¬äºŒç§å»¶æ—¶è¯­å¥ï¼šbçš„å€¼åœ¨0æ—¶åˆ»å·²ç»å®šå¥½äº†ï¼Œä¸ç®¡ båœ¨è¿™æœŸé—´æ€ä¹ˆå˜åŒ–ï¼Œaæœ€ç»ˆå¾—åˆ°çš„æ˜¯båœ¨0æ—¶åˆ»çš„å€¼ã€‚ äº‹ä»¶è¯­å¥ @(&lt;äº‹ä»¶è¡¨è¾¾å¼&gt;); @(&lt;äº‹ä»¶è¡¨è¾¾å¼&gt;)è¡Œä¸ºè¯­å¥; 12345initialbegin # 10 @(posedge en) in = ~in; //ençš„ğŸ‘†ä¸Šå‡æ²¿åˆ°æ¥æ—¶,inå–åend äº‹ä»¶è¯­å¥@å¿…é¡»ç­‰æŒ‡å®šäº‹ä»¶åˆ°æ¥æ‰æ‰§è¡Œ ç­‰å¾…è¯­å¥ wait(&lt;æ¡ä»¶è¡¨è¾¾å¼&gt;) è¡Œä¸ºè¯­å¥ 123456always #5 cnt=cnt+1'b1;initial wait(cnt == 4'b1111) $display($time,,,\"cnt = %b\", cnt);end ç­‰å¾…è¯­å¥åªæœ‰æ¡ä»¶ä¸ºçœŸæ—¶æ‰æ‰§è¡Œã€‚ å¯ä»¥çœ‹åˆ°ç¬¬0æ—¶åˆ»cnt = 0 ç¬¬5æ—¶åˆ»cnt = 1 ä»¥æ­¤ç±»æ¨ï¼›ç›´åˆ°ç¬¬75æ—¶åˆ» cnt = 15 å†è¿‡10tick å°±ç»ˆæ­¢ä»¿çœŸäº†ã€‚æ€»è¿‡æ—¶å¸¸85tick","categories":[{"name":"Digital IC","slug":"Digital-IC","permalink":"https://www.beenli.cn/categories/Digital-IC/"},{"name":"verilog","slug":"Digital-IC/verilog","permalink":"https://www.beenli.cn/categories/Digital-IC/verilog/"}],"tags":[{"name":"specification","slug":"specification","permalink":"https://www.beenli.cn/tags/specification/"}]},{"title":"å•é“¾è¡¨ç¿»è½¬","slug":"å•é“¾è¡¨ç¿»è½¬","date":"2020-03-31T15:51:58.000Z","updated":"2020-08-05T10:20:10.325Z","comments":true,"path":"posts/39c22857/","link":"","permalink":"https://www.beenli.cn/posts/39c22857/","excerpt":"å•é“¾è¡¨ç¿»è½¬è§£æ³•ä¸€ã€æ‹†å¸+æ‹¼æ¥1234567891011121314struct ListNode *reverseList(struct ListNode* head){ struct ListNOde *newHead = NUll; struct ListNode *node = NULL; while (head != NULL) { //1. å¯¹ä¹‹å‰çš„é“¾è¡¨åšå¤´åˆ  node = head; // nodeå§‹ç»ˆæŒ‡å‘headçš„å‰é©± head = head-&gt;next; //2. å¯¹æ–°é“¾è¡¨åšå¤´æ’ node-&gt;next = newHead; newHead = node; } return newHead;}","text":"å•é“¾è¡¨ç¿»è½¬è§£æ³•ä¸€ã€æ‹†å¸+æ‹¼æ¥1234567891011121314struct ListNode *reverseList(struct ListNode* head){ struct ListNOde *newHead = NUll; struct ListNode *node = NULL; while (head != NULL) { //1. å¯¹ä¹‹å‰çš„é“¾è¡¨åšå¤´åˆ  node = head; // nodeå§‹ç»ˆæŒ‡å‘headçš„å‰é©± head = head-&gt;next; //2. å¯¹æ–°é“¾è¡¨åšå¤´æ’ node-&gt;next = newHead; newHead = node; } return newHead;} è§£æ³•äºŒã€ä¸‰æŒ‡é’ˆæ³•123456789101112131415161718struct ListNode *reverseList(struct ListNode* head) { if (head == NULL) { // å¦‚æœä¸ºNULLï¼Œé‚£ä¹ˆåæŒ‡é’ˆè¶Šç•Œã€‚ return NULL; } struct ListNode *p0 = NULL; struct ListNode *p1 = head; struct ListNode *p2 = head-&gt;next; while (p1 != NULL) { p1-&gt;next = p0; p0 = p1; p1 = p2; if (p2 != NULL) { p2 = p2-&gt;next; } } return p0;} å‚è€ƒåšå®¢","categories":[{"name":"CS","slug":"CS","permalink":"https://www.beenli.cn/categories/CS/"},{"name":"Data Structure","slug":"CS/Data-Structure","permalink":"https://www.beenli.cn/categories/CS/Data-Structure/"}],"tags":[{"name":"C","slug":"C","permalink":"https://www.beenli.cn/tags/C/"}]},{"title":"iverilog","slug":"å¼€å‘å·¥å…·","date":"2020-03-31T11:57:08.000Z","updated":"2020-09-30T12:06:22.074Z","comments":true,"path":"posts/bc753b52/","link":"","permalink":"https://www.beenli.cn/posts/bc753b52/","excerpt":"","text":"vim + iverilog + gtkwave 1ã€What is Icarus Verilog Icarus Verilog is a Verilog simulation and synthesis tool. It operates as a compiler, compiling source code written in Verilog (IEEE-1364) into some target format. For batch simulation, the compiler can generate an intermediate form called vvp assembly. This intermediate form is executed by the vvpcommand. For synthesis, the compiler generates netlists in the desired format.1 â€‹ ä»å®˜ç½‘çš„æè¿°æˆ‘ä»¬å¯ä»¥çœ‹åˆ°: å®ƒæ˜¯ä¸€ä¸ªä»¿çœŸå™¨å’Œç»¼åˆå™¨ã€‚ â€‹ æœ‰è¶£çš„æ˜¯ï¼šå¼€å‘è€…æ˜¯ä¸€åè½¯ä»¶å·¥ç¨‹å¸ˆ â€‹ a software engineer specializing in device drivers and embedded systems 2ã€Why we choose Icarus Verilog è½¯ä»¶éå¸¸å°ï¼Œæ²¡æœ‰å›¾å½¢ç•Œé¢ã€‚è·‘è·‘å°çš„ç¨‹åºè¶³å¤Ÿäº† è½¯ä»¶æ‰©å±•æ€§ç‰¹åˆ«å¥½ã€‚æˆ‘ç°åœ¨è¿˜æ²¡æœ‰å»æ¢ç´¢ã€‚è¯¦æƒ…è§ è½¯ä»¶å®Œå…¨å¼€æºã€‚å¦‚æœæœ‰å…´è¶£å¯ä»¥æ¢ç´¢æ˜¯å¦‚ä½•æŠŠRTLä»£ç è½¬æ¢ä¸ºnetlistçš„ 3ã€How to use it åƒåœ¨quarter II æˆ–è€…å…¶ä»–IDEä¸€æ ·ï¼Œä½ å¯ä»¥åœ¨ä»»æ„ä¸€æ¬¾ç¼–è¾‘å™¨ä¸Šç¼–å†™Verilogæºä»£ç  ç„¶ååœ¨ç¼–è¾‘å™¨é‡Œä¸€é”®è¿è¡Œè„šæœ¬ï¼Œæˆ–è€…åœ¨ç»ˆç«¯è¿è¡Œã€‚ ç»ˆç«¯ä¸»è¦è®°ä½å‡ ä¸ªå‘½ä»¤å³å¯: (åé¢å¾ˆä¼šè¯¦ç»†è¯´æ˜) 123iverilog -o filename filename.v // ç¼–è¯‘æºæ–‡ä»¶ ã€-o æŒ‡å®šç”Ÿæˆçš„æ–‡ä»¶åç§°ã€‘vvp filename // ä»¿çœŸtestbenchgtkwave filename.vcd // æŸ¥çœ‹ä»¿çœŸçš„æ³¢å½¢å›¾ 4ã€Instance case ç¼–å†™æºä»£ç (æœ€å¥½ç”¨æœ‰é«˜äº®çš„ç¼–è¾‘å™¨notepadã€sublimeã€VScodeã€VIM) 123456789101112131415// æ¨¡8è®¡æ•°å™¨ã€‚å­˜å‚¨ä¸ºcount8.vmodule count8(clk, rst_n, cnt); input clk, rst_n; output[3:0] cnt; reg[3:0] cnt; always @ (posedge clk or negedge rst_n) begin if(!rst_n) cnt &lt;= 4'b0000; else if(cnt[3]) cnt &lt;=4'b0000; else cnt &lt;= cnt + 1'b1; endendmodule ç¼–è¯‘ä¸€ä¸‹ 1iverilog -o counter8 counter8.v â€‹ â€‹ å¯ä»¥çœ‹åˆ°å·²ç»ç¼–è¯‘æˆåŠŸï¼Œç”Ÿæˆäº†count8æ–‡ä»¶ã€‚å³ä¸Šè¿°å‘½ä»¤-oåé¢æŒ‡å®šçš„ã€‚ å¦‚æœæƒ³æŸ¥çœ‹ç”µè·¯å›¾ã€‚å¥½åƒåªèƒ½åœ¨quarter IIé‡Œé¢viewerä¸€ä¸‹äº†ã€‚è¿˜æ²¡å‘ç°ä¸“é—¨ä»netlistç”Ÿæˆç”µè·¯å›¾çš„ç¨‹åºã€‚ ç¼–å†™æµ‹è¯•ä»£ç  1234567891011121314151617181920212223242526272829303132`include \"count8.v\"`timescale 1ns/1nsmodule count8_tb; // æ•°æ®ç»“æ„å£°æ˜ reg clk; reg rst_n; wire[3:0] cnt; // å®ä¾‹åŒ–å¾…æµ‹è¯•æ¨¡å— count8 U1(clk, rst_n, cnt); // æµ‹è¯•æ¿€åŠ±ä¿¡å· always #50 clk = ~ clk; initial begin clk = 1'b0; rst_n = 1'b0; #20 rst_n = 1'b0; #200 rst_n = 1'b1; end // è¾“å‡ºå“åº” initial begin wait(cnt == 4'b1000) $display($time,,,\"cnt = %b\", cnt); $dumpfile(\"count8_tb.vcd\"); // å¾ˆå…³é”®ï¼ŒæŠŠä»¿çœŸçš„æ•°æ®å­˜å‚¨åˆ°æ–‡ä»¶,å¾…ä¼šæ³¢å½¢å›¾è¦ç”¨ $dumpvars(0, count8_tb); // è®¾ç½®è¦è§‚å¯Ÿçš„å˜é‡ endendmodule ç¼–è¯‘ï¼Œä»¿çœŸï¼Œç”Ÿæˆæ³¢å½¢å›¾ 1iverilog -o count8_tb count8_tb.v &amp; vvp count8_tb &amp; gtkwave count8_tb.vcd æ³¨æ„: ç”±äºä»¿çœŸç¨‹åºæ²¡æœ‰è®¾å®šåœæ­¢æ—¶é—´ã€‚ç¨‹åºä¼šä¸€ç›´æ‰§è¡Œã€‚ å¦‚æœä½ æƒ³è‡ªåŠ¨åœæ­¢ï¼ˆå¯ä»¥åœ¨testbenchä¸ŠåŠ ä¸Š# 500$stop,é‚£ä¹ˆç¨‹åºä»¿çœŸ500ä¸ªtickå°±åœæ­¢) å¦‚æœä½ æ²¡æœ‰åŠ åœæ­¢æŒ‡ä»¤ã€‚åªèƒ½æ‰‹åŠ¨åœæ­¢ctrl+cç„¶åä½ å¯ä»¥æ‰“å°å½“å‰ä»¿çœŸçš„æ—¶é—´ã€‚å¦‚æœä¸å¤Ÿ ä½ å¯ä»¥ç»§ç»­ä»¿çœŸã€‚å¦‚æœå¯ä»¥äº†å°±finish æœ€åç”¨gtkwave æŸ¥çœ‹ä½ åˆšåˆšä»¿çœŸç”Ÿæˆçš„count8_tb.vcdæ–‡ä»¶ã€‚ å¦‚æœä½ å–œæ¬¢ç”¨modelsimä¹Ÿå¯ä»¥ã€‚ ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦å»ºä¸ªé¡¹ç›®ï¼ŒæŠŠä½ å†™çš„æºæ–‡ä»¶æ”¾è¿›å»ç¼–è¯‘ï¼Œä»¿çœŸä¸€ä¸‹å°±å¯ä»¥äº†ã€‚ å…·ä½“æ•™ç¨‹è§ references[1] iverilog","categories":[{"name":"Digital IC","slug":"Digital-IC","permalink":"https://www.beenli.cn/categories/Digital-IC/"},{"name":"tools","slug":"Digital-IC/tools","permalink":"https://www.beenli.cn/categories/Digital-IC/tools/"}],"tags":[{"name":"toolkits","slug":"toolkits","permalink":"https://www.beenli.cn/tags/toolkits/"}]}],"categories":[{"name":"CS","slug":"CS","permalink":"https://www.beenli.cn/categories/CS/"},{"name":"Programming","slug":"CS/Programming","permalink":"https://www.beenli.cn/categories/CS/Programming/"},{"name":"ML","slug":"CS/Programming/ML","permalink":"https://www.beenli.cn/categories/CS/Programming/ML/"},{"name":"env_problems","slug":"CS/Programming/env-problems","permalink":"https://www.beenli.cn/categories/CS/Programming/env-problems/"},{"name":"Scripts","slug":"CS/Programming/Scripts","permalink":"https://www.beenli.cn/categories/CS/Programming/Scripts/"},{"name":"Digital IC","slug":"Digital-IC","permalink":"https://www.beenli.cn/categories/Digital-IC/"},{"name":"verilog","slug":"Digital-IC/verilog","permalink":"https://www.beenli.cn/categories/Digital-IC/verilog/"},{"name":"Software","slug":"Software","permalink":"https://www.beenli.cn/categories/Software/"},{"name":"jupyter","slug":"Software/jupyter","permalink":"https://www.beenli.cn/categories/Software/jupyter/"},{"name":"RISC-V","slug":"RISC-V","permalink":"https://www.beenli.cn/categories/RISC-V/"},{"name":"spec","slug":"RISC-V/spec","permalink":"https://www.beenli.cn/categories/RISC-V/spec/"},{"name":"HDL Bits","slug":"Digital-IC/HDL-Bits","permalink":"https://www.beenli.cn/categories/Digital-IC/HDL-Bits/"},{"name":"Computer Organization & Design","slug":"CS/Computer-Organization-Design","permalink":"https://www.beenli.cn/categories/CS/Computer-Organization-Design/"},{"name":"digital electronic technique","slug":"Digital-IC/digital-electronic-technique","permalink":"https://www.beenli.cn/categories/Digital-IC/digital-electronic-technique/"},{"name":"environment","slug":"RISC-V/environment","permalink":"https://www.beenli.cn/categories/RISC-V/environment/"},{"name":"Git","slug":"Software/Git","permalink":"https://www.beenli.cn/categories/Software/Git/"},{"name":"Data Structure","slug":"CS/Data-Structure","permalink":"https://www.beenli.cn/categories/CS/Data-Structure/"},{"name":"Computer Network","slug":"CS/Computer-Network","permalink":"https://www.beenli.cn/categories/CS/Computer-Network/"},{"name":"OS","slug":"CS/OS","permalink":"https://www.beenli.cn/categories/CS/OS/"},{"name":"Linux","slug":"Linux","permalink":"https://www.beenli.cn/categories/Linux/"},{"name":"VIM","slug":"Software/VIM","permalink":"https://www.beenli.cn/categories/Software/VIM/"},{"name":"tools","slug":"Digital-IC/tools","permalink":"https://www.beenli.cn/categories/Digital-IC/tools/"}],"tags":[{"name":"python","slug":"python","permalink":"https://www.beenli.cn/tags/python/"},{"name":"PyTorch","slug":"PyTorch","permalink":"https://www.beenli.cn/tags/PyTorch/"},{"name":"CV","slug":"CV","permalink":"https://www.beenli.cn/tags/CV/"},{"name":"Scala","slug":"Scala","permalink":"https://www.beenli.cn/tags/Scala/"},{"name":"Batch","slug":"Batch","permalink":"https://www.beenli.cn/tags/Batch/"},{"name":"specification","slug":"specification","permalink":"https://www.beenli.cn/tags/specification/"},{"name":"toolkits","slug":"toolkits","permalink":"https://www.beenli.cn/tags/toolkits/"},{"name":"circuits","slug":"circuits","permalink":"https://www.beenli.cn/tags/circuits/"},{"name":"processor","slug":"processor","permalink":"https://www.beenli.cn/tags/processor/"},{"name":"git","slug":"git","permalink":"https://www.beenli.cn/tags/git/"},{"name":"C","slug":"C","permalink":"https://www.beenli.cn/tags/C/"},{"name":"Hexo","slug":"Hexo","permalink":"https://www.beenli.cn/tags/Hexo/"},{"name":"protocols","slug":"protocols","permalink":"https://www.beenli.cn/tags/protocols/"},{"name":"online course","slug":"online-course","permalink":"https://www.beenli.cn/tags/online-course/"}]}