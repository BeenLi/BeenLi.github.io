
  <script type="text/javascript">
    var now = new Date();
    var dayStr = 'Sat Apr 04 2020 08:00:00 GMT+0800 (GMT+08:00)';
    var day = dayStr ? new Date(dayStr) : new Date();
    var isMemorialDay = now.getFullYear() === day.getFullYear() && now.getMonth() === day.getMonth() && now.getDate()  === day.getDate();
    if (isMemorialDay) {
      var html = document.getElementsByTagName('html')[0];
      html.style.setProperty('-webkit-filter', 'grayscale(100%)');
      html.style.setProperty('filter', 'progid:DXImageTransform.Microsoft.BasicImage(grayscale=1)')
    }
  </script>
  <!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="http://image.beenli.cn/img/20200429/F7MQvrUt2Q4K.png?imageslim"><link rel="icon" type="image/png" href="http://image.beenli.cn/img/20200429/F7MQvrUt2Q4K.png?imageslim"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"><meta name="theme-color" content="#2f4154"><meta name="description" content="å¹³å¸¸çˆ±æ‰“çƒ, å¬æ­Œ, çœ‹ä¹¦.&lt;br&gt;å‰æ—å¤§å­¦17çº§å¾®ç”µå­, è¾…ä¿®CS"><meta name="author" content="Wan Li"><meta name="keywords" content="digital IC, ASIC, Linux, Vim, python, ç”µå­ç‹—, ç¨‹åºçŒ¿"><title>Tasks and Functions - BeenLi&#39;s blog</title><link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/9.18.1/styles/github-gist.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_fmb4a04yx8h.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_ijqayz9ro8k.css"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1791347_g19vm5ywni.css"><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="BeenLi's blog" type="application/atom+xml"></head><body><header style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/">&nbsp;<strong>BeenLi's blog</strong>&nbsp;</a> <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> é¦–é¡µ</a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> å½’æ¡£</a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> åˆ†ç±»</a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> æ ‡ç­¾</a></li><li class="nav-item"><a class="nav-link" href="/posts/336795bb/"><i class="iconfont icon-plan"></i> è®¡åˆ’</a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> å…³äº</a></li><li class="nav-item" id="search-btn"><a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i class="iconfont icon-search"></i>&nbsp;&nbsp;</a></li></ul></div></div></nav><div class="view intro-2" id="background" parallax="true" style="background:url(http://image.beenli.cn/img/20200426/ytR82GE0j1B5.jpg?imageslim) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="container text-center white-text fadeInUp"><span class="h2" id="subtitle"></span><div class="mt-3 post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2020-04-08 22:20">æ˜ŸæœŸä¸‰, å››æœˆ 8æ—¥ 2020, 10:20 æ™šä¸Š</time></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 2.1k å­— </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 33 åˆ†é’Ÿ</span></div></div></div></div></div></header><main><div class="container-fluid"><div class="row"><div class="d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-md"><div class="container nopadding-md" id="board-ctn"><div class="py-5" id="board"><div class="post-content mx-auto" id="post"><p class="note note-warning">æœ¬æ–‡æœ€åæ›´æ–°äºï¼šæ˜ŸæœŸæ—¥, å››æœˆ 26æ—¥ 2020, 12:07 å‡Œæ™¨</p><article class="markdown-body"><h1 id="Tasks-and-Functions"><a href="#Tasks-and-Functions" class="headerlink" title="Tasks and Functions"></a><center>Tasks and Functions</center></h1><h2 id="1ã€What-are-they-good-for"><a href="#1ã€What-are-they-good-for" class="headerlink" title="1ã€What are they good for"></a>1ã€What are they good for</h2><blockquote><p>Tasks and functions provide the ability to execute common procedures from several different places in a description. They also provide a means of breaking up large procedures into smaller ones to make it easier to read and debug the source descriptions.</p></blockquote><p>ä»std 1364-2005çš„è¿™æ®µæè¿°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ€»ç»“å‡ºä»¥ä¸‹ç”¨å¤„:</p><ol><li>å‡å°‘é‡å¤å·¥ä½œï¼Œä»£ç å¤ç”¨ã€‚</li><li>æŠŠå¤§çš„è¿‡ç¨‹æ‹†è§£æˆå‡ ä¸ªå°çš„ä»»åŠ¡å’Œå‡½æ•°ï¼Œæ›´åŠ æ˜“è¯»å’Œæ‰¾bug</li></ol><h2 id="2ã€Distinctions-between-tasks-and-functions"><a href="#2ã€Distinctions-between-tasks-and-functions" class="headerlink" title="2ã€Distinctions between tasks and functions"></a>2ã€Distinctions between tasks and functions</h2><ol><li><p>A function shall execute in one simulation time unit; a task can contain time-controlling statements.</p><p>å‡½æ•°åº”è¯¥ç¬é—´è¿”å›ç»“æœï¼Œä¸èƒ½æœ‰å»¶æ—¶ï¼›è€Œä»»åŠ¡å¯ä»¥å¸¦æœ‰å»¶æ—¶æ§åˆ¶è¯­å¥ã€‚</p></li><li><p>A function cannot enable a task; a task can enable other tasks and functions.</p><p>å‡½æ•°ä¸èƒ½è°ƒç”¨ä»»åŠ¡ï¼›ä½†æ˜¯ä»»åŠ¡å¯ä»¥è°ƒç”¨å…¶ä»–ä»»åŠ¡æˆ–è€…å‡½æ•°ã€‚</p></li><li><p>A function shall have at least one input type argument and shall not have an output or inout type argument; a task can have zero or more arguments of any type.</p><p>å‡½æ•°åº”è¯¥è‡³å°‘æœ‰ä¸€ä¸ª<code>è¾“å…¥å‚æ•°</code>å¹¶ä¸”ä¸èƒ½æœ‰è¾“å‡ºæˆ–è€…è¾“å…¥è¾“å‡ºå‚æ•°ã€‚</p><p>ä»»åŠ¡å¯ä»¥æœ‰é›¶ä¸ªæˆ–è€…ä»»æ„ä¸ªä»»ä½•ç§ç±»çš„å‚æ•°ã€‚</p></li><li><p>A function shall return a single value; a task shall not return a value.</p><p>å‡½æ•°åº”è¯¥è¿”å›ä¸€ä¸ªå•ä¸€çš„å€¼ï¼›ä»»åŠ¡ä¸èƒ½è¿”å›å€¼(åªèƒ½é€šè¿‡æŠŠå¤„ç†æ”¾åœ¨å‚æ•°ä¸Šå¸¦å›)</p><hr><p class="note note-primary">The purpose of a function is to respond to an input value by returning a single value. A task can support multiple goals and can calculate multiple result values. However, only the output or inout type arguments pass result values back from the invocation of a task. A function is used as an operand in an expression; the value of that operand is the value returned by the function.</p><ul><li><p>å‡½æ•°çš„ç›®çš„ï¼šå¯¹äºè¾“å…¥ç»™å‡ºä¸€ä¸ªè¿”å›ç»“æœ</p></li><li><p>ä»»åŠ¡æ”¯æŒå¤šä¸ªç»“æœï¼Œä½†æ˜¯åªæœ‰<code>è¾“å‡º</code>æˆ–è€…<code>è¾“å…¥è¾“å‡º</code>å‚æ•°èƒ½å¤Ÿä¼ é€’è¿™ç§ç»“æœ</p></li><li><p>å‡½æ•°å¯ä»¥åœ¨è¡¨è¾¾å¼ä¸­ç”¨ä½œä¸€ä¸ªæ“ä½œæ•°ã€‚ï¼ˆå…¶å€¼å°±æ˜¯å‡½æ•°è¿”å›çš„ç»“æœã€‚æ˜¯ä¸æ˜¯å¾ˆåƒC)</p></li></ul></li><li><p>ä¾‹å¦‚ï¼š</p><pre><code class="hljs verilog">switch_bytes(old_word, new_word);	<span class="hljs-comment">//taskä¼šæŠŠè¿ç®—ç»“æœæ”¾åœ¨new_wordä¸Š</span>

new_word = switch_bytes(old_word);	<span class="hljs-comment">//functionä¼šç›´æ¥æŠŠç»“æœè¿”å›ã€‚</span></code></pre></li></ol><div class="table-container"><table><thead><tr><th>æ¯”è¾ƒç‚¹</th><th>tasks</th><th>functions</th></tr></thead><tbody><tr><td><strong><em>è¾“å…¥è¾“å‡º</em></strong></td><td>ä»»æ„å¤šè¾“å…¥è¾“å‡º(input,output,inout)</td><td>è‡³å°‘ä¸€ä¸ªè¾“å…¥ä¸èƒ½æœ‰è¾“å‡º</td></tr><tr><td>è§¦å‘äº‹ä»¶æ§åˆ¶</td><td>å¯ä»¥åŒ…å«å»¶æ—¶æ§åˆ¶è¯­å¥(#), åªèƒ½é¢å‘ä»¿çœŸï¼Œä¸èƒ½ç»¼åˆ</td><td>ä¸èƒ½å‡ºç°always, # ç­‰è¯­å¥ï¼Œå‡½æ•°åº”è¯¥åœ¨ä¸€ä¸ªæ—¶é—´å•å…ƒå†…è¿”å›å€¼</td></tr><tr><td><strong><em>è¿”å›å€¼</em></strong></td><td>é€šè¿‡è¾“å‡ºç«¯å£ä¼ é€’</td><td>é€šè¿‡å‡½æ•°åè¿”å›(only one)</td></tr><tr><td><strong><em>ä¸­æ®µ</em></strong></td><td>å¯ä»¥ç”±disableä¸­æ–­</td><td>ä¸èƒ½</td></tr><tr><td>è¯­å¥</td><td></td><td></td></tr><tr><td><strong><em>è°ƒç”¨å…¶ä»–</em></strong></td><td>å¯ä»¥è°ƒç”¨taskå’Œfunction</td><td>åªèƒ½è°ƒç”¨functionï¼Œä¸èƒ½è°ƒç”¨task</td></tr><tr><td><strong><em>å…¶ä»–è¯´æ˜</em></strong></td><td>taskè°ƒç”¨å¯ä»¥ä½œä¸ºå®Œæ•´çš„è¯­å¥å‡ºç°</td><td>functionè°ƒç”¨åªèƒ½ä½œä¸ºèµ‹å€¼è¯­å¥å³è¾¹çš„operand</td></tr></tbody></table></div><h2 id="3ã€-Tasks-and-task-enabling"><a href="#3ã€-Tasks-and-task-enabling" class="headerlink" title="3ã€ Tasks and task enabling"></a>3ã€ Tasks and task enabling</h2><blockquote><p>A task shall be enabled from a statement that defines the argument values to be passed to the task and the variables that receive the results. Control shall be passed back to the enabling process after the task has completed. Thus, if a task has timing controls inside it, then the time of enabling a task can be different from the time at which the control is returned. A task can enable other tasks, which in turn can enable still other tasksâ€”with no limit on the number of tasks enabled. Regardless of how many tasks have been enabled,control shall not return until all enabled tasks have completed.</p></blockquote><ol><li>è°ƒç”¨taskåº”è¯¥ç»™å‡º<code>ä¼ è¿›å‚æ•°çš„å€¼</code>ï¼Œå’Œ<code>æ¥å—ç»“æœçš„å˜é‡</code>ã€‚</li><li>taskå¦‚æœæœ‰å»¶æ—¶æ§åˆ¶ï¼Œé‚£ä¹ˆtaskè¢«è°ƒç”¨æ—¶åˆ»å’Œæ§åˆ¶è¿”å›æ—¶åˆ»å¯ä»¥ä¸åŒã€‚</li><li>taskå†…å¯ä»¥å†è°ƒç”¨taskï¼Œç›´åˆ°æ‰€æœ‰çš„taskå®Œæˆæ‰ä¼šè¿”å›æ§åˆ¶åˆ°é¡¶å±‚è°ƒç”¨å¤„ã€‚</li></ol><h3 id="3-1ã€task-declaration-syntaxes"><a href="#3-1ã€task-declaration-syntaxes" class="headerlink" title="3.1ã€task declaration syntaxes"></a>3.1ã€task declaration syntaxes</h3><pre><code class="hljs verilog">task_declaration ::= (From A<span class="hljs-variable">.2</span><span class="hljs-variable">.7</span>)
				<span class="hljs-keyword">task</span> [ <span class="hljs-keyword">automatic</span> ] task_identifier ; 
				{ task_item_declaration } 
				statement_or_null 
				<span class="hljs-keyword">endtask</span> 
				
task_declaration ::= (From A<span class="hljs-variable">.2</span><span class="hljs-variable">.7</span>)				
				<span class="hljs-keyword">task</span> [ <span class="hljs-keyword">automatic</span> ] task_identifier ( [ task_port_list ] ) ; 
                { block_item_declaration } 
                statement_or_null 
                <span class="hljs-keyword">endtask</span></code></pre><blockquote><p>Tasks without the optional keyword automatic are static tasks, with all declared items being statically allocated. These items shall be shared across all uses of the task executing concurrently. All items declared inside automatic tasks are allocated dynamically for each invocation Automatic task items cannot be accessed by hierarchical references. Automatic tasks can be invoked through use of their hierarchical name.ï¼ˆautomaticçš„å‘åé¢å†å¡«)</p></blockquote><h3 id="3-2ã€Task-enabling-and-argument-passing"><a href="#3-2ã€Task-enabling-and-argument-passing" class="headerlink" title="3.2ã€Task enabling and argument passing"></a>3.2ã€Task enabling and argument passing</h3><pre><code class="hljs plain">task_enable ::= (From A.6.9)
	hierarchical_task_identifier [ ( expression { , expression } ) ] ;</code></pre><ol><li>If the argument is declared as an output or an inout, then the expression shall be restricted to an expression that is valid on the left-hand side of a procedural assignment.(è¾“å‡ºå‚æ•°ï¼šèƒ½ä½äº<code>è¿‡ç¨‹èµ‹å€¼è¯­å¥</code>å·¦è¾¹çš„æœ‰æ•ˆè¡¨è¾¾å¼ã€‚<code>ä¸èƒ½æ˜¯wire</code>)</li></ol><ul><li>reg, integer, real, realtime, and time variables</li><li>Memory references</li><li>Concatenations of reg, integer, and time variables</li><li>Concatenations of memory references</li><li>Bit-selects and part-selects of reg, integer, and time variables</li></ul><ol><li><p>All arguments to the task shall be passed by value rather than by reference</p><p>ä»»åŠ¡å‚æ•°çš„æ˜¯<code>å€¼ä¼ é€’</code>ä¸æ˜¯å¼•ç”¨(æŒ‡é’ˆ)</p></li><li><p>If an argument in the task is declared as an input, then the corresponding expression can be any expression.The order of evaluation of the expressions in the argument list is undefined.</p><p>å¦‚æœå‚æ•°è¢«å®šä¹‰ä¸ºinputï¼Œé‚£ä¹ˆè°ƒç”¨è¯­å¥ä¸ä¹‹ç›¸åº”ä½ç½®çš„è¡¨è¾¾å¼æ²¡æœ‰é™åˆ¶ï¼Œè¡¨è¾¾å¼æ±‚å€¼è¿‡ç¨‹æ˜¯æ²¡æœ‰è¢«å®šä¹‰çš„ã€‚ï¼ˆæ±‚å€¼é¡ºåºæ²¡æœ‰å…ˆåï¼‰</p></li></ol><pre><code class="hljs verilog"><span class="hljs-keyword">task</span>  my_task; 
    <span class="hljs-keyword">input</span>  a, b; 
    <span class="hljs-keyword">inout</span>  c; 
    <span class="hljs-keyword">output</span>  d, e; 
    <span class="hljs-keyword">begin</span>
    . . .   	<span class="hljs-comment">// statements that perform the work of the task</span>
    . . .
    c = foo1;   <span class="hljs-comment">// the assignments that initialize result regs</span>
    d = foo2;
    e = foo3;
    <span class="hljs-keyword">end</span>
<span class="hljs-keyword">endtask</span></code></pre><pre><code class="hljs verilog"><span class="hljs-keyword">task</span>  my_task ( <span class="hljs-keyword">input</span>  a, b,  <span class="hljs-keyword">inout</span>  c,  <span class="hljs-keyword">output</span>  d, e); 
    <span class="hljs-keyword">begin</span>
    . . .   <span class="hljs-comment">// statements that perform the work of the task</span>
    . . .
    c = foo1;  <span class="hljs-comment">// the assignments that initialize result regs</span>
    d = foo2;
    e = foo3;
    <span class="hljs-keyword">end</span>
<span class="hljs-keyword">endtask</span></code></pre><p>ä¸€ç§æ˜¯å‚æ•°åˆ—è¡¨åœ¨å‡½æ•°ååå®šä¹‰ã€‚ä¸€ç§æ˜¯åœ¨taské‡Œé¢å®šä¹‰ã€‚</p><blockquote><p>my_task (v, w, x, y, z); //è°ƒç”¨è¯­å¥</p></blockquote><p>The task-enabling arguments ( v , w , x , y , and z ) correspond to the arguments ( a , b , c , d , and e ) defined by the task.</p><p>å½“å‡½æ•°è°ƒç”¨æ—¶:</p><blockquote><p>a = v;<br>b = w;<br>c = x;</p></blockquote><p>When the task completes, the following assignments to return the computed values to the<br>calling process are performed:(å½“å‡½æ•°ç»“æŸåï¼Œä¸‹é¢çš„èµ‹å€¼è¿”å›å¯¹åº”çš„ç»“æœ)</p><blockquote><p>x = c;<br>y = d;<br>z = e;</p></blockquote><p class="note note-primary">task enable statementä¸­å‚æ•°ä½ç½®è¦å’Œtask definition å¯¹åº”ã€‚ä¸ç®¡ä½ æ˜¯å“ªç§æ–¹æ³•å®šä¹‰task</p><h3 id="3-3ã€Task-memory-usage-and-concurrent-face-with-head-bandage-ï¼ˆå¯ä»¥è·³è¿‡ï¼‰"><a href="#3-3ã€Task-memory-usage-and-concurrent-face-with-head-bandage-ï¼ˆå¯ä»¥è·³è¿‡ï¼‰" class="headerlink" title="3.3ã€Task memory usage and concurrent :face_with_head_bandage:ï¼ˆå¯ä»¥è·³è¿‡ï¼‰"></a>3.3ã€Task memory usage and concurrent :face_with_head_bandage:ï¼ˆå¯ä»¥è·³è¿‡ï¼‰</h3><p>A task may be enabled more than once concurrently. All variables of an automatic task shall be replicated on each concurrent task invocation to store state specific to that invocation.All variables of a static task shall be static in that there shall be a single variable corresponding to each declared local variable in a module instance, regardless of the number of concurrent activations of the task. However, static tasks in different instances of a module shall have separate storage from each other.</p><hr><h2 id="4ã€Disabling-of-named-blocks-and-tasks"><a href="#4ã€Disabling-of-named-blocks-and-tasks" class="headerlink" title="4ã€Disabling of named blocks and tasks"></a>4ã€Disabling of named blocks and tasks</h2><p>The <code>disable statement</code> provides the ability to terminate the activity associated with concurrently active procedures, while maintaining the structured nature of Verilog HDL procedural descriptions.ï¼ˆdisable è¯­å¥å¯ä»¥ç»ˆæ­¢æ­£åœ¨è¿è¡Œçš„è¿‡ç¨‹ï¼‰</p><ol><li><pre><code class="hljs verilog"><span class="hljs-keyword">begin</span>  : block_name
    rega = regb;
    <span class="hljs-keyword">disable</span>  block_name;
    regc = rega; <span class="hljs-comment">// this assignment will never execute</span>
<span class="hljs-keyword">end</span></code></pre></li><li><pre><code class="hljs verilog"><span class="hljs-keyword">begin</span>  : block_name
    ...
    <span class="hljs-keyword">if</span>  (a == <span class="hljs-number">0</span>)
    <span class="hljs-keyword">disable</span>  block_name;
    ...
<span class="hljs-keyword">end</span> <span class="hljs-comment">// end of named block</span>
<span class="hljs-comment">// continue with code following named block</span></code></pre></li><li><pre><code class="hljs verilog"><span class="hljs-keyword">task</span>  proc_a;
    <span class="hljs-keyword">begin</span>
    ...
    ...
    <span class="hljs-keyword">if</span>  (a == <span class="hljs-number">0</span>)
        <span class="hljs-keyword">disable</span>  proc_a; <span class="hljs-comment">// return if true(æ§åˆ¶æƒäº¤å›è°ƒç”¨è¯­å¥)</span>
    ...
    ...
    <span class="hljs-keyword">end</span>
<span class="hljs-keyword">endtask</span></code></pre></li><li><pre><code class="hljs verilog"><span class="hljs-keyword">begin</span> : <span class="hljs-keyword">break</span>
    <span class="hljs-keyword">for</span>  (i = <span class="hljs-number">0</span>; i &lt; n; i = i+<span class="hljs-number">1</span>)  <span class="hljs-keyword">begin</span>  : <span class="hljs-keyword">continue</span>
        @ clk
            <span class="hljs-keyword">if</span>  (a == <span class="hljs-number">0</span>)			 <span class="hljs-comment">// "continue" loop</span>
                <span class="hljs-keyword">disable</span>  <span class="hljs-keyword">continue</span>;	 <span class="hljs-comment">//(ç›¸å½“äºcé‡Œé¢çš„break)</span>
            statements
            statements
         @ clk
            <span class="hljs-keyword">if</span>  (a == b) 			<span class="hljs-comment">// "break" from loop</span>
                <span class="hljs-keyword">disable</span>  <span class="hljs-keyword">break</span>;		<span class="hljs-comment">// (ç›¸å½“äºcé‡Œé¢çš„break)</span>
            statements
            statements
    <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span></code></pre></li><li><pre><code class="hljs verilog"><span class="hljs-keyword">fork</span>
	<span class="hljs-keyword">begin</span>  : event_expr
        @ ev1;
        <span class="hljs-keyword">repeat</span>  (<span class="hljs-number">3</span>)  @ trig;
        # d action (areg, breg);	<span class="hljs-comment">//(åªæœ‰å½“ev1å‡ºç°ï¼Œtrigå‡ºç°3æ¬¡æ‰è§¦å‘)</span>
	<span class="hljs-keyword">end</span>
    @ reset  <span class="hljs-keyword">disable</span>  event_expr;	<span class="hljs-comment">//(åŒä¸Šé¢å¹¶è¡Œè¿›è¡Œ)</span>
<span class="hljs-keyword">join</span></code></pre></li><li><pre><code class="hljs verilog"><span class="hljs-keyword">always</span> <span class="hljs-keyword">begin</span> : monostable
			# <span class="hljs-number">250</span> q = <span class="hljs-number">0</span>;
<span class="hljs-keyword">end</span>
<span class="hljs-keyword">always</span>   @ retrig  <span class="hljs-keyword">begin</span>	<span class="hljs-comment">//ï¼ˆåªè¦retrigå˜åŒ–é—´éš”å°äº250ï¼Œé‚£ä¹ˆqå°±ä¸€ç›´ä¸º1)</span>
    <span class="hljs-keyword">disable</span>  monostable;
    q = <span class="hljs-number">1</span>;
<span class="hljs-keyword">end</span></code></pre></li></ol><h2 id="5ã€Functions-and-function-calling"><a href="#5ã€Functions-and-function-calling" class="headerlink" title="5ã€Functions and function calling"></a>5ã€Functions and function calling</h2><h3 id="5-1ã€Function-declarations"><a href="#5-1ã€Function-declarations" class="headerlink" title="5.1ã€Function declarations"></a>5.1ã€Function declarations</h3><pre><code class="hljs verilog">function_declaration ::= (From A<span class="hljs-variable">.2</span><span class="hljs-variable">.6</span>)
            <span class="hljs-keyword">function</span> [ <span class="hljs-keyword">automatic</span> ] [ function_range_or_type ] 
            function_identifier ; 
            function_item_declaration { function_item_declaration } 
            function_statement 
            <span class="hljs-keyword">endfunction</span> 
            
            | <span class="hljs-keyword">function</span> [ <span class="hljs-keyword">automatic</span> ] [ function_range_or_type ] 
            function_identifier ( function_port_list ) ; 
            { block_item_declaration } 
            function_statement 
            <span class="hljs-keyword">endfunction</span></code></pre><pre><code class="hljs verilog"><span class="hljs-keyword">function</span>  [<span class="hljs-number">7</span>:<span class="hljs-number">0</span>] getbyte; 		<span class="hljs-comment">// (å¦‚æœæ²¡æœ‰ç»™[range]é‚£ä¹ˆé»˜è®¤ä¸ºscalar)</span>
    <span class="hljs-keyword">input</span>  [<span class="hljs-number">15</span>:<span class="hljs-number">0</span>] address; 
    <span class="hljs-keyword">begin</span>
    <span class="hljs-comment">// code to extract low-order byte from addressed word</span>
    . . .
    getbyte =  result <span class="hljs-number">_</span>expression;
    <span class="hljs-keyword">end</span>
<span class="hljs-keyword">endfunction</span></code></pre><pre><code class="hljs verilog"><span class="hljs-keyword">function</span>  [<span class="hljs-number">7</span>:<span class="hljs-number">0</span>] getbyte ( <span class="hljs-keyword">input</span>  [<span class="hljs-number">15</span>:<span class="hljs-number">0</span>] address); 
    <span class="hljs-keyword">begin</span>
    <span class="hljs-comment">// code to extract low-order byte from addressed word</span>
    . . .
    getbyte =  result <span class="hljs-number">_</span>expression;
    <span class="hljs-keyword">end</span>
<span class="hljs-keyword">endfunction</span></code></pre><h3 id="5-2ã€Returning-a-value-from-a-function"><a href="#5-2ã€Returning-a-value-from-a-function" class="headerlink" title="5.2ã€Returning a value from a function"></a>5.2ã€Returning a value from a function</h3><p>The function definition shall implicitly declare a variable, internal to the function, with the same name as the function. This variable either defaults to a 1-bit reg or is the same type as the type specified in the function declaration. The function definition initializes the return value from the function by assigning the function result to the internal variable with the same name as the function.</p><p>å‡½æ•°å®šä¹‰å°±éšå«äº†ä¸€ä¸ªå˜é‡ï¼ˆå³å‡½æ•°åï¼‰</p><p>å‡½æ•°é€šè¿‡ç»™è¿™ä¸ªéšå«å˜é‡èµ‹å€¼è¿”å›å€¼ã€‚</p><h3 id="5-3ã€Calling-a-function"><a href="#5-3ã€Calling-a-function" class="headerlink" title="5.3ã€Calling a function"></a>5.3ã€Calling a function</h3><pre><code class="hljs verilog">function_call ::= (From A<span class="hljs-variable">.8</span><span class="hljs-variable">.2</span>)
        hierarchical_function_identifier{ attribute_instance } ( expression { , expression } )</code></pre><pre><code class="hljs verilog">word = control ? {getbyte(msbyte), getbyte(lsbyte)}:<span class="hljs-number">0</span>;(æŠŠä¸¤æ¬¡å‡½æ•°è°ƒç”¨çš„ç»“æœæ‹¼æ¥èµ·æ¥)</code></pre><h3 id="5-4ã€Function-rules"><a href="#5-4ã€Function-rules" class="headerlink" title="5.4ã€Function rules"></a>5.4ã€Function rules</h3><ol><li><p>A function shall not have any nonblocking assignments or procedural continuous assignments.</p><p>å‡½æ•°ä¸èƒ½æœ‰<code>éé˜»å¡èµ‹å€¼</code>æˆ–è€…<code>è¿‡ç¨‹è¿ç»­èµ‹å€¼</code>ï¼ˆåœ¨ä¸€ä¸ªæ—¶é—´å•ä½å†…å®Œæˆï¼‰</p></li><li><p>A function shall not have any event triggers.</p><p>å‡½æ•°ä¸èƒ½æœ‰ä»»ä½•<code>æ—¶é—´è§¦å‘</code></p></li></ol><pre><code class="hljs verilog"><span class="hljs-keyword">module</span>  tryfact;
<span class="hljs-comment">// define the function</span>
<span class="hljs-keyword">function</span> <span class="hljs-keyword">automatic</span>   <span class="hljs-keyword">integer</span>  factorial;
<span class="hljs-keyword">input</span>  [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] operand;
<span class="hljs-keyword">integer</span>  i;
<span class="hljs-keyword">if</span>  (operand &gt;= <span class="hljs-number">2</span>) 
	factorial = factorial (operand - <span class="hljs-number">1</span>) * operand;
<span class="hljs-keyword">else</span>
	factorial = <span class="hljs-number">1</span>;
<span class="hljs-keyword">endfunction</span>

<span class="hljs-comment">// test the function</span>
<span class="hljs-keyword">integer</span>  result;
<span class="hljs-keyword">integer</span>  n;
<span class="hljs-keyword">initial</span>   <span class="hljs-keyword">begin</span>
<span class="hljs-keyword">for</span>  (n = <span class="hljs-number">0</span>; n &lt;= <span class="hljs-number">7</span>; n = n+<span class="hljs-number">1</span>)  <span class="hljs-keyword">begin</span>
result = factorial(n);
<span class="hljs-built_in">$display</span> (<span class="hljs-string">"%0d factorial=%0d"</span>, n, result);</code></pre><h3 id="5-5ã€-Use-of-constant-functions-face-with-head-bandage-ï¼ˆå¯ä»¥è·³è¿‡ï¼‰"><a href="#5-5ã€-Use-of-constant-functions-face-with-head-bandage-ï¼ˆå¯ä»¥è·³è¿‡ï¼‰" class="headerlink" title="5.5ã€ Use of constant functions:face_with_head_bandage:ï¼ˆå¯ä»¥è·³è¿‡ï¼‰"></a>5.5ã€ Use of constant functions<span class="github-emoji" style="display:inline;vertical-align:middle;color:transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f915.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f915.png?v8">ğŸ¤•</span>ï¼ˆå¯ä»¥è·³è¿‡ï¼‰</h3><p>Constant function calls are used to support the building of complex calculations of values at elaboration time</p><p>å¸¸é‡å‡½æ•°è°ƒç”¨ç”¨äºæ”¯æŒåœ¨ç²¾åŒ–é˜¶æ®µæ„å»ºå¤æ‚çš„å€¼è®¡ç®—</p><p><span class="github-emoji" style="display:inline;vertical-align:middle;color:transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f642.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f642.png?v8">ğŸ™‚</span>o_o â€¦.å¾…å¡«å‘ã€‚</p><h2 id="Renference"><a href="#Renference" class="headerlink" title="Renference"></a>Renference</h2><p>[IEEE Std 1364â„¢-2005ä¸‹è½½ğŸ”—]ï¼šé“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1ryz4IAuQzNPnGifUJ8oAGw" rel="external nofollow noreferrer">https://pan.baidu.com/s/1ryz4IAuQzNPnGifUJ8oAGw</a><br>æå–ç ï¼š2qvb</p><script>document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });</script></article><hr><div><div class="post-metas mb-3"><div class="post-meta mr-3"><i class="iconfont icon-category"></i> <a class="hover-with-bg" href="/categories/Digital-IC/">Digital IC</a> <a class="hover-with-bg" href="/categories/Digital-IC/verilog/">verilog</a></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a class="hover-with-bg" href="/tags/syntax/">syntax</a></div></div><p class="note note-warning">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" rel="nofollow noopener">CC BY-SA 3.0åè®®</a> ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</p><div class="post-prevnext row"><div class="post-prev col-6"><a href="/posts/f796a091/"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">æ•°æ®ç»“æ„â€”â€”æ ‘</span> <span class="visible-mobile">ä¸Šä¸€ç¯‡</span></a></div><div class="post-next col-6"><a href="/posts/fb29ac9a/"><span class="hidden-mobile">git hooksè‡ªåŠ¨éƒ¨ç½²hexo</span> <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span> <i class="iconfont icon-arrowright"></i></a></div></div></div><div class="comments" id="comments"><div id="vcomments"></div><script defer src="https://cdn.staticfile.org/valine/1.4.4/Valine.min.js"></script><script type="text/javascript">var oldLoadVa=window.onload;window.onload=function(){oldLoadVa&&oldLoadVa(),new Valine({el:"#vcomments",app_id:"wL8cVEADdoKpEaDDPPnBR9sm-gzGzoHsz",app_key:"2oJflENqEmJ8ccfv0XLxRL8O",placeholder:"è¯´ç‚¹ä»€ä¹ˆ",path:window.location.pathname,avatar:"monsterid",meta:["nick","mail","link"],pageSize:"10",lang:"zh-CN",highlight:!1,recordIP:!1,serverURLs:"",mathJax:!1})}</script><noscript>Please enable JavaScript to view the <a href="https://valine.js.org" rel="nofollow noopener">comments powered by Valine.</a></noscript></div></div></div></div></div><div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p><div id="tocbot"></div></div></div></div></div></main><a id="scroll-top-button" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div><footer class="mt-5"><div class="text-center py-3"><div><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a></div><div><a href="http://beian.miit.gov.cn/" target="_blank" class="beian-icp" rel="nofollow noopener">é„‚ICPå¤‡20001266å·</a></div></div></footer><script src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js"></script><script src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js"></script><script src="/js/main.js"></script><script src="/js/lazyload.js"></script><script src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js"></script><script>$(document).ready(function(){var t=$("#board-ctn").offset().top;tocbot.init({tocSelector:"#tocbot",contentSelector:".post-content",headingSelector:"h1,h2,h3,h4,h5,h6",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",collapseDepth:0,scrollSmooth:!0,headingsOffset:-t}),0<$(".toc-list-item").length&&$("#toc").css("visibility","visible")})</script><script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js"></script><script src="/js/clipboard-use.js"></script><script defer>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?e003c704a60a6fe8b1437118b71fea30";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js"></script><script>var typed=new Typed("#subtitle",{strings:["  ","Tasks and Functions&nbsp;"],cursorChar:"_",typeSpeed:70,loop:!1});typed.stop(),$(document).ready(function(){$(".typed-cursor").addClass("h2"),typed.start()})</script><script src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js"></script><script>anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))</script><script src="/js/local-search.js"></script><script>var path="/local-search.xml",inputArea=document.querySelector("#local-search-input");inputArea.onclick=function(){getSearchFile(path),this.onclick=null}</script><script src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js"></script><link rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css"><script>$("#post img:not(.no-zoom img, img[no-zoom]), img[zoom]").each(function(){var t=document.createElement("a");$(t).attr("data-fancybox","images"),$(t).attr("href",$(this).attr("src")),$(this).wrap(t)})</script><script>!function(e,r,t){var o,n=[];e.requestAnimationFrame=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(e){setTimeout(e,1e3/60)},function(t){var a=r.createElement("style");a.type="text/css";try{a.appendChild(r.createTextNode(t))}catch(e){a.styleSheet.cssText=t}r.getElementsByTagName("head")[0].appendChild(a)}(".heart{width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);}.heart:after,.heart:before{content: '';width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: fixed;}.heart:after{top: -5px;}.heart:before{left: -5px;}"),o="function"==typeof e.onclick&&e.onclick,e.onclick=function(e){var t,a;o&&o(),t=e,(a=r.createElement("div")).className="heart",n.push({el:a,x:t.clientX-5,y:t.clientY-5,scale:1,alpha:1,color:"rgb("+~~(255*Math.random())+","+~~(255*Math.random())+","+~~(255*Math.random())+")"}),r.body.appendChild(a)},function e(){for(var t=0;t<n.length;t++)n[t].alpha<=0?(r.body.removeChild(n[t].el),n.splice(t,1)):(n[t].y--,n[t].scale+=.004,n[t].alpha-=.013,n[t].el.style.cssText="left:"+n[t].x+"px;top:"+n[t].y+"px;opacity:"+n[t].alpha+";transform:scale("+n[t].scale+","+n[t].scale+") rotate(45deg);background:"+n[t].color+";z-index:99999");requestAnimationFrame(e)}()}(window,document)</script></body></html>